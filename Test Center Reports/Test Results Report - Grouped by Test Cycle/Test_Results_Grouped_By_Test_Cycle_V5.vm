#if( $format == "doc" )
MIME-Version: 1.0
Content-Type: multipart/related; boundary="----=_NextPart_01D506B0.1F52D2B0"
#end

## ======================================================================================================================
## Name: Test_Results_Grouped_By_Test_Cycle_V5.vm
## 
## Description: Non-Context Sensitive Report ran to gather test case and test run data organized into tables 
##              grouped by test cycle sections
## ======================================================================================================================
## MODIFICATION HISTORY 
## 
## Date         Revision   Person            Comments 
## -----------  ---------  ----------------  ---------------------------------- 
## 2021-08-30   1.0        Liam Rotchford    - Intial Build updating the Test Results - Grouped By Test Cycle Report to use
##                                             the master template due to errors in test run steps having images.
##                                           - Report also handles upstream requirements for the test cases and runs. 
##
## 2021-12-09   1.1        Liam Rotchford    - Minor adjustment to test run gathering logic to ensure test runs are properly 
##                                             grouped by test cycle if there are multiple test case groups on test plan.
##                                           - Updated test run gathering logic to ensure test runs are sorted by test case
##                                             order per test cycle.
## 2023-07-06   1.2        Shawnna Williams  - minor adjustment to remove blank img tags in test results fields
## 2023-08-02   1.3        Liam Rotchford    - Updated report to Master Template version 2.6.1
## 2023-09-12   1.4        Anna FitzGerald   - Commented out debug print statement
##                                           - Corrected variable name in #formatTableCell macro    
## 2023-12-27   1.5        Liam Rotchford    - Updated report data extraction and organization implementation to utilize 
##                                             workaround method .getTestRunIdsForTestCases() following identified defect 
##                                             SOS-DEF-7285 where not all runs were being collected. 
##                                           - Updated #findSourceMHTML() macro to the latest implementation for improved 
##                                             image source extraction. 
##
## ======================================================================================================================
##
## Report Criteria:
## ---------------------------    
##
##      Type:       Display Name:           Report Global Variable:   Function:
##      ----------------------------------------------------------------------------------------------------------------------
##      Test Plan   Test Plan               report_testPlanId
##
##    
##
## ======================================================================================================================
##
##
#########################################################################################################################
#########################################################################################################################
##
##  Report Features
#########################################################################################################################
##
##  - Export in HTML, PDF or Word supported
##  - Document properties loaded from custom fields on a set or component
##  - Document Revision Loaded from most recent non-review baseline of the items.  Asterisk added if some items have 
##    changed sinec the msot recent non-review baseline.
##  - Export from project explorer or baseline
##  - Exclude items with a status listed in $excludedStatuses
##  - Numbered captions for figures, tables and equations
##  - Jama hyperlinks to items in the same document converted to Word cross-references
##  - Tables formatted and resized to fit the page width
##  - Images resized to fit the page
##  - All text formatted consistently
##  - Macro for all item types in the Automotive VSO
##
##
#########################################################################################################################
#########################################################################################################################
##
##  Report Issue list
#########################################################################################################################
##  
##  https://jama-arolufs.jamacloud.com/perspective.req#/containers/2444332?projectId=20374
##
#########################################################################################################################
#########################################################################################################################
##
##  Jama Configuration Requirements
#########################################################################################################################
##
##  Valid Export Scenarios
##  - Export Component or Set from Project Explorer 
##  - Export baselined Component or Set from baseline view
##  Required fields for full functionality
##  Set or Component (whichever is the parent of a single document)
##  - Author(s): Text Field
##  - Approvers: Rich Text Field
##  - Document ID: Text Field
##  - Document Status: Text Field or Pick List
##  - Change History: Rich TextText Field
##  All Item Types that could contain Figures, Tables or Equations
##  - Object Type: Pick List containing at least (Text, Figure, Table, Equation)
##
#########################################################################################################################
#########################################################################################################################
##
##  Installation Instructions
#########################################################################################################################
## Add a new report in Jama with the following options:
## 
## Word 
##	-Report Formats: Micosoft Word
##  -Scope: Organization
##  -Organization: Select yours
##  -Visible to Users: true
##  -Context Sensitive: true
## 
## PDF 
##  -Report Formats: PDF 
##  -Scope: Organization
##  -Organization: Select yours
##  -Include Table Of...Contents, Figures, Tables (check all that apply) 
##  -Title Page: check if you have one
##  -Visible to Users: true
##  -Context Sensitive: Y/N 
##
#########################################################################################################################
##
##  Report Table of Contents
#########################################################################################################################
##
##  1. DATA_SOURCES
##  2. CONSTANTS
##  3. WORD_HTML_HEAD
##  	3.1 WORD_STYLE_SHEET
##      3.2 WORD_PAGE_DEFINITIONS_STYLE_SHEET 
##  	3.3 WORD_TABLE_STYLE_SHEET
##  4. PDF_HTML_HEAD
##  	4.1 PDF_STYLE_SHEET
##      	4.1.1 PDF_TABLE_OF_STYLE_SHEET 
##          	4.1.1.1 PDF_COUNTERS_STYLE_SHEET 
##      	4.2 PDF_PAGE_DEFINITIONS_STYLE_SHEET 
##  		4.3 PDF_TABLE_STYLE_SHEET
##  5. MACROS
##  	5.1 STANDARD_MACROS
##  	5.2 ITEM_TYPE_MACROS
##  	5.3 BODY_MACRO
##  		5.3.1 WORD_WORKAROUND_HEADER
##  		5.3.2 PDF_HEADER 
##  		5.3.3 TITLE_PAGE
##  		5.3.4 TABLE_OF_CONTENTS
##  		5.3.5 TABLE_OF_FIGURES
##  		5.3.6 TABLE_OF_TABLES
##  		5.3.7 CHANGE_HISTORY
##  		5.3.8 OUTPUT_DOCUMENT_LIST
##  			5.3.8.1 ITEM_TYPE_MAP
##  6. DOCUMENT_INITIALIZATION
##  7. REPORT_BODY
##  8. MS_WORD_OBJECTS
##  9. WORD_HEADER_FOOTER
##  10. WORD_EMBEDDED_FILE_LIST
##
#########################################################################################################################
##
##  Instructions for Customizing
#########################################################################################################################
##  
##  1. Location the section named TITLE_PAGE
##  2. Replace with the content with the desired title page
##  3. Location the section named HEADER_FOOTER
##  4. Replace the header and footer content as desired
##  5. Locate the section named ITEM_TYPE_MAP
##  6. Add a new mapping for the desired item type using an existing format macro or a newly defined one
##  7. Location the section named ITEM_TYPE_MACROS
##  8. Create a macro for the new item types at the end of the list of macros. Use the existing macros as examples.
##
#########################################################################################################################
##
##  1. DATA_SOURCES
##
#########################################################################################################################
##
## Data Sources available without declaration
##-------------------------------------------
## $project
## $documentList
## $baseUrl
##
## Data Sources loaded for this report
##-------------------------------------------
#if( $documentSource ) ##
  ## Jama 8.44 or greater
  ## Jama 8.42 if New Velocity Feature Flag Enabled
  #set( $docDao = $documentSource )
  #set( $documentNodeDao = $documentSource )
  #set( $attachmentDao = $documentSource )
  #set( $attachmentService = $documentSource )
  #set( $relDao = $documentSource )
  #set( $versionDao = $documentSource )
  #set( $testRunDao = $testSource )
  #set( $velocityServiceWrapper = $documentSource )
  #set( $baselineDao = $baselineSource )
  #set( $contourItemDao = $documentSource)
  #set( $tRunDao = $testSource)
  #set( $testPlanDao = $testSource)
  #set( $testSetDao = $testSource)
  #set( $testCycleDao = $testSource)
  #set( $userDao = $userSource)
  ##
#else
  ## Jama 8.43 or older
  #set( $docDao = $applicationContext.getBean("documentDao"))
  #set( $documentNodeDao = $applicationContext.getBean("documentNodeDao"))
  #set( $attachmentDao = $applicationContext.getBean("attachmentDao"))
  #set( $attachmentService = $applicationContext.getBean("attachmentService"))
  #set( $relDao = $applicationContext.getBean("relationshipDao") )
  #set( $versionDao = $applicationContext.getBean("versionDao") )
  #set( $testRunDao = $applicationContext.getBean("testRunDao") )
  ## $velocityServiceWrapper is already available
  #set( $baselineDao = $applicationContext.getBean("baseLineDao") )
  #set( $contourItemDao = $applicationContext.getBean("documentDao"))
  #set( $tRunDao = $applicationContext.getBean("testDao"))
  #set( $testPlanDao = $applicationContext.getBean("testDao"))
  #set( $testSetDao = $applicationContext.getBean("testDao"))
  #set( $testCycleDao = $applicationContext.getBean("testDao"))
  #set( $userDao = $applicationContext.getBean("userDao"))
##
#end
##
## Report Parameters
##-------------------------------------------

#if( !$report_testPlanId)
    Please select a Test Plan
    #stop
#end

#if($!contextType && $contextType.toUpperCase().contains("BASELINE") )
  #set( $baselineMode = true)
#else
  #if( $reportBaseline )
    #set( $baselineMode = $reportBaseline )
  #else
    #set( $baselineMode = false )
  #end
#end

#if( $reportTestRuns )
  #set( $testRunMode = $reportTestRuns )
#else
  #set( $testRunMode = false )
#end
##
#########################################################################################################################
## **********************************************************************************************************************
##
##  2. CONSTANTS
##
##  >>>> Modify global constants for the report here <<<<
##
## **********************************************************************************************************************
#########################################################################################################################
#set( $boundaryString = "------=_NextPart_01D506B0.1F52D2B0") ##
#set( $filePrefix = "file:///C:/D993472D/WordTemplate.fld/") ##
#set( $cmpKey = "CMP") ##
#set( $setKey = "SET") ##
#set( $fldKey = "FLD") ##
#set( $txtKey = "TXT") ##
#set( $objectTypeField = "object_type" ) ##
#set( $timeZone = "America/Los_Angeles" ) ##
##
## Object Types
#set( $informationObjectType = "Information" )
#set( $informationWoHeadingObjectType = "Information without Heading" )
##
## 
## Status values to exlude from export
#set( $excludedStatuses = ["Rejected","Deleted"] ) ##
##
## Maximum image width and height in points.  
## 468 pt is equivalant to 6.5"
## 612 pt is equivalant to 8.5"
#set ($maxPageWidth = 468) ##
#set ($maxPageHeight = 612) ##
##



#set( $tableRefNum = 0) ## 'doc' Counter -> Tables
#set( $figureRefNum = 0) ## 'doc' Counter -> Figures 
#set( $equationRefNum = 0) ## 'pdf' or 'doc' Counter -> Equations 

## Automatically include a TOF or TOT for Word if 'true' (PDF select option at time of report install)
#set( $tableOfFigures = false )
#set( $tableOfTables = false )

## All Tables/Figures with captions/figcaptions will be included in the TOT and TOF 
## Automatically include all other Tables/Figures exported regardless of captions/figcaptions
#set( $TOT_includeAllTables = false )
#set( $TOF_includeAllFigures = false )


## Formatting
#set( $tableHeaderBackgroundColor = "#F2F2F2" )
#set( $tableBorderColor = "#7F7F7F" )


## iText PDF does not have Arial, the closest typeface it has is Helvetica
## Arimo is very close in appearance to Arial, and the remote accessible font is linked in the PDF head
#if( $format == "doc" )
	##set( $primaryFont = "Calibri")
	#set( $primaryFont = "Arial")
#else ## pdf, html 
	#set( $primaryFont = "Arimo")  	
  	##set( $primaryFont = "Helvetica")
#end

#set( $primaryFontSize = "11pt")
#set( $h1FontSize = "16pt")
#set( $h2FontSize = "13pt")
#set( $h3FontSize = "12pt")
#set( $h4FontSize = "11pt")
#set( $h5FontSize = "11pt")
#set( $h6FontSize = "11pt")
#set( $h7FontSize = "11pt")
#set( $tableCellFontSize = "10pt")

#########################################################################################################################
## **********************************************************************************************************************
#########################################################################################################################
##
#########################################################################################################################
##
##  3. WORD_HTML_HEAD
##
#########################################################################################################################
#if( $format == "doc")

------=_NextPart_01D506B0.1F52D2B0
Content-Location: file:///C:/D993472D/WordTemplate.htm
Content-Transfer-Encoding: quoted-printable
Content-Type: text/html; charset="utf-8"

<html xmlns:v=3D"urn:schemas-microsoft-com:vml"
xmlns:o=3D"urn:schemas-microsoft-com:office:office"
xmlns:w=3D"urn:schemas-microsoft-com:office:word"
xmlns:m=3D"http://schemas.microsoft.com/office/2004/12/omml"
xmlns=3D"http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=3DContent-Type content=3D"text/html; charset=3Dutf-8">
<meta name=3DProgId content=3DWord.Document>
<meta name=3DGenerator content=3D"Microsoft Word 15">
<meta name=3DOriginator content=3D"Microsoft Word 15">
<link rel=3DFile-List href=3D"WordTemplate.fld/filelist.xml">
<link rel=3DEdit-Time-Data href=3D"WordTemplate.fld/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Jama Software</o:Author>
  <o:LastAuthor>Jama Software</o:LastAuthor>
 </o:DocumentProperties>
 <o:OfficeDocumentSettings>
  <o:AllowPNG/>
 </o:OfficeDocumentSettings>
</xml><![endif]-->
<link rel=3DdataStoreItem href=3D"WordTemplate.fld/item0001.xml" target=3D"WordTemplate.fld/props001.xml">
<link rel=3DthemeData href=3D"WordTemplate.fld/themedata.thmx">
<link rel=3DcolorSchemeMapping href=3D"WordTemplate.fld/colorschememapping.xml">
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:View>Print</w:View>
  <w:Zoom>100</w:Zoom>
  <w:SpellingState>Clean</w:SpellingState>
  <w:GrammarState>Clean</w:GrammarState>
  <w:TrackMoves>false</w:TrackMoves>
  <w:TrackFormatting/>
  <w:PunctuationKerning/>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:DoNotPromoteQF/>
  <w:LidThemeOther>EN-US</w:LidThemeOther>
  <w:LidThemeAsian>X-NONE</w:LidThemeAsian>
  <w:LidThemeComplexScript>X-NONE</w:LidThemeComplexScript>
  <w:Compatibility>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:DontGrowAutofit/>
   <w:SplitPgBreakAndParaMark/>
   <w:EnableOpenTypeKerning/>
   <w:DontFlipMirrorIndents/>
   <w:OverrideTableStyleHps/>
  </w:Compatibility>
  <m:mathPr>
   <m:mathFont m:val=3D"Cambria Math"/>
   <m:brkBin m:val=3D"before"/>
   <m:brkBinSub m:val=3D"&#45;-"/>
   <m:smallFrac m:val=3D"off"/>
   <m:dispDef/>
   <m:lMargin m:val=3D"0"/>
   <m:rMargin m:val=3D"0"/>
   <m:defJc m:val=3D"centerGroup"/>
   <m:wrapIndent m:val=3D"1440"/>
   <m:intLim m:val=3D"subSup"/>
   <m:naryLim m:val=3D"undOvr"/>
  </m:mathPr></w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState=3D"false" DefUnhideWhenUsed=3D"false"
  DefSemiHidden=3D"false" DefQFormat=3D"false" DefPriority=3D"99"
  LatentStyleCount=3D"376">
  <w:LsdException Locked=3D"false" Priority=3D"0" QFormat=3D"true" Name=3D"Normal"/>
  <w:LsdException Locked=3D"false" Priority=3D"9" QFormat=3D"true" Name=3D"heading 1"/>
  <w:LsdException Locked=3D"false" Priority=3D"9" SemiHidden=3D"true"
   UnhideWhenUsed=3D"true" QFormat=3D"true" Name=3D"heading 2"/>
  <w:LsdException Locked=3D"false" Priority=3D"9" SemiHidden=3D"true"
   UnhideWhenUsed=3D"true" QFormat=3D"true" Name=3D"heading 3"/>
  <w:LsdException Locked=3D"false" Priority=3D"9" SemiHidden=3D"true"
   UnhideWhenUsed=3D"true" QFormat=3D"true" Name=3D"heading 4"/>
  <w:LsdException Locked=3D"false" Priority=3D"9" SemiHidden=3D"true"
   UnhideWhenUsed=3D"true" QFormat=3D"true" Name=3D"heading 5"/>
  <w:LsdException Locked=3D"false" Priority=3D"9" SemiHidden=3D"true"
   UnhideWhenUsed=3D"true" QFormat=3D"true" Name=3D"heading 6"/>
  <w:LsdException Locked=3D"false" Priority=3D"9" SemiHidden=3D"true"
   UnhideWhenUsed=3D"true" QFormat=3D"true" Name=3D"heading 7"/>
  <w:LsdException Locked=3D"false" Priority=3D"9" SemiHidden=3D"true"
   UnhideWhenUsed=3D"true" QFormat=3D"true" Name=3D"heading 8"/>
  <w:LsdException Locked=3D"false" Priority=3D"9" SemiHidden=3D"true"
   UnhideWhenUsed=3D"true" QFormat=3D"true" Name=3D"heading 9"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"index 1"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"index 2"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"index 3"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"index 4"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"index 5"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"index 6"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"index 7"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"index 8"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"index 9"/>
  <w:LsdException Locked=3D"false" Priority=3D"39" SemiHidden=3D"true"
   UnhideWhenUsed=3D"true" Name=3D"toc 1"/>
  <w:LsdException Locked=3D"false" Priority=3D"39" SemiHidden=3D"true"
   UnhideWhenUsed=3D"true" Name=3D"toc 2"/>
  <w:LsdException Locked=3D"false" Priority=3D"39" SemiHidden=3D"true"
   UnhideWhenUsed=3D"true" Name=3D"toc 3"/>
  <w:LsdException Locked=3D"false" Priority=3D"39" SemiHidden=3D"true"
   UnhideWhenUsed=3D"true" Name=3D"toc 4"/>
  <w:LsdException Locked=3D"false" Priority=3D"39" SemiHidden=3D"true"
   UnhideWhenUsed=3D"true" Name=3D"toc 5"/>
  <w:LsdException Locked=3D"false" Priority=3D"39" SemiHidden=3D"true"
   UnhideWhenUsed=3D"true" Name=3D"toc 6"/>
  <w:LsdException Locked=3D"false" Priority=3D"39" SemiHidden=3D"true"
   UnhideWhenUsed=3D"true" Name=3D"toc 7"/>
  <w:LsdException Locked=3D"false" Priority=3D"39" SemiHidden=3D"true"
   UnhideWhenUsed=3D"true" Name=3D"toc 8"/>
  <w:LsdException Locked=3D"false" Priority=3D"39" SemiHidden=3D"true"
   UnhideWhenUsed=3D"true" Name=3D"toc 9"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Normal Indent"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"footnote text"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"annotation text"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"header"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"footer"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"index heading"/>
  <w:LsdException Locked=3D"false" Priority=3D"35" SemiHidden=3D"true"
   UnhideWhenUsed=3D"true" QFormat=3D"true" Name=3D"caption"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"table of figures"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"envelope address"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"envelope return"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"footnote reference"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"annotation reference"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"line number"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"page number"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"endnote reference"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"endnote text"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"table of authorities"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"macro"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"toa heading"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"List"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"List Bullet"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"List Number"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"List 2"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"List 3"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"List 4"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"List 5"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"List Bullet 2"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"List Bullet 3"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"List Bullet 4"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"List Bullet 5"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"List Number 2"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"List Number 3"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"List Number 4"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"List Number 5"/>
  <w:LsdException Locked=3D"false" Priority=3D"10" QFormat=3D"true" Name=3D"Title"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Closing"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Signature"/>
  <w:LsdException Locked=3D"false" Priority=3D"1" SemiHidden=3D"true"
   UnhideWhenUsed=3D"true" Name=3D"Default Paragraph Font"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Body Text"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Body Text Indent"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"List Continue"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"List Continue 2"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"List Continue 3"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"List Continue 4"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"List Continue 5"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Message Header"/>
  <w:LsdException Locked=3D"false" Priority=3D"11" QFormat=3D"true" Name=3D"Subtitle"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Salutation"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Date"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Body Text First Indent"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Body Text First Indent 2"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Note Heading"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Body Text 2"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Body Text 3"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Body Text Indent 2"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Body Text Indent 3"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Block Text"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Hyperlink"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"FollowedHyperlink"/>
  <w:LsdException Locked=3D"false" Priority=3D"22" QFormat=3D"true" Name=3D"Strong"/>
  <w:LsdException Locked=3D"false" Priority=3D"20" QFormat=3D"true" Name=3D"Emphasis"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Document Map"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Plain Text"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"E-mail Signature"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"HTML Top of Form"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"HTML Bottom of Form"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Normal (Web)"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"HTML Acronym"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"HTML Address"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"HTML Cite"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"HTML Code"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"HTML Definition"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"HTML Keyboard"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"HTML Preformatted"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"HTML Sample"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"HTML Typewriter"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"HTML Variable"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Normal Table"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"annotation subject"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"No List"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Outline List 1"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Outline List 2"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Outline List 3"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table Simple 1"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table Simple 2"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table Simple 3"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table Classic 1"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table Classic 2"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table Classic 3"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table Classic 4"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table Colorful 1"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table Colorful 2"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table Colorful 3"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table Columns 1"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table Columns 2"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table Columns 3"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table Columns 4"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table Columns 5"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table Grid 1"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table Grid 2"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table Grid 3"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table Grid 4"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table Grid 5"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table Grid 6"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table Grid 7"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table Grid 8"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table List 1"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table List 2"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table List 3"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table List 4"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table List 5"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table List 6"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table List 7"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table List 8"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table 3D effects 1"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table 3D effects 2"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table 3D effects 3"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table Contemporary"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table Elegant"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table Professional"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table Subtle 1"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table Subtle 2"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table Web 1"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table Web 2"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table Web 3"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Balloon Text"/>
  <w:LsdException Locked=3D"false" Priority=3D"39" Name=3D"Table Grid"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Table Theme"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" Name=3D"Placeholder Text"/>
  <w:LsdException Locked=3D"false" Priority=3D"1" QFormat=3D"true" Name=3D"No Spacing"/>
  <w:LsdException Locked=3D"false" Priority=3D"60" Name=3D"Light Shading"/>
  <w:LsdException Locked=3D"false" Priority=3D"61" Name=3D"Light List"/>
  <w:LsdException Locked=3D"false" Priority=3D"62" Name=3D"Light Grid"/>
  <w:LsdException Locked=3D"false" Priority=3D"63" Name=3D"Medium Shading 1"/>
  <w:LsdException Locked=3D"false" Priority=3D"64" Name=3D"Medium Shading 2"/>
  <w:LsdException Locked=3D"false" Priority=3D"65" Name=3D"Medium List 1"/>
  <w:LsdException Locked=3D"false" Priority=3D"66" Name=3D"Medium List 2"/>
  <w:LsdException Locked=3D"false" Priority=3D"67" Name=3D"Medium Grid 1"/>
  <w:LsdException Locked=3D"false" Priority=3D"68" Name=3D"Medium Grid 2"/>
  <w:LsdException Locked=3D"false" Priority=3D"69" Name=3D"Medium Grid 3"/>
  <w:LsdException Locked=3D"false" Priority=3D"70" Name=3D"Dark List"/>
  <w:LsdException Locked=3D"false" Priority=3D"71" Name=3D"Colorful Shading"/>
  <w:LsdException Locked=3D"false" Priority=3D"72" Name=3D"Colorful List"/>
  <w:LsdException Locked=3D"false" Priority=3D"73" Name=3D"Colorful Grid"/>
  <w:LsdException Locked=3D"false" Priority=3D"60" Name=3D"Light Shading Accent 1"/>
  <w:LsdException Locked=3D"false" Priority=3D"61" Name=3D"Light List Accent 1"/>
  <w:LsdException Locked=3D"false" Priority=3D"62" Name=3D"Light Grid Accent 1"/>
  <w:LsdException Locked=3D"false" Priority=3D"63" Name=3D"Medium Shading 1 Accent 1"/>
  <w:LsdException Locked=3D"false" Priority=3D"64" Name=3D"Medium Shading 2 Accent 1"/>
  <w:LsdException Locked=3D"false" Priority=3D"65" Name=3D"Medium List 1 Accent 1"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" Name=3D"Revision"/>
  <w:LsdException Locked=3D"false" Priority=3D"34" QFormat=3D"true"
   Name=3D"List Paragraph"/>
  <w:LsdException Locked=3D"false" Priority=3D"29" QFormat=3D"true" Name=3D"Quote"/>
  <w:LsdException Locked=3D"false" Priority=3D"30" QFormat=3D"true"
   Name=3D"Intense Quote"/>
  <w:LsdException Locked=3D"false" Priority=3D"66" Name=3D"Medium List 2 Accent 1"/>
  <w:LsdException Locked=3D"false" Priority=3D"67" Name=3D"Medium Grid 1 Accent 1"/>
  <w:LsdException Locked=3D"false" Priority=3D"68" Name=3D"Medium Grid 2 Accent 1"/>
  <w:LsdException Locked=3D"false" Priority=3D"69" Name=3D"Medium Grid 3 Accent 1"/>
  <w:LsdException Locked=3D"false" Priority=3D"70" Name=3D"Dark List Accent 1"/>
  <w:LsdException Locked=3D"false" Priority=3D"71" Name=3D"Colorful Shading Accent 1"/>
  <w:LsdException Locked=3D"false" Priority=3D"72" Name=3D"Colorful List Accent 1"/>
  <w:LsdException Locked=3D"false" Priority=3D"73" Name=3D"Colorful Grid Accent 1"/>
  <w:LsdException Locked=3D"false" Priority=3D"60" Name=3D"Light Shading Accent 2"/>
  <w:LsdException Locked=3D"false" Priority=3D"61" Name=3D"Light List Accent 2"/>
  <w:LsdException Locked=3D"false" Priority=3D"62" Name=3D"Light Grid Accent 2"/>
  <w:LsdException Locked=3D"false" Priority=3D"63" Name=3D"Medium Shading 1 Accent 2"/>
  <w:LsdException Locked=3D"false" Priority=3D"64" Name=3D"Medium Shading 2 Accent 2"/>
  <w:LsdException Locked=3D"false" Priority=3D"65" Name=3D"Medium List 1 Accent 2"/>
  <w:LsdException Locked=3D"false" Priority=3D"66" Name=3D"Medium List 2 Accent 2"/>
  <w:LsdException Locked=3D"false" Priority=3D"67" Name=3D"Medium Grid 1 Accent 2"/>
  <w:LsdException Locked=3D"false" Priority=3D"68" Name=3D"Medium Grid 2 Accent 2"/>
  <w:LsdException Locked=3D"false" Priority=3D"69" Name=3D"Medium Grid 3 Accent 2"/>
  <w:LsdException Locked=3D"false" Priority=3D"70" Name=3D"Dark List Accent 2"/>
  <w:LsdException Locked=3D"false" Priority=3D"71" Name=3D"Colorful Shading Accent 2"/>
  <w:LsdException Locked=3D"false" Priority=3D"72" Name=3D"Colorful List Accent 2"/>
  <w:LsdException Locked=3D"false" Priority=3D"73" Name=3D"Colorful Grid Accent 2"/>
  <w:LsdException Locked=3D"false" Priority=3D"60" Name=3D"Light Shading Accent 3"/>
  <w:LsdException Locked=3D"false" Priority=3D"61" Name=3D"Light List Accent 3"/>
  <w:LsdException Locked=3D"false" Priority=3D"62" Name=3D"Light Grid Accent 3"/>
  <w:LsdException Locked=3D"false" Priority=3D"63" Name=3D"Medium Shading 1 Accent 3"/>
  <w:LsdException Locked=3D"false" Priority=3D"64" Name=3D"Medium Shading 2 Accent 3"/>
  <w:LsdException Locked=3D"false" Priority=3D"65" Name=3D"Medium List 1 Accent 3"/>
  <w:LsdException Locked=3D"false" Priority=3D"66" Name=3D"Medium List 2 Accent 3"/>
  <w:LsdException Locked=3D"false" Priority=3D"67" Name=3D"Medium Grid 1 Accent 3"/>
  <w:LsdException Locked=3D"false" Priority=3D"68" Name=3D"Medium Grid 2 Accent 3"/>
  <w:LsdException Locked=3D"false" Priority=3D"69" Name=3D"Medium Grid 3 Accent 3"/>
  <w:LsdException Locked=3D"false" Priority=3D"70" Name=3D"Dark List Accent 3"/>
  <w:LsdException Locked=3D"false" Priority=3D"71" Name=3D"Colorful Shading Accent 3"/>
  <w:LsdException Locked=3D"false" Priority=3D"72" Name=3D"Colorful List Accent 3"/>
  <w:LsdException Locked=3D"false" Priority=3D"73" Name=3D"Colorful Grid Accent 3"/>
  <w:LsdException Locked=3D"false" Priority=3D"60" Name=3D"Light Shading Accent 4"/>
  <w:LsdException Locked=3D"false" Priority=3D"61" Name=3D"Light List Accent 4"/>
  <w:LsdException Locked=3D"false" Priority=3D"62" Name=3D"Light Grid Accent 4"/>
  <w:LsdException Locked=3D"false" Priority=3D"63" Name=3D"Medium Shading 1 Accent 4"/>
  <w:LsdException Locked=3D"false" Priority=3D"64" Name=3D"Medium Shading 2 Accent 4"/>
  <w:LsdException Locked=3D"false" Priority=3D"65" Name=3D"Medium List 1 Accent 4"/>
  <w:LsdException Locked=3D"false" Priority=3D"66" Name=3D"Medium List 2 Accent 4"/>
  <w:LsdException Locked=3D"false" Priority=3D"67" Name=3D"Medium Grid 1 Accent 4"/>
  <w:LsdException Locked=3D"false" Priority=3D"68" Name=3D"Medium Grid 2 Accent 4"/>
  <w:LsdException Locked=3D"false" Priority=3D"69" Name=3D"Medium Grid 3 Accent 4"/>
  <w:LsdException Locked=3D"false" Priority=3D"70" Name=3D"Dark List Accent 4"/>
  <w:LsdException Locked=3D"false" Priority=3D"71" Name=3D"Colorful Shading Accent 4"/>
  <w:LsdException Locked=3D"false" Priority=3D"72" Name=3D"Colorful List Accent 4"/>
  <w:LsdException Locked=3D"false" Priority=3D"73" Name=3D"Colorful Grid Accent 4"/>
  <w:LsdException Locked=3D"false" Priority=3D"60" Name=3D"Light Shading Accent 5"/>
  <w:LsdException Locked=3D"false" Priority=3D"61" Name=3D"Light List Accent 5"/>
  <w:LsdException Locked=3D"false" Priority=3D"62" Name=3D"Light Grid Accent 5"/>
  <w:LsdException Locked=3D"false" Priority=3D"63" Name=3D"Medium Shading 1 Accent 5"/>
  <w:LsdException Locked=3D"false" Priority=3D"64" Name=3D"Medium Shading 2 Accent 5"/>
  <w:LsdException Locked=3D"false" Priority=3D"65" Name=3D"Medium List 1 Accent 5"/>
  <w:LsdException Locked=3D"false" Priority=3D"66" Name=3D"Medium List 2 Accent 5"/>
  <w:LsdException Locked=3D"false" Priority=3D"67" Name=3D"Medium Grid 1 Accent 5"/>
  <w:LsdException Locked=3D"false" Priority=3D"68" Name=3D"Medium Grid 2 Accent 5"/>
  <w:LsdException Locked=3D"false" Priority=3D"69" Name=3D"Medium Grid 3 Accent 5"/>
  <w:LsdException Locked=3D"false" Priority=3D"70" Name=3D"Dark List Accent 5"/>
  <w:LsdException Locked=3D"false" Priority=3D"71" Name=3D"Colorful Shading Accent 5"/>
  <w:LsdException Locked=3D"false" Priority=3D"72" Name=3D"Colorful List Accent 5"/>
  <w:LsdException Locked=3D"false" Priority=3D"73" Name=3D"Colorful Grid Accent 5"/>
  <w:LsdException Locked=3D"false" Priority=3D"60" Name=3D"Light Shading Accent 6"/>
  <w:LsdException Locked=3D"false" Priority=3D"61" Name=3D"Light List Accent 6"/>
  <w:LsdException Locked=3D"false" Priority=3D"62" Name=3D"Light Grid Accent 6"/>
  <w:LsdException Locked=3D"false" Priority=3D"63" Name=3D"Medium Shading 1 Accent 6"/>
  <w:LsdException Locked=3D"false" Priority=3D"64" Name=3D"Medium Shading 2 Accent 6"/>
  <w:LsdException Locked=3D"false" Priority=3D"65" Name=3D"Medium List 1 Accent 6"/>
  <w:LsdException Locked=3D"false" Priority=3D"66" Name=3D"Medium List 2 Accent 6"/>
  <w:LsdException Locked=3D"false" Priority=3D"67" Name=3D"Medium Grid 1 Accent 6"/>
  <w:LsdException Locked=3D"false" Priority=3D"68" Name=3D"Medium Grid 2 Accent 6"/>
  <w:LsdException Locked=3D"false" Priority=3D"69" Name=3D"Medium Grid 3 Accent 6"/>
  <w:LsdException Locked=3D"false" Priority=3D"70" Name=3D"Dark List Accent 6"/>
  <w:LsdException Locked=3D"false" Priority=3D"71" Name=3D"Colorful Shading Accent 6"/>
  <w:LsdException Locked=3D"false" Priority=3D"72" Name=3D"Colorful List Accent 6"/>
  <w:LsdException Locked=3D"false" Priority=3D"73" Name=3D"Colorful Grid Accent 6"/>
  <w:LsdException Locked=3D"false" Priority=3D"19" QFormat=3D"true"
   Name=3D"Subtle Emphasis"/>
  <w:LsdException Locked=3D"false" Priority=3D"21" QFormat=3D"true"
   Name=3D"Intense Emphasis"/>
  <w:LsdException Locked=3D"false" Priority=3D"31" QFormat=3D"true"
   Name=3D"Subtle Reference"/>
  <w:LsdException Locked=3D"false" Priority=3D"32" QFormat=3D"true"
   Name=3D"Intense Reference"/>
  <w:LsdException Locked=3D"false" Priority=3D"33" QFormat=3D"true" Name=3D"Book Title"/>
  <w:LsdException Locked=3D"false" Priority=3D"37" SemiHidden=3D"true"
   UnhideWhenUsed=3D"true" Name=3D"Bibliography"/>
  <w:LsdException Locked=3D"false" Priority=3D"39" SemiHidden=3D"true"
   UnhideWhenUsed=3D"true" QFormat=3D"true" Name=3D"TOC Heading"/>
  <w:LsdException Locked=3D"false" Priority=3D"41" Name=3D"Plain Table 1"/>
  <w:LsdException Locked=3D"false" Priority=3D"42" Name=3D"Plain Table 2"/>
  <w:LsdException Locked=3D"false" Priority=3D"43" Name=3D"Plain Table 3"/>
  <w:LsdException Locked=3D"false" Priority=3D"44" Name=3D"Plain Table 4"/>
  <w:LsdException Locked=3D"false" Priority=3D"45" Name=3D"Plain Table 5"/>
  <w:LsdException Locked=3D"false" Priority=3D"40" Name=3D"Grid Table Light"/>
  <w:LsdException Locked=3D"false" Priority=3D"46" Name=3D"Grid Table 1 Light"/>
  <w:LsdException Locked=3D"false" Priority=3D"47" Name=3D"Grid Table 2"/>
  <w:LsdException Locked=3D"false" Priority=3D"48" Name=3D"Grid Table 3"/>
  <w:LsdException Locked=3D"false" Priority=3D"49" Name=3D"Grid Table 4"/>
  <w:LsdException Locked=3D"false" Priority=3D"50" Name=3D"Grid Table 5 Dark"/>
  <w:LsdException Locked=3D"false" Priority=3D"51" Name=3D"Grid Table 6 Colorful"/>
  <w:LsdException Locked=3D"false" Priority=3D"52" Name=3D"Grid Table 7 Colorful"/>
  <w:LsdException Locked=3D"false" Priority=3D"46"
   Name=3D"Grid Table 1 Light Accent 1"/>
  <w:LsdException Locked=3D"false" Priority=3D"47" Name=3D"Grid Table 2 Accent 1"/>
  <w:LsdException Locked=3D"false" Priority=3D"48" Name=3D"Grid Table 3 Accent 1"/>
  <w:LsdException Locked=3D"false" Priority=3D"49" Name=3D"Grid Table 4 Accent 1"/>
  <w:LsdException Locked=3D"false" Priority=3D"50" Name=3D"Grid Table 5 Dark Accent 1"/>
  <w:LsdException Locked=3D"false" Priority=3D"51"
   Name=3D"Grid Table 6 Colorful Accent 1"/>
  <w:LsdException Locked=3D"false" Priority=3D"52"
   Name=3D"Grid Table 7 Colorful Accent 1"/>
  <w:LsdException Locked=3D"false" Priority=3D"46"
   Name=3D"Grid Table 1 Light Accent 2"/>
  <w:LsdException Locked=3D"false" Priority=3D"47" Name=3D"Grid Table 2 Accent 2"/>
  <w:LsdException Locked=3D"false" Priority=3D"48" Name=3D"Grid Table 3 Accent 2"/>
  <w:LsdException Locked=3D"false" Priority=3D"49" Name=3D"Grid Table 4 Accent 2"/>
  <w:LsdException Locked=3D"false" Priority=3D"50" Name=3D"Grid Table 5 Dark Accent 2"/>
  <w:LsdException Locked=3D"false" Priority=3D"51"
   Name=3D"Grid Table 6 Colorful Accent 2"/>
  <w:LsdException Locked=3D"false" Priority=3D"52"
   Name=3D"Grid Table 7 Colorful Accent 2"/>
  <w:LsdException Locked=3D"false" Priority=3D"46"
   Name=3D"Grid Table 1 Light Accent 3"/>
  <w:LsdException Locked=3D"false" Priority=3D"47" Name=3D"Grid Table 2 Accent 3"/>
  <w:LsdException Locked=3D"false" Priority=3D"48" Name=3D"Grid Table 3 Accent 3"/>
  <w:LsdException Locked=3D"false" Priority=3D"49" Name=3D"Grid Table 4 Accent 3"/>
  <w:LsdException Locked=3D"false" Priority=3D"50" Name=3D"Grid Table 5 Dark Accent 3"/>
  <w:LsdException Locked=3D"false" Priority=3D"51"
   Name=3D"Grid Table 6 Colorful Accent 3"/>
  <w:LsdException Locked=3D"false" Priority=3D"52"
   Name=3D"Grid Table 7 Colorful Accent 3"/>
  <w:LsdException Locked=3D"false" Priority=3D"46"
   Name=3D"Grid Table 1 Light Accent 4"/>
  <w:LsdException Locked=3D"false" Priority=3D"47" Name=3D"Grid Table 2 Accent 4"/>
  <w:LsdException Locked=3D"false" Priority=3D"48" Name=3D"Grid Table 3 Accent 4"/>
  <w:LsdException Locked=3D"false" Priority=3D"49" Name=3D"Grid Table 4 Accent 4"/>
  <w:LsdException Locked=3D"false" Priority=3D"50" Name=3D"Grid Table 5 Dark Accent 4"/>
  <w:LsdException Locked=3D"false" Priority=3D"51"
   Name=3D"Grid Table 6 Colorful Accent 4"/>
  <w:LsdException Locked=3D"false" Priority=3D"52"
   Name=3D"Grid Table 7 Colorful Accent 4"/>
  <w:LsdException Locked=3D"false" Priority=3D"46"
   Name=3D"Grid Table 1 Light Accent 5"/>
  <w:LsdException Locked=3D"false" Priority=3D"47" Name=3D"Grid Table 2 Accent 5"/>
  <w:LsdException Locked=3D"false" Priority=3D"48" Name=3D"Grid Table 3 Accent 5"/>
  <w:LsdException Locked=3D"false" Priority=3D"49" Name=3D"Grid Table 4 Accent 5"/>
  <w:LsdException Locked=3D"false" Priority=3D"50" Name=3D"Grid Table 5 Dark Accent 5"/>
  <w:LsdException Locked=3D"false" Priority=3D"51"
   Name=3D"Grid Table 6 Colorful Accent 5"/>
  <w:LsdException Locked=3D"false" Priority=3D"52"
   Name=3D"Grid Table 7 Colorful Accent 5"/>
  <w:LsdException Locked=3D"false" Priority=3D"46"
   Name=3D"Grid Table 1 Light Accent 6"/>
  <w:LsdException Locked=3D"false" Priority=3D"47" Name=3D"Grid Table 2 Accent 6"/>
  <w:LsdException Locked=3D"false" Priority=3D"48" Name=3D"Grid Table 3 Accent 6"/>
  <w:LsdException Locked=3D"false" Priority=3D"49" Name=3D"Grid Table 4 Accent 6"/>
  <w:LsdException Locked=3D"false" Priority=3D"50" Name=3D"Grid Table 5 Dark Accent 6"/>
  <w:LsdException Locked=3D"false" Priority=3D"51"
   Name=3D"Grid Table 6 Colorful Accent 6"/>
  <w:LsdException Locked=3D"false" Priority=3D"52"
   Name=3D"Grid Table 7 Colorful Accent 6"/>
  <w:LsdException Locked=3D"false" Priority=3D"46" Name=3D"List Table 1 Light"/>
  <w:LsdException Locked=3D"false" Priority=3D"47" Name=3D"List Table 2"/>
  <w:LsdException Locked=3D"false" Priority=3D"48" Name=3D"List Table 3"/>
  <w:LsdException Locked=3D"false" Priority=3D"49" Name=3D"List Table 4"/>
  <w:LsdException Locked=3D"false" Priority=3D"50" Name=3D"List Table 5 Dark"/>
  <w:LsdException Locked=3D"false" Priority=3D"51" Name=3D"List Table 6 Colorful"/>
  <w:LsdException Locked=3D"false" Priority=3D"52" Name=3D"List Table 7 Colorful"/>
  <w:LsdException Locked=3D"false" Priority=3D"46"
   Name=3D"List Table 1 Light Accent 1"/>
  <w:LsdException Locked=3D"false" Priority=3D"47" Name=3D"List Table 2 Accent 1"/>
  <w:LsdException Locked=3D"false" Priority=3D"48" Name=3D"List Table 3 Accent 1"/>
  <w:LsdException Locked=3D"false" Priority=3D"49" Name=3D"List Table 4 Accent 1"/>
  <w:LsdException Locked=3D"false" Priority=3D"50" Name=3D"List Table 5 Dark Accent 1"/>
  <w:LsdException Locked=3D"false" Priority=3D"51"
   Name=3D"List Table 6 Colorful Accent 1"/>
  <w:LsdException Locked=3D"false" Priority=3D"52"
   Name=3D"List Table 7 Colorful Accent 1"/>
  <w:LsdException Locked=3D"false" Priority=3D"46"
   Name=3D"List Table 1 Light Accent 2"/>
  <w:LsdException Locked=3D"false" Priority=3D"47" Name=3D"List Table 2 Accent 2"/>
  <w:LsdException Locked=3D"false" Priority=3D"48" Name=3D"List Table 3 Accent 2"/>
  <w:LsdException Locked=3D"false" Priority=3D"49" Name=3D"List Table 4 Accent 2"/>
  <w:LsdException Locked=3D"false" Priority=3D"50" Name=3D"List Table 5 Dark Accent 2"/>
  <w:LsdException Locked=3D"false" Priority=3D"51"
   Name=3D"List Table 6 Colorful Accent 2"/>
  <w:LsdException Locked=3D"false" Priority=3D"52"
   Name=3D"List Table 7 Colorful Accent 2"/>
  <w:LsdException Locked=3D"false" Priority=3D"46"
   Name=3D"List Table 1 Light Accent 3"/>
  <w:LsdException Locked=3D"false" Priority=3D"47" Name=3D"List Table 2 Accent 3"/>
  <w:LsdException Locked=3D"false" Priority=3D"48" Name=3D"List Table 3 Accent 3"/>
  <w:LsdException Locked=3D"false" Priority=3D"49" Name=3D"List Table 4 Accent 3"/>
  <w:LsdException Locked=3D"false" Priority=3D"50" Name=3D"List Table 5 Dark Accent 3"/>
  <w:LsdException Locked=3D"false" Priority=3D"51"
   Name=3D"List Table 6 Colorful Accent 3"/>
  <w:LsdException Locked=3D"false" Priority=3D"52"
   Name=3D"List Table 7 Colorful Accent 3"/>
  <w:LsdException Locked=3D"false" Priority=3D"46"
   Name=3D"List Table 1 Light Accent 4"/>
  <w:LsdException Locked=3D"false" Priority=3D"47" Name=3D"List Table 2 Accent 4"/>
  <w:LsdException Locked=3D"false" Priority=3D"48" Name=3D"List Table 3 Accent 4"/>
  <w:LsdException Locked=3D"false" Priority=3D"49" Name=3D"List Table 4 Accent 4"/>
  <w:LsdException Locked=3D"false" Priority=3D"50" Name=3D"List Table 5 Dark Accent 4"/>
  <w:LsdException Locked=3D"false" Priority=3D"51"
   Name=3D"List Table 6 Colorful Accent 4"/>
  <w:LsdException Locked=3D"false" Priority=3D"52"
   Name=3D"List Table 7 Colorful Accent 4"/>
  <w:LsdException Locked=3D"false" Priority=3D"46"
   Name=3D"List Table 1 Light Accent 5"/>
  <w:LsdException Locked=3D"false" Priority=3D"47" Name=3D"List Table 2 Accent 5"/>
  <w:LsdException Locked=3D"false" Priority=3D"48" Name=3D"List Table 3 Accent 5"/>
  <w:LsdException Locked=3D"false" Priority=3D"49" Name=3D"List Table 4 Accent 5"/>
  <w:LsdException Locked=3D"false" Priority=3D"50" Name=3D"List Table 5 Dark Accent 5"/>
  <w:LsdException Locked=3D"false" Priority=3D"51"
   Name=3D"List Table 6 Colorful Accent 5"/>
  <w:LsdException Locked=3D"false" Priority=3D"52"
   Name=3D"List Table 7 Colorful Accent 5"/>
  <w:LsdException Locked=3D"false" Priority=3D"46"
   Name=3D"List Table 1 Light Accent 6"/>
  <w:LsdException Locked=3D"false" Priority=3D"47" Name=3D"List Table 2 Accent 6"/>
  <w:LsdException Locked=3D"false" Priority=3D"48" Name=3D"List Table 3 Accent 6"/>
  <w:LsdException Locked=3D"false" Priority=3D"49" Name=3D"List Table 4 Accent 6"/>
  <w:LsdException Locked=3D"false" Priority=3D"50" Name=3D"List Table 5 Dark Accent 6"/>
  <w:LsdException Locked=3D"false" Priority=3D"51"
   Name=3D"List Table 6 Colorful Accent 6"/>
  <w:LsdException Locked=3D"false" Priority=3D"52"
   Name=3D"List Table 7 Colorful Accent 6"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Mention"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Smart Hyperlink"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Hashtag"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Unresolved Mention"/>
  <w:LsdException Locked=3D"false" SemiHidden=3D"true" UnhideWhenUsed=3D"true"
   Name=3D"Smart Link"/>
 </w:LatentStyles>
</xml><![endif]-->

#########################################################################################################################
##
##  3.1 WORD_STYLE_SHEET
##
#########################################################################################################################
<style>
<!--
 /* Font Definitions */
 @font-face
  {font-family:Wingdings;
  panose-1:5 0 0 0 0 0 0 0 0 0;
  mso-font-charset:77;
  mso-generic-font-family:decorative;
  mso-font-pitch:variable;
  mso-font-signature:3 268435456 0 0 -2147483647 0;}
@font-face
  {font-family:"Cambria Math";
  panose-1:2 4 5 3 5 4 6 3 2 4;
  mso-font-charset:0;
  mso-generic-font-family:roman;
  mso-font-pitch:variable;
  mso-font-signature:-536870145 1107305727 0 0 415 0;}
@font-face
  {font-family:"Calibri";
  panose-1:2 15 5 2 2 2 4 3 2 4;
  mso-font-charset:0;
  mso-generic-font-family:swiss;
  mso-font-pitch:variable;
  mso-font-signature:-1610611985 1073750139 0 0 159 0;}
@font-face
  {font-family:"Times New Roman \(Body CS\)";
  panose-1:2 11 6 4 2 2 2 2 2 4;
  mso-font-alt:"Times New Roman";
  mso-font-charset:0;
  mso-generic-font-family:roman;
  mso-font-pitch:auto;
  mso-font-signature:0 0 0 0 0 0;}
@font-face
  {font-family:"Helvetica Neue";
  panose-1:2 0 5 3 0 0 0 2 0 4;
  mso-font-charset:0;
  mso-generic-font-family:auto;
  mso-font-pitch:variable;
  mso-font-signature:-452984065 1342208475 16 0 1 0;}
@font-face
  {font-family:Times;
  panose-1:0 0 5 0 0 0 0 2 0 0;
  mso-font-charset:0;
  mso-generic-font-family:auto;
  mso-font-pitch:variable;
  mso-font-signature:-536870145 1342185562 0 0 415 0;}

/* Set the global font family and base font-size */

body {
   font-family:"${primaryFont}",sans-serif;
   font-size:${primaryFontSize};}

 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
  {mso-style-unhide:no;
  mso-style-qformat:yes;
  mso-style-parent:"";
  margin:3pt 0pt 3pt 0pt;
  mso-pagination:widow-orphan;
  font-family:"${primaryFont}",sans-serif;
  font-size:${primaryFontSize};}
p.error
  {mso-style-unhide:no;
  mso-style-qformat:yes;
  mso-style-parent:"";
  margin:0pt;
  mso-pagination:widow-orphan;
  color:red;}
h1
  {mso-style-priority:9;
  mso-style-unhide:no;
  mso-style-qformat:yes;
  mso-style-next:Normal;
  margin:12pt 0pt 3pt .3in;
  text-indent:-.3in;
  mso-pagination:widow-orphan lines-together;
  page-break-after:avoid;
  mso-outline-level:1;
  mso-list:l0 level1 lfo1;
  font-size:${h1FontSize};
  color:#2F5496;
  mso-font-kerning:0pt;
  font-weight:normal;}
h2
  {mso-style-priority:9;
  mso-style-qformat:yes;
  mso-style-next:Normal;
  margin:6pt 0pt 3pt .4in;
  text-indent:-.4in;
  mso-pagination:widow-orphan lines-together;
  page-break-after:avoid;
  mso-outline-level:2;
  mso-list:l0 level2 lfo1;
  font-size:${h2FontSize};
  color:#2F5496;
  font-weight:normal;}
h3
  {mso-style-priority:9;
  mso-style-qformat:yes;
  mso-style-next:Normal;
  margin:6pt 0pt 3pt .5in;
  text-indent:-.5in;
  mso-pagination:widow-orphan lines-together;
  page-break-after:avoid;
  mso-outline-level:3;
  mso-list:l0 level3 lfo1;
  font-size:${h3FontSize};
  color:#1F3763;
  font-weight:normal;}
h4
  {mso-style-priority:9;
  mso-style-qformat:yes;
  mso-style-next:Normal;
  margin:6pt 0pt 3pt .6in;
  text-indent:-.6in;
  mso-pagination:widow-orphan lines-together;
  page-break-after:avoid;
  mso-outline-level:4;
  mso-list:l0 level4 lfo1;
  font-size:${h4FontSize};
  color:#2F5496;
  font-weight:normal;
  font-style:italic;}
h5
  {mso-style-priority:9;
  mso-style-qformat:yes;
  mso-style-next:Normal;
  margin:6pt 0pt 3pt .7in;
  text-indent:-.7in;
  mso-pagination:widow-orphan lines-together;
  page-break-after:avoid;
  mso-outline-level:5;
  mso-list:l0 level5 lfo1;
  font-size:${h5FontSize};
  color:#2F5496;
  font-weight:normal;}
h6
  {mso-style-priority:9;
  mso-style-qformat:yes;
  mso-style-next:Normal;
  margin:6pt 0pt 3pt .8in;
  text-indent:-.8in;
  mso-pagination:widow-orphan lines-together;
  page-break-after:avoid;
  mso-outline-level:6;
  mso-list:l0 level6 lfo1;
  font-size:${h6FontSize};
  color:#1F3763;
  font-weight:normal;}
/*tables of... leaders ->blank,dashed,dotted,heavy,lined,middot */
span {
	.mso-tab-count:blank !important;
}
p.MsoHeading7, li.MsoHeading7, div.MsoHeading7
  {mso-style-priority:9;
  mso-style-qformat:yes;
  mso-style-next:Normal;
  margin:6pt 0pt 3pt .8in;
  text-indent:-.8in;
  mso-pagination:widow-orphan lines-together;
  page-break-after:avoid;
  mso-outline-level:7;
  mso-list:l0 level7 lfo1;
  font-size:${h7FontSize};
  color:#1F3763;
  font-weight:normal;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
  {mso-style-update:auto;
  mso-style-priority:39;
  mso-style-next:Normal;
  margin:6pt 0pt 0pt 0pt;
  mso-pagination:widow-orphan;
  font-family:"Arial",sans-serif;
  font-size:12.0pt;
  font-weight:bold;
  font-style:italic;}
p.MsoToc2, li.MsoToc2, div.MsoToc2
  {mso-style-update:auto;
  mso-style-priority:39;
  mso-style-next:Normal;
  margin:6pt 0pt 0pt 11pt;
  mso-pagination:widow-orphan;
  font-family:"Arial",sans-serif;
  font-size:11.0pt;
  font-weight:bold;}
p.MsoToc3, li.MsoToc3, div.MsoToc3
  {mso-style-update:auto;
  mso-style-priority:39;
  mso-style-next:Normal;
  margin:3pt 0pt 0pt 22pt;
  font-family:"Arial",sans-serif;
  mso-pagination:widow-orphan;
  font-size:10.0pt;}
p.MsoToc4, li.MsoToc4, div.MsoToc4
  {mso-style-update:auto;
  mso-style-noshow:yes;
  mso-style-priority:39;
  mso-style-next:Normal;
  margin:3pt 0pt 0pt 33pt;
  mso-pagination:widow-orphan;
  font-family:"Arial",sans-serif;
  font-size:10.0pt;}
p.MsoToc5, li.MsoToc5, div.MsoToc5
  {mso-style-update:auto;
  mso-style-noshow:yes;
  mso-style-priority:39;
  mso-style-next:Normal;
  margin:3pt 0pt 0pt 44pt;
  mso-pagination:widow-orphan;
  font-family:"Arial",sans-serif;
  font-size:10.0pt;}
p.MsoToc6, li.MsoToc6, div.MsoToc6
  {mso-style-update:auto;
  mso-style-noshow:yes;
  mso-style-priority:39;
  mso-style-next:Normal;
  margin:3pt 0pt 0pt 55pt;
  mso-pagination:widow-orphan;
  font-family:"Arial",sans-serif;
  font-size:10.0pt;}
p.MsoToc7, li.MsoToc7, div.MsoToc7
  {mso-style-update:auto;
  mso-style-noshow:yes;
  mso-style-priority:39;
  mso-style-next:Normal;
  margin:3pt 0pt 0pt 66pt;
  mso-pagination:widow-orphan;
  font-family:"Arial",sans-serif;
  font-size:10.0pt;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
  {mso-style-priority:99;
  mso-style-qformat:yes;
  margin:0pt;
  mso-pagination:widow-orphan;
  tab-stops:center 3.25in right 6.5in;
  font-size:10.0pt;}
p.MsoFooter, li.MsoFooter, div.MsoFooter
  {mso-style-priority:99;
  mso-style-qformat:yes;
  margin:0pt;
  mso-pagination:widow-orphan;
  tab-stops:center 3.25in right 6.5in;
  font-size:10.0pt;}

p.MsoCaption, li.MsoCaption, div.MsoCaption,span.MsoCaption
 {font-size:9.0pt !important;
  color:#44546A !important;
  font-style:italic !important;
  font-family:'Helvetica',sans-serif !important;
  page-break-inside:avoid !important;
/*  font-weight:bold;*/
  margin:0;
}
p.MsoTitle, li.MsoTitle, div.MsoTitle
  {mso-style-priority:10;
  mso-style-unhide:no;
  mso-style-qformat:yes;
  mso-style-next:Normal;
  margin:0pt;
  line-height:normal;
  mso-add-space:auto;
  mso-pagination:widow-orphan;
  font-size:40.0pt;
  color:#4F81BD;}
p.MsoSubtitle, li.MsoSubtitle, div.MsoSubtitle
  {mso-style-priority:11;
  mso-style-unhide:no;
  mso-style-qformat:yes;
  mso-style-next:Normal;
  line-height:normal;
  margin:0pt 0pt 3pt 0pt;
  mso-pagination:widow-orphan;
  font-size:12.0pt;}
a:link, span.MsoHyperlink
  {mso-style-priority:99;
  color:#0563C1;
  mso-themecolor:hyperlink;
  text-decoration:underline;
  text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
  {mso-style-noshow:yes;
  mso-style-priority:99;
  color:#954F72;
  mso-themecolor:followedhyperlink;
  text-decoration:underline;
  text-underline:single;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
  {mso-style-priority:34;
  mso-style-unhide:no;
  mso-style-qformat:yes;
  margin:0pt;
  mso-add-space:auto;
  mso-pagination:widow-orphan;
  font-size:"${primaryFontSize}";}
p.MsoTocHeading, li.MsoTocHeading, div.MsoTocHeading
  {mso-style-priority:39;
  mso-style-qformat:yes;
  mso-style-parent:"Heading 1";
  mso-style-next:Normal;
  margin:0pt;
  text-align:center;
  mso-pagination:widow-orphan lines-together;
  page-break-after:avoid;
  font-size:16.0pt;}
p.TableHeader, li.TableHeader, div.TableHeader
  {mso-style-name:"Table Header";
  mso-style-unhide:no;
  mso-style-qformat:yes;
  margin:0pt;
  mso-pagination:widow-orphan;
  font-size:"${primaryFontSize}";
  font-weight:bold;}
p.TableCell, li.TableCell, div.TableCell
  {mso-style-name:"Table Cell";
  mso-style-unhide:no;
  mso-style-qformat:yes;
  margin:0pt;
  mso-pagination:widow-orphan;
  font-size:${tableCellFontSize};}
ol
  {margin:0pt;}
ul
  {margin:0pt;}
li
  {margin:0pt;}

 /* Table of... List Definitions */
@list l0
  {mso-list-id:1764108000;
  mso-list-template-ids:1094757160;}
@list l0:level1
  {mso-level-style-link:"Heading 1";
  mso-level-text:%1;
  mso-level-tab-stop:none;
  mso-level-number-position:left;
  margin-left:.3in;
  text-indent:-.3in;}
@list l0:level2
  {mso-level-style-link:"Heading 2";
  mso-level-text:"%1\.%2";
  mso-level-tab-stop:none;
  mso-level-number-position:left;
  margin-left:.4in;
  text-indent:-.4in;}
@list l0:level3
  {mso-level-style-link:"Heading 3";
  mso-level-text:"%1\.%2\.%3";
  mso-level-tab-stop:none;
  mso-level-number-position:left;
  margin-left:.5in;
  text-indent:-.5in;}
@list l0:level4
  {mso-level-style-link:"Heading 4";
  mso-level-text:"%1\.%2\.%3\.%4";
  mso-level-tab-stop:none;
  mso-level-number-position:left;
  margin-left:.6in;
  text-indent:-.6in;}
@list l0:level5
  {mso-level-style-link:"Heading 5";
  mso-level-text:"%1\.%2\.%3\.%4\.%5";
  mso-level-tab-stop:none;
  mso-level-number-position:left;
  margin-left:.7in;
  text-indent:-.7in;}
@list l0:level6
  {mso-level-style-link:"Heading 6";
  mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6";
  mso-level-tab-stop:none;
  mso-level-number-position:left;
  margin-left:.8in;
  text-indent:-.8in;}
@list l0:level7
  {mso-level-style-link:"Heading 7";
  mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6\.%7";
  mso-level-tab-stop:none;
  mso-level-number-position:left;
  margin-left:.9in;
  text-indent:-.9in;}
@list l0:level8
  {mso-level-style-link:"Heading 8";
  mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6\.%7\.%8";
  mso-level-tab-stop:none;
  mso-level-number-position:left;
  margin-left:1.0in;
  text-indent:-1.0in;}
@list l0:level9
  {mso-level-style-link:"Heading 9";
  mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6\.%7\.%8\.%9";
  mso-level-tab-stop:none;
  mso-level-number-position:left;
  margin-left:1.1in;
  text-indent:-1.1in;}

/********************************************************************************************************
		3.2 WORD_PAGE_DEFINITIONS_STYLE_SHEET
********************************************************************************************************/

/* Normal Page Definition */
/*
@page
  {mso-footnote-separator:url("WordTemplate.fld/header.htm") fs;
  mso-footnote-continuation-separator:url("WordTemplate.fld/header.htm") fcs;
  mso-endnote-separator:url("WordTemplate.fld/header.htm") es;
  mso-endnote-continuation-separator:url("WordTemplate.fld/header.htm") ecs;}
@page WordSectionPortrait
  {size:8.5in 11.0in;
  margin:1.0in 1.0in 1.0in 1.0in;
  mso-header-margin:.5in;
  mso-footer-margin:.5in;
  mso-title-page:yes;
  mso-header:url("WordTemplate.fld/header.htm") pageHeader;
  mso-footer:url("WordTemplate.fld/header.htm") pageFooter;
  mso-first-header:url("WordTemplate.fld/header.htm") titlepageheader;
  mso-first-footer:url("WordTemplate.fld/header.htm") titlepagefooter;
  mso-paper-source:0;}
*/
/* Header Import Bug Workaround Page Definition */
@page
  {mso-footnote-separator: fs;
  mso-footnote-continuation-separator: fcs;
  mso-endnote-separator: es;
  mso-endnote-continuation-separator: ecs;}
@page WordSectionPortrait
  {size:8.5in 11.0in;
  margin:1.0in .75in 1.0in 0.75in;
  mso-header-margin:.5in;
  mso-footer-margin:.5in;
  mso-title-page:yes;
  mso-header: pageHeader;
  mso-footer: pageFooter;
  mso-first-header: titlepageHeader;
  mso-first-footer: titlepageFooter;
  mso-paper-source:0;}
div.WordSectionPortrait
  {page:WordSectionPortrait;}
@page WordSectionLandscape
  {size:11.0in 8.5in;
  mso-page-orientation:landscape;
  margin:1.0in 0.5in 1.0in 1.0in;
  mso-header-margin:.5in;
  mso-footer-margin:.5in;
  mso-title-page:yes;
  mso-header: h1;
  mso-footer: f1;
  mso-first-header: fh1;
  mso-first-footer: ff1;
  mso-paper-source:0;}
div.WordSectionLandscape
  {page:WordSectionLandscape;}


/********************************************************************************************************
		3.3 WORD_TABLE_STYLE_SHEET
********************************************************************************************************/
table 
  {margin-top:2pt;
  border-collapse: collapse;
  table-layout: fixed;}
th, td
  {padding-left: 2pt;
  padding-right: 2pt;
  text-align:left;
  overflow-wrap:break-word; /*normal | anywhere | break-word | initial | inherit */ 
  white-space:normal !important; 
  font-size:${tableCellFontSize}}
 th
  {background:$tableHeaderBackgroundColor;}
 table.MsoNormalTable
  {mso-style-name:"Table Normal";
  mso-tstyle-rowband-size:0;
  mso-tstyle-colband-size:0;
  mso-style-noshow:yes;
  mso-style-priority:99;
  mso-style-parent:"";
  border-collapse:collapse;
  mso-padding-alt:0in 5.4pt 0in 5.4pt;
  mso-para-margin:0in;
  mso-pagination:widow-orphan;
  font-size:${tableCellFontSize};
  font-family:"${primaryFont}",sans-serif;}
table.MsoTableGrid
  {mso-style-name:"Table Grid";
  mso-tstyle-rowband-size:0;
  mso-tstyle-colband-size:0;
  mso-style-priority:39;
  mso-style-unhide:no;
  border:solid $tableBorderColor 1.0pt;
  border-collapse:collapse;
  mso-border-alt:solid $tableBorderColor .5pt;
  mso-padding-alt:0in 5.4pt 0in 5.4pt;
  mso-border-insideh:.5pt solid $tableBorderColor;
  mso-border-insidev:.5pt solid $tableBorderColor;
  mso-para-margin:0in;
  mso-pagination:widow-orphan;
  font-size:${tableCellFontSize};
  mso-bidi-font-size:12.0pt;
  font-family:"${primaryFont}",sans-serif;}
table.TableGridwithHeader
  {table-layout:fixed;
  mso-table-layout-alt:fixed;
  border-collapse:collapse;
  border:none;
  mso-style-name:"Table Grid with Header";
  mso-tstyle-rowband-size:0;
  mso-tstyle-colband-size:0;
  mso-style-priority:99;
  mso-style-unhide:no;
  mso-style-parent:"Table Grid";
  border:solid $tableBorderColor 1.0pt;
  mso-border-alt:solid $tableBorderColor .5pt;
  mso-padding-alt:0in 5.4pt 0in 5.4pt;
  mso-border-insideh:.5pt solid $tableBorderColor;
  mso-border-insidev:.5pt solid $tableBorderColor;
  mso-para-margin:0in;
  mso-pagination:widow-orphan;
  font-size:${tableCellFontSize};
  font-family:"${primaryFont}",sans-serif;}
th.TableHeader
  {border:solid $tableBorderColor .5pt;}
td.TableCell
  {border:solid $tableBorderColor .5pt;}
-->
</style>
<!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext=3D"edit" spidmax=3D"1026"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext=3D"edit">
  <o:idmap v:ext=3D"edit" data=3D"1"/>
 </o:shapelayout></xml><![endif]-->

#else ## pdf ##
#########################################################################################################################
##
##  4. PDF_HTML_HEAD
##
#########################################################################################################################
## If the PDF report has remote access fonts, include via a <link> here. Example:
## <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Math&display=swap" rel="stylesheet">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Arimo:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet">


#########################################################################################################################
##
##  4.1 PDF_STYLE_SHEET
##  
##  iText PDF has 14 standard fonts which can be referenced in the CSS/HTML without an external link: 
##  
##  Courier, Courier-Bold, Courier-Bold Oblique, Courier-Oblique, Helvetica, Helvetica-Bold, Helvetica-Bold Oblique,  
##  Helvetica-Oblique, Times-Roman, Times-Bold,Times-BoldItalic, Times-Italic, Symbol, ZapfDingbats
##  
##  If the client has a typeface that is locally accessible to them, it can be included using @font-face. 
##  Make sure to place within the style tags below, Example:
##  @font-face {
##		font-family: 'rakkasregular';
##		src: url('/Users/krichards/Desktop/Rakkas/Rakkas-Regular.ttf') format('ttf'),
##		url('/Users/krichards/Desktop/Rakkas/Rakkas-Regular.ttf') format('ttf');
##		font-weight: normal;
##		font-style: normal;}  
##
#########################################################################################################################


<style>

/* Style Definitions */

* { 
  line-height: 100%;
  font-size:${primaryFontSize};
  font-family:"${primaryFont}",sans-serif;
}

body {margin:auto;
counter-reset: figCapCounter tableCapCounter;} 

/* Font Styles- Note: The PDF ToC will include any content within h1-h6 tags */
p.MsoNormal 
{margin:0;
padding:0;}
p.error
{margin-bottom:.0001pt;
color:red;}
h1
{margin:12pt 0pt 3pt .3in;
text-indent:-.3in;
page-break-after:avoid;
page-break-inside:avoid;
font-size:${h1FontSize};
color:#2F5496;
font-weight:normal;}
h2 
{margin:6pt 0pt 3pt .4in;
text-indent:-.4in;
font-size:${h2FontSize};
page-break-after:avoid;
page-break-inside:avoid;
color:#2F5496;
font-weight:normal;}
h3 
{margin:6pt 0pt 3pt .5in;
text-indent:-.5in;
font-size:${h3FontSize};
page-break-after:avoid;
page-break-inside:avoid;
color:#1F3763;
font-weight:normal;}
h4 
{margin:6pt 0pt 3pt .6in;
text-indent:-.6in;
font-size:${h4FontSize};
font-style:italic;
page-break-after:avoid;
page-break-inside:avoid;
color:#2F5496;
font-weight:normal;}
h5 
{margin:6pt 0pt 3pt .7in;
text-indent:-.7in;
font-size:${h5FontSize};
page-break-after:avoid;
page-break-inside:avoid;
color:#2F5496;
font-weight:normal;}
h6 
{margin:6pt 0pt 3pt .8in;
text-indent:-.8in;
font-size:${h6FontSize};
page-break-after:avoid;
page-break-inside:avoid;
color:#1F3763;
font-weight:normal;}
p.MsoHeading7, li.MsoHeading7, div.MsoHeading7
{margin:6pt 0pt 3pt .8in;
text-indent:-.8in;
page-break-after:avoid;
font-size:12.0pt;
color:#1F3763;
font-weight:normal;}
p.MsoTitle, li.MsoTitle, div.MsoTitle
{margin:0pt;
font-size:40.0pt;
color:#4F81BD;
line-height:99%;}
p.MsoSubtitle, li.MsoSubtitle, div.MsoSubtitle
{margin-top:0pt 0pt 3pt 0pt;
font-size:12.0pt;
line-height:75%;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
{ margin:0pt;
  font-size:10.0pt;}
p.MsoFooter, li.MsoFooter, div.MsoFooter
{ margin:0pt;
  font-size:10.0pt;}
p.TableHeader, li.TableHeader, div.TableHeader
{margin:0pt;
font-weight:bold;}
p.TableCell, li.TableCell, div.TableCell
{font-size:10pt;
margin:0pt;}
p.ListParagraph, li.ListParagraph, div.ListParagraph
{margin:0pt;}
ol
{margin:0pt;}
ul
{margin:0pt;}
li
{margin:0pt;}
a:link
{color:#0563C1;
text-decoration:underline;
text-underline:single;}
a:visited
{color:#954F72;
text-decoration:underline;
text-underline:single;}

span {line-height:normal;}
/*Superscript and Subscript */
sub, sup {font-size:7pt;}

/* Images */ 

figure {padding:0;
margin:0;}

img {
max-height:100%;
max-width:100%;
padding:0;
margin:0;
object-fit:contain;
}

.MsoCaption, figcaption, caption 
{font-size:9.0pt;
color:#44546A;
font-style:italic;
page-break-inside:avoid;
margin:0;
line-height:180%;
/*font-weight:bold;*/
}

figcaption {margin-top:0pt;}

caption {margin-top:6pt;}



/********************************************************************************************************

    4.1.1 PDF_TABLE_OF_STYLE_SHEET 

The TOC, TOT, and TOF can be selected at the time of report installation, 
and will automatically generate to the report, considering these circumstances: 

    o The TOC will include any content with hierarchy of 1-6 (formatted in h1-h6 tags).
    o The TOF will include Figures if they have a figcaption in Jama. 
    o The ToT will include Tables if they have a caption in Jama. 

Use the following Jama Connect classes to style the ToC, ToF, and ToT and trail the CSS property value with !important; 
https://jamaservice.atlassian.net/wiki/spaces/EN/pages/1714126862/iText+Table+of...+Styling
********************************************************************************************************/
/*
.table-of-reference-page-break {
page-break-before: always;
} To overide page-break-before: avoid!important;
*/

.table-of-reference-title {
  font-size:16.0pt !important;
  font-weight:normal !important;
}

.TOC_table-of-contents-item-level1 {
  font-family:"${primaryFont}",sans-serif !important;
  font-size:11.5pt !important;
  font-style:italic !important;
  font-weight: 700 !important;
  width: 90% !important;
}

.TOC_table-of-contents-item-level2 {
  font-family:"${primaryFont}",sans-serif !important;
  width: 90% !important;
  font-size:11pt !important;
  font-weight: 700 !important;
}

.TOC_table-of-contents-item-level3 {
  font-family:"${primaryFont}",sans-serif !important;
  font-size:10.5pt !important;
  width: 90% !important;
}

.TOC_table-of-contents-item-level4 {
  font-family:"${primaryFont}",sans-serif !important;
  font-size:10pt !important;
  width: 90% !important;
}

.TOC_table-of-contents-item-level5 {
  font-family:"${primaryFont}",sans-serif !important;
  font-size:10pt !important;
  width: 90% !important;
}

.TOC_table-of-contents-item-level6 {
  font-family:"${primaryFont}",sans-serif !important;
  font-size:10pt !important;
  width: 90% !important;
}

.TOC_table-of-contents-item-level7 {
  font-family:"${primaryFont}",sans-serif !important;
  font-size:10pt !important;
  width: 90% !important;
}

.TOT_table-of-tables-item,
.TOF_table-of-figures-item {
  font-family:"${primaryFont}",sans-serif !important;
  font-size:10pt !important;
  padding: 0 !important!;
  overflow:hidden !important;
  width:90% !important;
}


/********************************************************************************************************
    
    3.1.1.1 PDF_COUNTERS_STYLE_SHEET
  
********************************************************************************************************/

/* Report Body Counter */

div.reportBodyCounterContainer {counter-reset:h1Report h2Report h3Report h4Report h5Report h6Report h7Report;}

h1 {counter-increment: h1Report;
	counter-reset:h2Report h3Report h4Report h5Report h6Report h7Report;}

h2 {counter-increment:h2Report;
	counter-reset:h3Report h4Report h5Report h6Report h7Report;}

h3 {counter-increment: h3Report;
   counter-reset:h4Report h5Report h6Report h7Report;}

h4 {counter-increment: h4Report;
   counter-reset:h5Report h6Report h7Report;}

h5 {counter-increment:h5Report;
   counter-reset:h6Report h7Report;}

h6 {counter-increment: h6Report;
   counter-reset:h7Report;}

.MsoHeading7{counter-increment: h7Report;}

h1::before 
  {content: counter( h1Report ) "\0000a0";}
h2::before 
  {content: counter( h1Report) "." counter(h2Report) "\0000a0";}
h3::before 
  {content: counter( h1Report) "." counter(h2Report) "." counter(h3Report) "\0000a0";}
h4::before 
  {content: counter( h1Report) "." counter(h2Report) "." counter(h3Report) "." counter(h4Report) "\0000a0";}
h5::before
  {content: counter(h1Report) "." counter(h2Report) "." counter(h3Report) "." counter(h4Report) "." counter(h5Report) "\0000a0";}
h6::before
  {content: counter(h1Report) "." counter(h2Report) "." counter(h3Report) "." counter(h4Report) "." counter(h5Report) "." counter(h6Report) "\0000a0";}
.MsoHeading7::before
  {content: counter(h1Report) "." counter(h2Report) "." counter(h3Report) "." counter(h4Report) "." counter(h5Report) "." counter(h6Report) "." counter(h7Report) "\0000a0";}


/* Report Body Counter for Figures (counter-reset on the body) */

figcaption::before {
  counter-increment: figCapCounter;
  content: "Figure" "\0000a0" counter(figCapCounter) "\0000a0";
}


/* Report Body Counter For Tables  (counter-reset on the body) */

caption::before {
  counter-increment: tableCapCounter;
  content:"Table" "\0000a0" counter(tableCapCounter) "\0000a0";
}


/* Table of Contents 7 levels of counters */

.tocCounterContainer {
  counter-reset: h1toc h2toc h3toc h4toc h5toc h6toc h7toc; 
}


.TOC_table-of-contents-item-level1-forCount { 
  counter-reset: h2toc h3toc h4toc h5toc h6toc h7toc;
  counter-increment: h1toc;
}
.TOC_table-of-contents-item-level1::before {
  content: counter(h1toc) "\0000a0";
}


.TOC_table-of-contents-item-level2-forCount {
  counter-reset: h3toc h4toc h5toc h6toc h7toc;
  counter-increment: h2toc;
}
.TOC_table-of-contents-item-level2::before {
  content: counter(h1toc) "." counter(h2toc) "\0000a0";
}


.TOC_table-of-contents-item-level3-forCount {
  counter-reset: h4toc h5toc h6toc h7toc;
  counter-increment: h3toc;
}
.TOC_table-of-contents-item-level3::before {
  content: counter(h1toc) "." counter(h2toc) "." counter(h3toc) "\0000a0";
}


.TOC_table-of-contents-item-level4-forCount {
  counter-reset: h5toc h6toc h7toc;
  counter-increment: h4toc;
}
.TOC_table-of-contents-item-level4::before {
  content: counter(h1toc) "." counter(h2toc) "." counter(h3toc) "." counter(h4toc) "\0000a0";
}


.TOC_table-of-contents-item-level5-forCount {
  counter-reset: h6toc h7toc;
  counter-increment: h5toc;
}
.TOC_table-of-contents-item-level5::before {
  content: counter(h1toc) "." counter(h2toc) "." counter(h3toc) "." counter(h4toc) "." counter(h5toc) "\0000a0";
}


.TOC_table-of-contents-item-level6-forCount {
  counter-reset: h7toc;
  counter-increment: h6toc;
}
.TOC_table-of-contents-item-level6::before {
  content: counter(h1toc) "." counter(h2toc) "." counter(h3toc) "." counter(h4toc) "." counter(h5toc) "." counter(h6toc) "\0000a0";
}


.TOC_table-of-contents-item-level7-forCount {
  counter-increment: h7toc;
}
.TOC_table-of-contents-item-level7::before {
  content: counter(h1toc) "." counter(h2toc) "." counter(h3toc) "." counter(h4toc) "." counter(h5toc) "." counter(h6toc) "." counter(h7toc) "\0000a0";
}


/* Table of Figures Counter */

div.tofCounterContainer {
  counter-reset:tableOfFigures;
}

.TOF_table-of-figures-item::before 
  {counter-increment: tableOfFigures;
  content: "Figure" "\0000a0" counter(tableOfFigures) "\0000a0"; 
} 


/* Table of Tables Counter */

div.totCounterContainer {
  counter-reset:tableOfTables;
}

.TOT_table-of-tables-item::before 
  {counter-increment: tableOfTables;
  content: "Table" "\0000a0" counter(tableOfTables) "\0000a0"; 
} 


/********************************************************************************************************
    
    4.1.2 PDF_PAGE_DEFINITIONS_STYLE_SHEET

********************************************************************************************************/

@page {  
  size:8.5in 11.0in;  /* Specify page size/orientation, i.e. size: "Landscape"; or size: "A4"; etc. */
  margin: 1.0in 1.0in 1.0in 1.0in; /* set margins to preference */
  @top-center 
  {content: element(pageHeader)}
  @bottom-center 
  {content: element(pageFooter)}
}

@page :first {     
    /* If no diff first page header/footer change to match what you have named pageHeader/pageFooter 
  or comment-out the "@page :first..." block */
  margin: 1.0in 1.0in 1.5in 1.0in;
  @top-center 
  {content: element(titlepageHeader)} 
  @bottom-center 
  {content: element(titlepageFooter)}
}
#pageNumber::after {
    content: counter(page)
}
#totalPages::after {
    content: counter(pages)
}

/* apply margin for the header/footer to the container div.<header/footerClass> */
div.titlepageHeader {
  display: block;
  text-align: center;
  position: running(titlepageHeader);
 }
div.titlepageFooter {
  display: block;
  text-align: center;
  position: running(titlepageFooter);
}
div.pageHeader {
  display: block;
  text-align: center;
  position: running(pageHeader);
}
div.pageFooter {
  display: block;
  text-align: center;
  position: running(pageFooter);
}
/* To center a table vertically and horizontally use margin:auto; */
.pageHeader-table,
.pageFooter-table {
  margin:auto; 
  border:none;
  width:100%;
  height:100%;
}
/********************************************************************************************************
    4.1.3 PDF_TABLE_STYLE_SHEET
********************************************************************************************************/
table 
  {margin-top:2pt;
  border-collapse:collapse;
  table-layout:fixed;}
th, td
  {padding-left:2pt;
  padding-right:2pt;
  text-align:left;
  overflow-wrap:break-word; /*normal | anywhere | break-word | initial | inherit */ 
  white-space:normal !important; 
  font-size:${tableCellFontSize};} 
th
  {background:$tableHeaderBackgroundColor;}
table.MsoNormalTable
  {padding:0in 5.4pt 0in 5.4pt;
  margin:0in;
  font-size:${tableCellFontSize};}
table.MsoTableGrid
  {border:solid $tableBorderColor 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;
  font-size:${tableCellFontSize};}
table.TableGridwithHeader
  {table-layout:fixed;
  border:solid $tableBorderColor 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;
  margin:0in;
  font-size:${tableCellFontSize};}
th.TableHeader
  {border:solid $tableBorderColor .5pt;}
td.TableCell
  {border:solid $tableBorderColor .5pt;}

</style>


#end ##if( $format == "doc")...#else(pdf or possibly html)...## 


</head>
#########################################################################################################################
##
##  5. MACROS
##
#########################################################################################################################
##
#########################################################################################################################
##
##  5.1 STANDARD_MACROS
#########################################################################################################################
##
#########################################################################################################################
##          Macro: getContainer                                                           
##          Inputs: $baselineMode - boolean: user selected.  tells the report if the export was from a baseline or not                                        
##          Creates: $containerDoc - document: creates $containerDoc to used for the remainder of the report
#########################################################################################################################
#macro( getContainer $baselineMode )
##
  #set( $firstDocInList = $documentList[0].document )
  #set( $firstDocInListTypeKey = $firstDocInList.documentType.documentTypeKey )
##
  ## export from a baseline
  #if( $baselineMode )
    #### Debug: Baseline Mode
    ## baseline of a set or component will include the set or component as the first item
    #if( $firstDocInListTypeKey == $cmpKey ||
         $firstDocInListTypeKey == $setKey ||
         $firstDocInListTypeKey == "TSTPL" ||
         $firstDocInListTypeKey == "TSTCY" )
      #set( $containerDoc = $firstDocInList )
    ## if the first item is not a set or component, then the baseline is of a filter
    ## and a meaningful parent is not available
    #else
      #set( $containerDoc = false )
    #end
##
  ## export from the project explorer
  #else
    ## Test Plan Mode
    #if( $firstDocInList.documentType.documentTypeKey == "TSTPL" )
      #set( $containerDoc = $firstDocInList )
    ## Test Cycle Mode
    #elseif( $firstDocInList.documentType.documentTypeKey == "TSTRN" )
      #set( $containerDoc = $firstDocInList.testCycle )
    ## Component / Set Mode
    #else
      #set( $docNode = $documentNodeDao.getDocumentNode(5, $documentList[0].document.id) )
      #set( $parentNode = $docNode.getParentNode())
      ## ## Debug: $parentNode.sequence
      ## if the parent is the projec, then assume the user exported from a baseline and forgot
      ## to select Baseline Mode, otherwise get the parent
      #if( $parentNode.globalSortOrder == 1000 )
        #if( $firstDocInListTypeKey == $cmpKey ||
             $firstDocInListTypeKey == $setKey )
          #set( $containerDoc = $firstDocInList )
        #else
          #set( $containerDoc = false )
        #end
      #else
        #set( $parentDoc = $docDao.getDocument($parentNode.refId) )
        #set( $parentTypeKey = $parentDoc.documentType.documentTypeKey )
        #### Debug: $parentTypeKey
        #if( $parentTypeKey == $cmpKey ||
             $parentTypeKey == $setKey )
          #set( $containerDoc = $parentDoc )
        #else
          #set( $containerDoc = false )
        #end
      #end
    #end
  #end
#end
#########################################################################################################################
##
#########################################################################################################################
##          Macro: getDocumentRev                                                          
##          Creates: $documentRev - string: name of the baseline that exists on all items with an asterisk if some items 
##                   have changed since the most recent baseline
##                   $baselineId - number: ID of the identified baseline (only 1, even if the items are all in multiple)
#########################################################################################################################
#macro( getDocumentRev )
  ## Build List of all baselines on active items
  #set( $baselineList = [] )
  #set( $baselineId = false )
  #foreach( $vDoc in $documentList )
    #set( $doc = $vDoc.document)
    #set( $docVersion = $versionDao.getVersionByDocumentId($doc.id) )
    #set( $docBaselines = $docVersion.baseLines )
    #foreach( $baseline in $sortTool.sort($docBaselines, "id:desc") )
      ##if( !$baseline.name.contains("Review") && !$baseline.name.contains("REVIEW") )
      #set( $addBaseline = true )
      #foreach( $knownBaseline in $baselineList )
        #if( $knownBaseline.id == $baseline.id ) 
          #set( $addBaseline = false )
        #end
      #end
      #if( $addBaseline )
        #if( $baselineList.add( {"id":$baseline.id, "name":$baseline.name} ) ) #end
      #end
      ##end
    #end
  #end
##
  ##Determine which, if any, baseline exists on all items
  #set( $baselinesOnAllItemsList = [] )
  #foreach( $baseline in $baselineList )
    #set( $baselineOnAllItems = true )
    #foreach( $vDoc in $documentList )
      #set( $doc = $vDoc.document)
      #set( $docVersion = $versionDao.getVersionByDocumentId($doc.id) )
      #set( $docBaselines = $docVersion.baseLines )
      #set( $baselineOnItem = false )
      #foreach( $docBaseline in $docBaselines )
        #if( $docBaseline.id == $baseline.id )
          #set( $baselineOnItem = true )
          #break
        #end
      #end
      #if( !$baselineOnItem )
        #set( $baselineOnAllItems = false )
        #break
      #end
    #end
    #if( $baselineOnAllItems )
      #if( $baselinesOnAllItemsList.add( $baseline ) ) #end
    #end
  #end
##
  ## Determine the Revision info to display
  #if( $baselinesOnAllItemsList.size() > 0 )
    #foreach( $baseline in $baselinesOnAllItemsList )
      #if( $foreach.first )
        #set( $documentRev = $baseline.name )
        #set( $baselineId = $baseline.id )
      #else
        #set( $documentRev = "$documentRev, $baseline.name" )
      #end
    #end
  #elseif( $baselineList.size() > 0 )
    #set( $documentRev = "$baselineList[0].name*" )
    ##set( $baselineId = $baselineList[0].id )
  #else
    #set( $documentRev = "N/A" )
  #end
##
#end
#########################################################################################################################
##
#########################################################################################################################
##          Macro: getBaselineRelationships
##          Input: $orginDocId - ID of a current item
##                 $baselineId - ID of a baseline   
##                 $inDoc - current item
##                 $inDownstream - true provides downstream relationships, false provides upstream relationships    
##          Creates: $returnBaselineRels list of upstream Or downstream baseline relationships 
#########################################################################################################################
#macro( getBaselineRelationships $orginDocId $baselineId $inDoc $inDownstream )
	#set( $start = 0 )
	#set( $count = 20 )
	#set( $versionedRelationships = [] )
	#set( $returnBaselineRels = [])
	#set( $pageSize = 20)
	#set( $relatedIds = [] )
	##
	#set($baseRelsPage = $velocityServiceWrapper.getRelationships($orginDocId,$baselineId,$start,$count))
	##
	#set( $totalRels = [])
	#set( $totalRels = $baseRelsPage.getPageInfo().getTotalResults())
	## DEBUG Baseline Page Info: $baseRelsPage.getPageInfo() <br><br>
	## DEBUG Baseline Relationship Count: $baseRelsPage.getPageInfo().getTotalResults()<br><br>
	## DEBUG Baseline Results: $baseRelsPage.getResults() 

	#if( $totalRels && $totalRels > 0)
		#set( $page_count = $mathTool.floor($mathTool.div($totalRels,$pageSize)) )
		#foreach( $page in [0..$page_count])
			#set( $baseRelsPage = $velocityServiceWrapper.getRelationships($orginDocId,$baselineId,$start,$count))
			#set( $baseRelsPageResults = $baseRelsPage.getResults())

			#if( $baseRelsPageResults )
			 #set( $success = $versionedRelationships.addAll($baseRelsPageResults ))
			#end 

			#set( $start = $start + $count)

		#end
	#end
	##
	#foreach( $versionedRelationship in $versionedRelationships )
		#if( $inDownstream ) ## Get Downstream Relationships
			#set( $upItemId = $versionedRelationship.getFromItem().getValue().get(0) )
			#set( $upItemVersion = $versionedRelationship.getFromItem().getValue().get(1) )
			#set( $upDoc = $documentSource.getItem($upItemId, $upItemVersion) ) ## necessary to get by version

			#if( $inDoc.id == $upItemId ) 
				#set( $dnItemId = $versionedRelationship.getToItem().getValue().get(0) )
				#set( $dnItemVersion = $versionedRelationship.getToItem().getValue().get(1) )
				#set( $dnDoc = $velocityServiceWrapper.getItem($dnItemId, $dnItemVersion) )
				#if( !$relatedIds.contains($dnDoc.id) )
					#set( $success = $relatedIds.add($dnDoc.id) )
					#set( $success = $returnBaselineRels.add( {"fromDocument":$inDoc,"toDocument":$dnDoc} ) )
				#end
			#end 

		#else
			#set( $dnItemId = $versionedRelationship.getToItem().getValue().get(0) )
			#set( $dnItemVersion = $versionedRelationship.getToItem().getValue().get(1) )
			#set( $dnDoc = $documentSource.getItem($dnItemId, $dnItemVersion) ) ## necessary to get by version

			#if( $inDoc.id == $dnDoc.id ) ## Get Upstream Relationships
				#set( $upItemId = $versionedRelationship.getFromItem().getValue().get(0) )
				#set( $upItemVersion = $versionedRelationship.getFromItem().getValue().get(1) )
				#set( $upDoc = $documentSource.getItem($upItemId, $upItemVersion) )
				#if( !$relatedIds.contains( $upDoc.id) )
					#set( $success = $relatedIds.add( $upDoc.id) )
					#set( $success = $returnBaselineRels.add( {"fromDocument":$upDoc,"toDocument":$inDoc} ) )
				#end
			#end

		#end 
	#end

#end
#########################################################################################################################
##
#########################################################################################################################
##          Macro: getRelationships
##          Inputs: $baselineMode - GLOBAL, tells the report if the export was from a baseline or not 
##                  $baselineId - GLOBAL, ID of a baseline       
##                  $inDoc - current item
##                  $inDownstream - true provides downstream relationships, false provides upstream relationships
##          Creates: $returnRels - list of relationships with sub-elements of "fromItem" and "toItem" each of type 
##                   item
#########################################################################################################################
#macro( getRelationships $inDoc $inDownstream )
  #set( $returnRels = [] )

  #if( $baselineMode && $baselineId )
      #set( $currentVersion = $inDoc.currentVersion )
      #set( $orginDocId = $currentVersion.originDocument.id )
      #getBaselineRelationships( $orginDocId, $baselineId, $inDoc, $inDownstream ) ## Creates $returnBaselineRels
      ##DEBUG $returnBaselineRels
      #set( $returnRels = $returnBaselineRels )
  #else

    #set( $rels = [] )
    #set ( $rels = $relDao.getRelationshipsForDocument($inDoc.id, $inDownstream) )
    #foreach( $rel in $rels )
      #if( $inDownstream )  ## Get Downstream Relationships
        #if ( $rel.toDocument.active )
          #set( $success = $returnRels.add( $rel ) )
        #end
      #else                 ## Get Upstream Relationships
        #if ( $rel.fromDocument.active )
          #set( $success = $returnRels.add( $rel ) )
        #end
      #end
    #end
  #end
#end
#########################################################################################################################
##
#########################################################################################################################
##          Macro: getDate
##          Input: Java Time Zone ID to determine which timezone to display the date in
##          Output: Formatted date in the desired timezone
#########################################################################################################################
#macro( getDate $inputDate $inputTimeZone )
  #set( $outTz = $dateTool.getTimeZone().getTimeZone($inputTimeZone) )
  #set( $locale = $dateTool.getLocale() )
  #set( $date = $dateTool.format( 'MM/dd/yyyy', $inputDate, $locale, $outTz ))
  $!date
#end
#########################################################################################################################
##          Macro: getDateTime
##          Input: Java Time Zone ID to determine which timezone to display the date in
##          Output: Formatted date in the desired timezone
#########################################################################################################################
#macro( getDateTime $inputDate $inputTimeZone )
  #set( $outTz = $dateTool.getTimeZone().getTimeZone($inputTimeZone) )
  #set( $locale = $dateTool.getLocale() )
  #set( $dateTime = $dateTool.format( 'MM/dd/yyyy hh:mm a', $inputDate, $locale, $outTz ))
  $!dateTime
#end
#########################################################################################################################
##          Macro: getHierarchyLevel
##          Input: $doc - document object
##                 $baselineMode - true: export was from a baseline, false: export was from the project
##                 $baselineId   - ID of the baseline that the items are part of, if in baseline mode
##          Output: $hierarchyLevel - number, which heading level this item is in Jama relative to the container
#########################################################################################################################
#macro( getHierarchyLevel $doc $baselineMode $baselineId )
  #set( $seqSubStrings = [] )
  #set( $hierarchyLevel = 1)
  ## Get hierarchy from the baseline
  #if( $baselineMode )
    #set( $docNodeItem = $documentNodeDao.getDocumentNode(5, $doc.id))
    #set( $docNode = $documentNodeDao.getDocumentNodeForBaseLine(5, $docNodeItem.refId, $baselineId))
  ## Get hierarchy from the project
  #else
    #set( $docNode = $documentNodeDao.getDocumentNode(5, $doc.id))
  #end
  ##Debug: $docNode
  #set( $seqSubStrings = $docNode.sequence.split("\."))
  ##Debug: $seqSubStrings
  #set( $hierarchyLevel = $seqSubStrings.size())
  #if( !$hierarchyLevelTop )
    #set($hierarchyLevelTop = $hierarchyLevel)
  #end
  #set($hierarchyLevel = $hierarchyLevel - $hierarchyLevelTop + 1)
#end
#########################################################################################################################
##          Macro: getStatus
##          Input: $doc - document object
##          Output: $docStatus - status of the item
#########################################################################################################################
#macro( getStatus $doc )
  #set( $docStatus = false )
  #foreach( $docTypeField in $doc.documentType.documentTypeFields )
    #if( $docTypeField.documentField.name == "status" )
      #set ( $docStatus = $doc.status.name )
      #break
    #end
  #end
#end
#########################################################################################################################
##          Macro: getObjectType
##          Input: $doc - document object
##          Output: $docObjectType - value of object_type
#########################################################################################################################
#macro( getObjectType $doc )
  #set( $docObjectType = false )
  #foreach( $docTypeField in $doc.documentType.documentTypeFields )
    #if( $docTypeField.documentField.name == $objectTypeField )
      #set ( $docObjectType = $velocityReportUtil.getValueForField($doc, $objectTypeField, $dateFormat ) )
      #break
    #end
  #end
#end
#########################################################################################################################
##                         Macro: Returns a source string from a description                                         ###
##                          @sText - string: string you searching                                                     ###
##                          @return - array: an array of image sources (url)                                          ###
#########################################################################################################################
#macro( findSourceMHTML $sText )
  #set( $findSourceMHTMLReturn = [])
  #set( $lastImageIndex = $sText.lastIndexOf("<img"))  ##>             
  #set( $startCheck = $sText.indexOf("<img")) ##>  
  #foreach( $x in [$startCheck..$lastImageIndex])
    #if( $x == $sText.indexOf( "<img", $x))  ##>
      #set($end = $sText.indexOf(">", $mathTool.toInteger($x)))
      #set($imgString = ( $sText.substring( $mathTool.toInteger($x), $mathTool.toInteger($end))))
      #### Debug: $imgString
      #set($imgStringCaseMod = $imgString.toLowerCase())

      #set($srcStart = $imgStringCaseMod.indexOf("src="))
      #if($imgStringCaseMod.contains('src="'))
        #set($srcStart = $srcStart + 5)
      #else
        #set($srcStart = $srcStart + 4)
      #end

      #if($imgStringCaseMod.contains(".png"))
        #set( $srcEnd = $imgStringCaseMod.indexOf('.png', $srcStart))
      #elseif($imgStringCaseMod.contains(".jpg"))
        #set( $srcEnd = $imgStringCaseMod.indexOf('.jpg', $srcStart))
      #elseif($imgStringCaseMod.contains(".jpeg"))
        #set( $srcEnd = $imgStringCaseMod.indexOf('.jpeg', $srcStart))
      #elseif($imgStringCaseMod.contains(".svg"))
        #set( $srcEnd = $imgStringCaseMod.indexOf('.svg', $srcStart))
      #end
      
      #if($imgStringCaseMod.contains(".jpeg"))
        #set( $srcEnd = $srcEnd + 5)
      #else
        #set( $srcEnd = $srcEnd + 4)
      #end

      #if( $srcStart < $srcEnd )
        #set($imgSrc = $imgString.substring( $srcStart, $srcEnd ))
        #set($imgSrc = $imgSrc.replaceAll("\?dpi.*$", ""))

        #if($imgString.indexOf( $baseUrl) > -1 && $imgString.indexOf( "blob:http") == -1)
          #set( $success = $findSourceMHTMLReturn.add( $imgSrc))
        #end
    #end 
    #end
  #end
#end
#########################################################################################################################
##                     Macro: Returns a source with a new cid and appends the base64 image to the end of the file    ###
##                      @sText - array: string of source                                                              ###
##                      @return - array: returns an array of strings of the new image src                             ###
#########################################################################################################################
#macro( imageArrayMTHML $sText )      
  #set( $imageArrayMHTMLReturn = [])
  #set( $imageSizeArrayMHTMLReturn = [])
  #set( $imageBase64ArrayHTMLReturn = [])
  ## Define a figure array if none exists (first image in the doc)
  #if( !$figure ) #set( $figure = [] ) #end
  ## Define a files array if none exists (first image in the doc)
  #if( !$files ) #set( $files = [] ) #end
  ##$return.clear()
  ##set( $sourceArray = [])
  ##SText: $sText<br>
  #foreach( $s in $sText)  
  ##SOURCE: $s, BASEURL: $baseUrl<br>
    #if( $s.indexOf( $baseUrl) > -1)
      #set( $srcEnd = $s.indexOf("attachment/"))
      #if ( $srcEnd < 0 )
        #set( $srcEnd = $s.indexOf("diagram/"))
        #set( $attStart = $srcEnd + 8)
      #else
        #set( $attStart = $srcEnd + 11)
      #end
      #set( $attEnd = $s.indexOf( "/", $attStart))
      #set( $attachmentId = $s.substring( $attStart, $attEnd))
      ##Att. id: $attachmentId<br>
      ##Get file extension
      #set( $fileExtStart = $s.indexOf( ".", $attEnd))
      #set( $fileExtStart = $fileExtStart + 1)
      #set( $fileExt = $s.substring( $fileExtStart, $s.length()))
      #set( $f = "JAMA_IMG_")
      #set( $f = $f.concat($attachmentId))
      #set( $f = $f.concat("."))
      #set( $f = $f.concat($fileExt))
      #set( $file = '<o:File HRef="')
      #set( $file = $file.concat( $f))
      #set( $file = $file.concat('"/>'))
      #if( $files.add( $file)) #end
      #set( $jama_cid = $f)
      #set( $newSourceLink = "cid:")
      #set( $newSourceLink = $newSourceLink.concat( $jama_cid))
      #if( $figure.add( $boundaryString)) #end
      #set( $img_jama_cid = "Content-ID: ")
      #set( $img_jama_cid = $img_jama_cid.concat( $jama_cid))
      #if( $figure.add( $img_jama_cid)) #end
      #if( $figure.add( "Content-Transfer-Encoding: base64 ")) #end
      #set( $contentType =  "Content-Type: image/")
      #set( $contentType = $contentType.concat($fileExt))
      #if( $figure.add( $contentType)) #end
      #if( $figure.add( "")) #end
      #set( $base64Fig = $attachmentService.getBase64Image( $mathTool.toInteger( $attachmentId)))
##
      ## if this a PNG, get the size
      #if( $base64Fig.substring(0, 16) == "iVBORw0KGgoAAAAN")
        #set( $base64ImageHeader = $base64Fig.substring(16, 32) )
        
        #set( $binaryImageHeader = "")
        #foreach( $i in [0..15] )
          #set( $j = $i + 1 )
          #set( $value = $base64ImageHeader.substring($i, $j) )
          ##$value
          #if( $value == "A" ) #set( $binaryImageHeader = "${binaryImageHeader}000000")
          #elseif( $value == "B" ) #set( $binaryImageHeader = "${binaryImageHeader}000001")
          #elseif( $value == "C" ) #set( $binaryImageHeader = "${binaryImageHeader}000010")
          #elseif( $value == "D" ) #set( $binaryImageHeader = "${binaryImageHeader}000011")
          #elseif( $value == "E" ) #set( $binaryImageHeader = "${binaryImageHeader}000100")
          #elseif( $value == "F" ) #set( $binaryImageHeader = "${binaryImageHeader}000101")
          #elseif( $value == "G" ) #set( $binaryImageHeader = "${binaryImageHeader}000110")
          #elseif( $value == "H" ) #set( $binaryImageHeader = "${binaryImageHeader}000111")
          #elseif( $value == "I" ) #set( $binaryImageHeader = "${binaryImageHeader}001000")
          #elseif( $value == "J" ) #set( $binaryImageHeader = "${binaryImageHeader}001001")
          #elseif( $value == "K" ) #set( $binaryImageHeader = "${binaryImageHeader}001010")
          #elseif( $value == "L" ) #set( $binaryImageHeader = "${binaryImageHeader}001011")
          #elseif( $value == "M" ) #set( $binaryImageHeader = "${binaryImageHeader}001100")
          #elseif( $value == "N" ) #set( $binaryImageHeader = "${binaryImageHeader}001101")
          #elseif( $value == "O" ) #set( $binaryImageHeader = "${binaryImageHeader}001110")
          #elseif( $value == "P" ) #set( $binaryImageHeader = "${binaryImageHeader}001111")
          #elseif( $value == "Q" ) #set( $binaryImageHeader = "${binaryImageHeader}010000")
          #elseif( $value == "R" ) #set( $binaryImageHeader = "${binaryImageHeader}010001")
          #elseif( $value == "S" ) #set( $binaryImageHeader = "${binaryImageHeader}010010")
          #elseif( $value == "T" ) #set( $binaryImageHeader = "${binaryImageHeader}010011")
          #elseif( $value == "U" ) #set( $binaryImageHeader = "${binaryImageHeader}010100")
          #elseif( $value == "V" ) #set( $binaryImageHeader = "${binaryImageHeader}010101")
          #elseif( $value == "W" ) #set( $binaryImageHeader = "${binaryImageHeader}010110")
          #elseif( $value == "X" ) #set( $binaryImageHeader = "${binaryImageHeader}010111")
          #elseif( $value == "Y" ) #set( $binaryImageHeader = "${binaryImageHeader}011000")
          #elseif( $value == "Z" ) #set( $binaryImageHeader = "${binaryImageHeader}011001")
          #elseif( $value == "a" ) #set( $binaryImageHeader = "${binaryImageHeader}011010")
          #elseif( $value == "b" ) #set( $binaryImageHeader = "${binaryImageHeader}011011")
          #elseif( $value == "c" ) #set( $binaryImageHeader = "${binaryImageHeader}011100")
          #elseif( $value == "d" ) #set( $binaryImageHeader = "${binaryImageHeader}011101")
          #elseif( $value == "e" ) #set( $binaryImageHeader = "${binaryImageHeader}011110")
          #elseif( $value == "f" ) #set( $binaryImageHeader = "${binaryImageHeader}011111")
          #elseif( $value == "g" ) #set( $binaryImageHeader = "${binaryImageHeader}100000")
          #elseif( $value == "h" ) #set( $binaryImageHeader = "${binaryImageHeader}100001")
          #elseif( $value == "i" ) #set( $binaryImageHeader = "${binaryImageHeader}100010")
          #elseif( $value == "j" ) #set( $binaryImageHeader = "${binaryImageHeader}100011")
          #elseif( $value == "k" ) #set( $binaryImageHeader = "${binaryImageHeader}100100")
          #elseif( $value == "l" ) #set( $binaryImageHeader = "${binaryImageHeader}100101")
          #elseif( $value == "m" ) #set( $binaryImageHeader = "${binaryImageHeader}100110")
          #elseif( $value == "n" ) #set( $binaryImageHeader = "${binaryImageHeader}100111")
          #elseif( $value == "o" ) #set( $binaryImageHeader = "${binaryImageHeader}101000")
          #elseif( $value == "p" ) #set( $binaryImageHeader = "${binaryImageHeader}101001")
          #elseif( $value == "q" ) #set( $binaryImageHeader = "${binaryImageHeader}101010")
          #elseif( $value == "r" ) #set( $binaryImageHeader = "${binaryImageHeader}101011")
          #elseif( $value == "s" ) #set( $binaryImageHeader = "${binaryImageHeader}101100")
          #elseif( $value == "t" ) #set( $binaryImageHeader = "${binaryImageHeader}101101")
          #elseif( $value == "u" ) #set( $binaryImageHeader = "${binaryImageHeader}101110")
          #elseif( $value == "v" ) #set( $binaryImageHeader = "${binaryImageHeader}101111")
          #elseif( $value == "w" ) #set( $binaryImageHeader = "${binaryImageHeader}110000")
          #elseif( $value == "x" ) #set( $binaryImageHeader = "${binaryImageHeader}110001")
          #elseif( $value == "y" ) #set( $binaryImageHeader = "${binaryImageHeader}110010")
          #elseif( $value == "z" ) #set( $binaryImageHeader = "${binaryImageHeader}110011")
          #elseif( $value == "0" ) #set( $binaryImageHeader = "${binaryImageHeader}110100")
          #elseif( $value == "1" ) #set( $binaryImageHeader = "${binaryImageHeader}110101")
          #elseif( $value == "2" ) #set( $binaryImageHeader = "${binaryImageHeader}110110")
          #elseif( $value == "3" ) #set( $binaryImageHeader = "${binaryImageHeader}110111")
          #elseif( $value == "4" ) #set( $binaryImageHeader = "${binaryImageHeader}111000")
          #elseif( $value == "5" ) #set( $binaryImageHeader = "${binaryImageHeader}111001")
          #elseif( $value == "6" ) #set( $binaryImageHeader = "${binaryImageHeader}111010")
          #elseif( $value == "7" ) #set( $binaryImageHeader = "${binaryImageHeader}111011")
          #elseif( $value == "8" ) #set( $binaryImageHeader = "${binaryImageHeader}111100")
          #elseif( $value == "9" ) #set( $binaryImageHeader = "${binaryImageHeader}111101")
          #elseif( $value == "+" ) #set( $binaryImageHeader = "${binaryImageHeader}111110")
          #elseif( $value == "/" ) #set( $binaryImageHeader = "${binaryImageHeader}111111") #end
        #end
        ##IMAGE HEADER: $binaryImageHeader
        #set( $width = $mathTool.toInteger($binaryImageHeader.substring(32, 33)) * 2147483648 +
                       $mathTool.toInteger($binaryImageHeader.substring(33, 34)) * 1073741824 +
                       $mathTool.toInteger($binaryImageHeader.substring(34, 35)) * 536870912 +
                       $mathTool.toInteger($binaryImageHeader.substring(35, 36)) * 268435456 +
                       $mathTool.toInteger($binaryImageHeader.substring(36, 37)) * 134217728 +
                       $mathTool.toInteger($binaryImageHeader.substring(37, 38)) * 67108864 +
                       $mathTool.toInteger($binaryImageHeader.substring(38, 39)) * 33554432 +
                       $mathTool.toInteger($binaryImageHeader.substring(39, 40)) * 16777216 +
                       $mathTool.toInteger($binaryImageHeader.substring(40, 41)) * 8388608 +
                       $mathTool.toInteger($binaryImageHeader.substring(41, 42)) * 4194304 +
                       $mathTool.toInteger($binaryImageHeader.substring(42, 43)) * 2097152 +
                       $mathTool.toInteger($binaryImageHeader.substring(43, 44)) * 1048576 +
                       $mathTool.toInteger($binaryImageHeader.substring(44, 45)) * 524288 +
                       $mathTool.toInteger($binaryImageHeader.substring(45, 46)) * 262144 +
                       $mathTool.toInteger($binaryImageHeader.substring(46, 47)) * 131072 +
                       $mathTool.toInteger($binaryImageHeader.substring(47, 48)) * 65536 +
                       $mathTool.toInteger($binaryImageHeader.substring(48, 49)) * 32768 +
                       $mathTool.toInteger($binaryImageHeader.substring(49, 50)) * 16384 +
                       $mathTool.toInteger($binaryImageHeader.substring(50, 51)) * 8192 +
                       $mathTool.toInteger($binaryImageHeader.substring(51, 52)) * 4096 +
                       $mathTool.toInteger($binaryImageHeader.substring(52, 53)) * 2048 +
                       $mathTool.toInteger($binaryImageHeader.substring(53, 54)) * 1024 +
                       $mathTool.toInteger($binaryImageHeader.substring(54, 55)) * 512 +
                       $mathTool.toInteger($binaryImageHeader.substring(55, 56)) * 256 +
                       $mathTool.toInteger($binaryImageHeader.substring(56, 57)) * 128 +
                       $mathTool.toInteger($binaryImageHeader.substring(57, 58)) * 64 +
                       $mathTool.toInteger($binaryImageHeader.substring(58, 59)) * 32 +
                       $mathTool.toInteger($binaryImageHeader.substring(59, 60)) * 16 +
                       $mathTool.toInteger($binaryImageHeader.substring(60, 61)) * 8 +
                       $mathTool.toInteger($binaryImageHeader.substring(61, 62)) * 4 +
                       $mathTool.toInteger($binaryImageHeader.substring(62, 63)) * 2 +
                       $mathTool.toInteger($binaryImageHeader.substring(63, 64)) * 1 )
        #set( $height = $mathTool.toInteger($binaryImageHeader.substring(64, 65)) * 2147483648 +
                       $mathTool.toInteger($binaryImageHeader.substring(65, 66)) * 1073741824 +
                       $mathTool.toInteger($binaryImageHeader.substring(66, 67)) * 536870912 +
                       $mathTool.toInteger($binaryImageHeader.substring(67, 68)) * 268435456 +
                       $mathTool.toInteger($binaryImageHeader.substring(68, 69)) * 134217728 +
                       $mathTool.toInteger($binaryImageHeader.substring(69, 70)) * 67108864 +
                       $mathTool.toInteger($binaryImageHeader.substring(70, 71)) * 33554432 +
                       $mathTool.toInteger($binaryImageHeader.substring(71, 72)) * 16777216 +
                       $mathTool.toInteger($binaryImageHeader.substring(72, 73)) * 8388608 +
                       $mathTool.toInteger($binaryImageHeader.substring(73, 74)) * 4194304 +
                       $mathTool.toInteger($binaryImageHeader.substring(74, 75)) * 2097152 +
                       $mathTool.toInteger($binaryImageHeader.substring(75, 76)) * 1048576 +
                       $mathTool.toInteger($binaryImageHeader.substring(76, 77)) * 524288 +
                       $mathTool.toInteger($binaryImageHeader.substring(77, 78)) * 262144 +
                       $mathTool.toInteger($binaryImageHeader.substring(78, 79)) * 131072 +
                       $mathTool.toInteger($binaryImageHeader.substring(79, 80)) * 65536 +
                       $mathTool.toInteger($binaryImageHeader.substring(80, 81)) * 32768 +
                       $mathTool.toInteger($binaryImageHeader.substring(81, 82)) * 16384 +
                       $mathTool.toInteger($binaryImageHeader.substring(82, 83)) * 8192 +
                       $mathTool.toInteger($binaryImageHeader.substring(83, 84)) * 4096 +
                       $mathTool.toInteger($binaryImageHeader.substring(84, 85)) * 2048 +
                       $mathTool.toInteger($binaryImageHeader.substring(85, 86)) * 1024 +
                       $mathTool.toInteger($binaryImageHeader.substring(86, 87)) * 512 +
                       $mathTool.toInteger($binaryImageHeader.substring(87, 88)) * 256 +
                       $mathTool.toInteger($binaryImageHeader.substring(88, 89)) * 128 +
                       $mathTool.toInteger($binaryImageHeader.substring(89, 90)) * 64 +
                       $mathTool.toInteger($binaryImageHeader.substring(90, 91)) * 32 +
                       $mathTool.toInteger($binaryImageHeader.substring(91, 92)) * 16 +
                       $mathTool.toInteger($binaryImageHeader.substring(92, 93)) * 8 +
                       $mathTool.toInteger($binaryImageHeader.substring(93, 94)) * 4 +
                       $mathTool.toInteger($binaryImageHeader.substring(94, 95)) * 2 +
                       $mathTool.toInteger($binaryImageHeader.substring(95, 96)) * 1 )
        #if( $imageSizeArrayMHTMLReturn.add( {"width":$width, "height":$height}) ) #end
      #elseif( $fileExt == "svg" || $fileExt == "SVG" )
        #set( $binaryImageHeader = "")
        #foreach( $i in [0..2000] )
          #set( $j = $i + 1 )
          #set( $value = $base64Fig.substring($i, $j) )
          ##$value
          #if( $value == "A" ) #set( $binaryImageHeader = "${binaryImageHeader}000000")
          #elseif( $value == "B" ) #set( $binaryImageHeader = "${binaryImageHeader}000001")
          #elseif( $value == "C" ) #set( $binaryImageHeader = "${binaryImageHeader}000010")
          #elseif( $value == "D" ) #set( $binaryImageHeader = "${binaryImageHeader}000011")
          #elseif( $value == "E" ) #set( $binaryImageHeader = "${binaryImageHeader}000100")
          #elseif( $value == "F" ) #set( $binaryImageHeader = "${binaryImageHeader}000101")
          #elseif( $value == "G" ) #set( $binaryImageHeader = "${binaryImageHeader}000110")
          #elseif( $value == "H" ) #set( $binaryImageHeader = "${binaryImageHeader}000111")
          #elseif( $value == "I" ) #set( $binaryImageHeader = "${binaryImageHeader}001000")
          #elseif( $value == "J" ) #set( $binaryImageHeader = "${binaryImageHeader}001001")
          #elseif( $value == "K" ) #set( $binaryImageHeader = "${binaryImageHeader}001010")
          #elseif( $value == "L" ) #set( $binaryImageHeader = "${binaryImageHeader}001011")
          #elseif( $value == "M" ) #set( $binaryImageHeader = "${binaryImageHeader}001100")
          #elseif( $value == "N" ) #set( $binaryImageHeader = "${binaryImageHeader}001101")
          #elseif( $value == "O" ) #set( $binaryImageHeader = "${binaryImageHeader}001110")
          #elseif( $value == "P" ) #set( $binaryImageHeader = "${binaryImageHeader}001111")
          #elseif( $value == "Q" ) #set( $binaryImageHeader = "${binaryImageHeader}010000")
          #elseif( $value == "R" ) #set( $binaryImageHeader = "${binaryImageHeader}010001")
          #elseif( $value == "S" ) #set( $binaryImageHeader = "${binaryImageHeader}010010")
          #elseif( $value == "T" ) #set( $binaryImageHeader = "${binaryImageHeader}010011")
          #elseif( $value == "U" ) #set( $binaryImageHeader = "${binaryImageHeader}010100")
          #elseif( $value == "V" ) #set( $binaryImageHeader = "${binaryImageHeader}010101")
          #elseif( $value == "W" ) #set( $binaryImageHeader = "${binaryImageHeader}010110")
          #elseif( $value == "X" ) #set( $binaryImageHeader = "${binaryImageHeader}010111")
          #elseif( $value == "Y" ) #set( $binaryImageHeader = "${binaryImageHeader}011000")
          #elseif( $value == "Z" ) #set( $binaryImageHeader = "${binaryImageHeader}011001")
          #elseif( $value == "a" ) #set( $binaryImageHeader = "${binaryImageHeader}011010")
          #elseif( $value == "b" ) #set( $binaryImageHeader = "${binaryImageHeader}011011")
          #elseif( $value == "c" ) #set( $binaryImageHeader = "${binaryImageHeader}011100")
          #elseif( $value == "d" ) #set( $binaryImageHeader = "${binaryImageHeader}011101")
          #elseif( $value == "e" ) #set( $binaryImageHeader = "${binaryImageHeader}011110")
          #elseif( $value == "f" ) #set( $binaryImageHeader = "${binaryImageHeader}011111")
          #elseif( $value == "g" ) #set( $binaryImageHeader = "${binaryImageHeader}100000")
          #elseif( $value == "h" ) #set( $binaryImageHeader = "${binaryImageHeader}100001")
          #elseif( $value == "i" ) #set( $binaryImageHeader = "${binaryImageHeader}100010")
          #elseif( $value == "j" ) #set( $binaryImageHeader = "${binaryImageHeader}100011")
          #elseif( $value == "k" ) #set( $binaryImageHeader = "${binaryImageHeader}100100")
          #elseif( $value == "l" ) #set( $binaryImageHeader = "${binaryImageHeader}100101")
          #elseif( $value == "m" ) #set( $binaryImageHeader = "${binaryImageHeader}100110")
          #elseif( $value == "n" ) #set( $binaryImageHeader = "${binaryImageHeader}100111")
          #elseif( $value == "o" ) #set( $binaryImageHeader = "${binaryImageHeader}101000")
          #elseif( $value == "p" ) #set( $binaryImageHeader = "${binaryImageHeader}101001")
          #elseif( $value == "q" ) #set( $binaryImageHeader = "${binaryImageHeader}101010")
          #elseif( $value == "r" ) #set( $binaryImageHeader = "${binaryImageHeader}101011")
          #elseif( $value == "s" ) #set( $binaryImageHeader = "${binaryImageHeader}101100")
          #elseif( $value == "t" ) #set( $binaryImageHeader = "${binaryImageHeader}101101")
          #elseif( $value == "u" ) #set( $binaryImageHeader = "${binaryImageHeader}101110")
          #elseif( $value == "v" ) #set( $binaryImageHeader = "${binaryImageHeader}101111")
          #elseif( $value == "w" ) #set( $binaryImageHeader = "${binaryImageHeader}110000")
          #elseif( $value == "x" ) #set( $binaryImageHeader = "${binaryImageHeader}110001")
          #elseif( $value == "y" ) #set( $binaryImageHeader = "${binaryImageHeader}110010")
          #elseif( $value == "z" ) #set( $binaryImageHeader = "${binaryImageHeader}110011")
          #elseif( $value == "0" ) #set( $binaryImageHeader = "${binaryImageHeader}110100")
          #elseif( $value == "1" ) #set( $binaryImageHeader = "${binaryImageHeader}110101")
          #elseif( $value == "2" ) #set( $binaryImageHeader = "${binaryImageHeader}110110")
          #elseif( $value == "3" ) #set( $binaryImageHeader = "${binaryImageHeader}110111")
          #elseif( $value == "4" ) #set( $binaryImageHeader = "${binaryImageHeader}111000")
          #elseif( $value == "5" ) #set( $binaryImageHeader = "${binaryImageHeader}111001")
          #elseif( $value == "6" ) #set( $binaryImageHeader = "${binaryImageHeader}111010")
          #elseif( $value == "7" ) #set( $binaryImageHeader = "${binaryImageHeader}111011")
          #elseif( $value == "8" ) #set( $binaryImageHeader = "${binaryImageHeader}111100")
          #elseif( $value == "9" ) #set( $binaryImageHeader = "${binaryImageHeader}111101")
          #elseif( $value == "+" ) #set( $binaryImageHeader = "${binaryImageHeader}111110")
          #elseif( $value == "/" ) #set( $binaryImageHeader = "${binaryImageHeader}111111") #end
        #end
        ##IMAGE HEADER: $binaryImageHeader
        #set( $byteCount = $binaryImageHeader.length() / 8 -  1 )
        #set( $ascii = "" )
        #foreach( $byte in [0..$byteCount] )
          #set( $i = $byte * 8)
          #set( $j = $i + 8 )
          #set( $value = $binaryImageHeader.substring($i, $j) )
          #if( $value == "00100000") #set($ascii = "${ascii} ")
          #elseif( $value == "00100001") #set($ascii = "${ascii}!")
          #elseif( $value == "00100010") #set($ascii = "${ascii}$escapeTool.getQuote()")
          #elseif( $value == "00100011") #set($ascii = "${ascii}#")
          #elseif( $value == "00100100") #set($ascii = "${ascii}$")
          #elseif( $value == "00100101") #set($ascii = "${ascii}%")
          #elseif( $value == "00100110") #set($ascii = "${ascii}&")
          #elseif( $value == "00100111") #set($ascii = "${ascii}'")
          #elseif( $value == "00101000") #set($ascii = "${ascii}(")
          #elseif( $value == "00101001") #set($ascii = "${ascii})")
          #elseif( $value == "00101010") #set($ascii = "${ascii}*")
          #elseif( $value == "00101011") #set($ascii = "${ascii}+")
          #elseif( $value == "00101100") #set($ascii = "${ascii},")
          #elseif( $value == "00101101") #set($ascii = "${ascii}-")
          #elseif( $value == "00101110") #set($ascii = "${ascii}.")
          #elseif( $value == "00101111") #set($ascii = "${ascii}/")
          #elseif( $value == "00110000") #set($ascii = "${ascii}0")
          #elseif( $value == "00110001") #set($ascii = "${ascii}1")
          #elseif( $value == "00110010") #set($ascii = "${ascii}2")
          #elseif( $value == "00110011") #set($ascii = "${ascii}3")
          #elseif( $value == "00110100") #set($ascii = "${ascii}4")
          #elseif( $value == "00110101") #set($ascii = "${ascii}5")
          #elseif( $value == "00110110") #set($ascii = "${ascii}6")
          #elseif( $value == "00110111") #set($ascii = "${ascii}7")
          #elseif( $value == "00111000") #set($ascii = "${ascii}8")
          #elseif( $value == "00111001") #set($ascii = "${ascii}9")
          #elseif( $value == "00111010") #set($ascii = "${ascii}:")
          #elseif( $value == "00111011") #set($ascii = "${ascii};")
          #elseif( $value == "00111100") #set($ascii = "${ascii}<")
          #elseif( $value == "00111101") #set($ascii = "${ascii}=")
          #elseif( $value == "00111110") #set($ascii = "${ascii}>")
          #elseif( $value == "00111111") #set($ascii = "${ascii}?")
          #elseif( $value == "01000000") #set($ascii = "${ascii}@")
          #elseif( $value == "01000001") #set($ascii = "${ascii}A")
          #elseif( $value == "01000010") #set($ascii = "${ascii}B")
          #elseif( $value == "01000011") #set($ascii = "${ascii}C")
          #elseif( $value == "01000100") #set($ascii = "${ascii}D")
          #elseif( $value == "01000101") #set($ascii = "${ascii}E")
          #elseif( $value == "01000110") #set($ascii = "${ascii}F")
          #elseif( $value == "01000111") #set($ascii = "${ascii}G")
          #elseif( $value == "01001000") #set($ascii = "${ascii}H")
          #elseif( $value == "01001001") #set($ascii = "${ascii}I")
          #elseif( $value == "01001010") #set($ascii = "${ascii}J")
          #elseif( $value == "01001011") #set($ascii = "${ascii}K")
          #elseif( $value == "01001100") #set($ascii = "${ascii}L")
          #elseif( $value == "01001101") #set($ascii = "${ascii}M")
          #elseif( $value == "01001110") #set($ascii = "${ascii}N")
          #elseif( $value == "01001111") #set($ascii = "${ascii}O")
          #elseif( $value == "01010000") #set($ascii = "${ascii}P")
          #elseif( $value == "01010001") #set($ascii = "${ascii}Q")
          #elseif( $value == "01010010") #set($ascii = "${ascii}R")
          #elseif( $value == "01010011") #set($ascii = "${ascii}S")
          #elseif( $value == "01010100") #set($ascii = "${ascii}T")
          #elseif( $value == "01010101") #set($ascii = "${ascii}U")
          #elseif( $value == "01010110") #set($ascii = "${ascii}V")
          #elseif( $value == "01010111") #set($ascii = "${ascii}W")
          #elseif( $value == "01011000") #set($ascii = "${ascii}X")
          #elseif( $value == "01011001") #set($ascii = "${ascii}Y")
          #elseif( $value == "01011010") #set($ascii = "${ascii}Z")
          #elseif( $value == "01011011") #set($ascii = "${ascii}[")
          #elseif( $value == "01011100") #set($ascii = "${ascii}$escapeTool.getBackslash()")
          #elseif( $value == "01011101") #set($ascii = "${ascii}]")
          #elseif( $value == "01011110") #set($ascii = "${ascii}^")
          #elseif( $value == "01011111") #set($ascii = "${ascii}_")
          #elseif( $value == "01100000") #set($ascii = "${ascii}`")
          #elseif( $value == "01100001") #set($ascii = "${ascii}a")
          #elseif( $value == "01100010") #set($ascii = "${ascii}b")
          #elseif( $value == "01100011") #set($ascii = "${ascii}c")
          #elseif( $value == "01100100") #set($ascii = "${ascii}d")
          #elseif( $value == "01100101") #set($ascii = "${ascii}e")
          #elseif( $value == "01100110") #set($ascii = "${ascii}f")
          #elseif( $value == "01100111") #set($ascii = "${ascii}g")
          #elseif( $value == "01101000") #set($ascii = "${ascii}h")
          #elseif( $value == "01101001") #set($ascii = "${ascii}i")
          #elseif( $value == "01101010") #set($ascii = "${ascii}j")
          #elseif( $value == "01101011") #set($ascii = "${ascii}k")
          #elseif( $value == "01101100") #set($ascii = "${ascii}l")
          #elseif( $value == "01101101") #set($ascii = "${ascii}m")
          #elseif( $value == "01101110") #set($ascii = "${ascii}n")
          #elseif( $value == "01101111") #set($ascii = "${ascii}o")
          #elseif( $value == "01110000") #set($ascii = "${ascii}p")
          #elseif( $value == "01110001") #set($ascii = "${ascii}q")
          #elseif( $value == "01110010") #set($ascii = "${ascii}r")
          #elseif( $value == "01110011") #set($ascii = "${ascii}s")
          #elseif( $value == "01110100") #set($ascii = "${ascii}t")
          #elseif( $value == "01110101") #set($ascii = "${ascii}u")
          #elseif( $value == "01110110") #set($ascii = "${ascii}v")
          #elseif( $value == "01110111") #set($ascii = "${ascii}w")
          #elseif( $value == "01111000") #set($ascii = "${ascii}x")
          #elseif( $value == "01111001") #set($ascii = "${ascii}y")
          #elseif( $value == "01111010") #set($ascii = "${ascii}z")
          #elseif( $value == "01111011") #set($ascii = "${ascii}{")
          #elseif( $value == "01111100") #set($ascii = "${ascii}|")
          #elseif( $value == "01111101") #set($ascii = "${ascii}}")
          #elseif( $value == "01111110") #set($ascii = "${ascii}~") #end
        #end
        #set( $height = $ascii.replaceAll('(?s).*?<svg.*?height="(\d*).*?".*?>','$1') )
        #set( $width = $ascii.replaceAll('(?s).*?<svg.*?width="(\d*).*?".*?>','$1') )
        #if( $imageSizeArrayMHTMLReturn.add( {"width":$width, "height":$height}) ) #end
      #else
        #if( $imageSizeArrayMHTMLReturn.add( {"width":false, "height":false}) ) #end
      #end
      #if( $figure.add( $base64Fig)) #end
      #if( $figure.add( "")) #end
      #if( $base64Fig )
        #set( $imageData = "data:image/" )
        #set( $imageData = $imageData.concat($fileExt) )
        #set( $imageData = $imageData.concat(";base64, ") )
        #set( $imageData = $imageData.concat($base64Fig) )
      #else
        #set( $imageData = "" )
      #end
      #if( $imageBase64ArrayHTMLReturn.add( $imageData)) #end
    #else ##Return the same source
      #set( $newSourceLink = "")
    #end
    #if( $imageArrayMHTMLReturn.add( $newSourceLink)) #end
  #end
#end
##                                                                                                               
#########################################################################################################################
##                  Macro: DOC format Convert Figures to Word shapes, resize and format considering img location      ###
##                         PDF format Convert Figures to base66, resize, and format considering img location          ###
##                         $input - string: string passed to the macro containing img tags                            ###
##                         $maxWidth - number: maximum allowed width of images, resize if greater                     ###
##                         Returns string with images converted to base64                                             ###
##                  Sub-macros by format:                                                                             ### 
##                        #formatEquation_DOC, #formatEquation_PDF                                                    ### 
##                        #formatImgInTable_DOC, #formatImgInTable_PDF                                                ### 
##                        #formatFigWithCaptions_DOC, #formatFigWithCaptions_PDF                                      ###         
##                        #formatImgWithOptionForCaptions_DOC, #formatImgWithOptionForCaptions_PDF (will              ###
##                        automatically include figure captions for all figures if $TOF_includeAllFigures is true     ### 
##                        so that all figures will be included in the TOF)                                            ### 
##                                                                                                                    ###
#########################################################################################################################
#macro( convertFigures $input $maxWidth )
  ## clear any previous values
  #set( $width = false )
  #set( $height = false )
  #set( $targetWidth = false )
  #set( $targetHeight = false )
##

  #if( !$maxPageHeight )
    #set($maxHeight = 575)
  #else
    #set($maxHeight = $maxPageHeight )
  #end

  ## Create the initial output string
  #set( $output = $input )
##
  ## process if there is at least one image tag in the string
  #if( $input.indexOf("<img") > -1 )
##
    ## Create a list of all image Urls in the string
    #findSourceMHTML( $input )
    #set( $imgUrls = $findSourceMHTMLReturn)
    #### Debug imgUrls: $imgUrls
##
    ## Embedded each image in the MTHML output, create a list of the sources
    ## and create a list of the image sizes for PNG images
    #imageArrayMTHML( $imgUrls )
    #set( $imgSources = $imageArrayMHTMLReturn )
    #set( $imageSizes = $imageSizeArrayMHTMLReturn )
    #set( $imageBase64s = $imageBase64ArrayHTMLReturn )

    #### Debug imgSources: $imgSources

    ## For each identified image
    ## 	- 'doc' format replace the HTML img tag with Word Shape 
    ## 	- 'pdf' format replace the HTML img tag with base64

    #foreach( $imgSource in $imgSources)
		#set( $imgIndex = $foreach.index )

		## if the image is not already base64 encoded
		#if( $imgUrls.get($imgIndex).indexOf(";base64") == -1 )
		## Locate the position of this image
			#set( $sourcePosition = $input.indexOf($imgUrls.get($imgIndex)) )
			#set( $inputStart = $input.lastIndexOf("<img", $sourcePosition) )
			#set( $inputEnd = $input.indexOf(">", $sourcePosition) )
			#if( $inputStart > -1 && $inputEnd > -1 )
			    #set( $inputImage = "" )
			    #set( $inputImage = $input.substring($inputStart, $inputEnd) )
			##
				## Determine the size of the image stored in HTML
				#if( $inputImage.indexOf( "height=") > -1 && $inputImage.indexOf( "width=") > -1)
					#set($height = $inputImage.replaceAll('(?s).*?height="([0-9]*)".*','$1'))
					#set($width = $inputImage.replaceAll('(?s).*?width="([0-9]*)".*','$1'))
					## If no image size is found in HTML, use the image size extracted directly from the image
					## Only works for PNGs. Non-PNGs return a height and width of false
				#elseif( $imageSizes.size() > $imgIndex )
					#set( $height = $imageSizes.get($imgIndex).height )
					#set( $width = $imageSizes.get($imgIndex).width )
				#end
			  	#### Debug: width=$width, height=$height
			##
			  
			  ## if a hight and width are known, resize the image appropriately
			  	#if( $height && $width )
					## Adjust extracted values from px to pt to accuratly compare to max page dimensions: ((1px = 1/96th of 1in) - (1pt = 1/72 of 1in))
					#set( $widthInt = $mathTool.toNumber($width) * 0.75 )
					#set( $heightInt = $mathTool.toNumber($height) * 0.75)
					#### Debug: $widthInt x $heightInt
					##
					#set ($aspectRatio = 1.5)
					#set ($aspectRatio = $mathTool.toDouble($widthInt) / $mathTool.toDouble($heightInt))
					#### Debug Aspect Ratio: $aspectRatio
					##
					## if the image is a formula created by Wiris and less than the max width, reduce the size to 75%
					#if( $input.indexOf("Wirisformula") > -1 && $widthInt <= $maxWidth )
					    #set( $targetWidth = $mathTool.mul($widthInt, 0.75) )
					    #set( $targetHeight = $mathTool.div($mathTool.toNumber($targetWidth), $aspectRatio) )
					##
					## if the image is higher than allowed, resize
					#elseif( $heightInt > $maxHeight )
					    #set ($targetHeight = $maxHeight)
					    #set ($targetWidth = $mathTool.mul($mathTool.toNumber($targetHeight), $aspectRatio))
					##
					  ## if the image is still wider than allowed, resize again
					    #if( $targetWidth > $maxWidth )
					        #set ($targetWidth = $maxWidth)
					        #set ($targetHeight = $mathTool.div($mathTool.toNumber($targetWidth), $aspectRatio))
					    #end
					##
					## if the image is wider than allowed, resize
					#elseif( $widthInt > $maxWidth )
					  	#set ($targetWidth = $maxWidth)
					  	#set ($targetHeight = $mathTool.div($mathTool.toNumber($targetWidth), $aspectRatio))
					##
					  ## if the image is still higher than allowed, resize again
					  	#if( $targetHeight > $maxHeight )
					    	#set ($targetHeight = $maxHeight)
					    	#set ($targetWidth = $mathTool.mul($mathTool.toNumber($targetHeight), $aspectRatio))
					  	#end
					#else
					  	#set ($targetWidth = $widthInt)
					  	#set ($targetHeight = $heightInt)
					#end

				#else
					## if no height and width found set to 1/2 max expecting a 4:3 ratio
					## PDF has auto responsive heights and therefore needs only the targetWidth, but Word shapes must have a both edge values
					#set( $targetWidth = 234 )
					#set( $targetHeight = 176 )
				#end      

				## find string for use in final replace all
				#set( $find = "(?s)<img{^>}*?$imgUrls.get($imgIndex){^>}*?>" )
				#set( $find = $find.replaceAll("\/", "\\/") )
				#set( $find = $find.replaceAll("\{", "[") )
				#set( $find = $find.replaceAll("\}", "]") )
				
				## Debug find: $find <br>

			    #######################################################################################
				## Find Img Location 
				##             - utilize $find to determine img position in rich text to ensure proper
				##               replacement format  
				#######################################################################################
				#set( $imgInTable = false )
				#set( $imgInFigure = false)
				#set( $isImgInTable = $input )
				#set( $isImgInFig = $input )
				
  				#set( $isImgInTable = $isImgInTable.replaceAll( "<td.*?>.*?$find.*?<\/td>", "[imgInTable]"))
				
				#if( $isImgInTable.contains("[imgInTable]"))
					#set( $imgInTable = true )
				#else
					#set( $isImgInFig = $isImgInFig.replaceAll("<figure.*?>.*?$find", "[imgInFigTags]"))
					#if( $isImgInFig.contains( "[imgInFigTags]"))
						#set( $imgInFigure = true )   
					#end
				#end 
	
				#######################################################################################
				## Img Alignment 
				##             - utilize $find to locate alignment on the img and store it in $imgAlign
				#######################################################################################
				#set( $isThereAlignment = $input )
				#set( $imgAlign = $input )

				#if( $imgInFigure )
					#set( $isThereAlignment = $isThereAlignment.replaceAll("<(figure|div).*?(text-align|float):(\w*?).*?>.*?$find", "[align]"))
					#if( $isThereAlignment.contains("[align]"))
						#set( $imgAlign = $imgAlign.replaceAll("[^*]*?<(figure|div).*?(text-align|float):(\w*).*$find(?:.*)", "$3" ))
						#set( $imgAlign = $imgAlign.trim())
					#else
						#set( $imgAlign = 'left')
					#end 
				#else
					#set( $isThereAlignment = $isThereAlignment.replaceAll("<(p|div).*?(text-align:)(\w*?).*?>.*?$find", "[align]"))
					#if( $isThereAlignment.contains("[align]"))
						#set( $imgAlign = $imgAlign.replaceAll("[^*]*?<(p|div).*?text-align:(\w*).*$find(?:.*)", "$2" ))
						#set( $imgAlign = $imgAlign.trim())
					#else 
						#set( $imgAlign ='left')
					#end
				#end 

				#if( $format == 'pdf')
					#if( $imgAlign == 'center')
						#set( $imgAlignMargin = 'margin:auto !important;')
					#elseif( $imgAlign == 'right')
						#set( $imgAlignMargin = 'margin-left:auto !important;margin-right:0pt !important;')
					#else 
						#set( $imgAlignMargin = 'margin:0;')
					#end 
				#end 

				#######################################################################################
				## Figcaption Alignment
				##         - set the default alignment (Figcaptions in Jama are left aligned and unless
				##           an img is centered )
				#######################################################################################

				#if( $imgAlign == 'center')
					#set( $figCapAlign = 'center')
				#else 
					#set( $figCapAlign = 'center') ## Set default figCaption alignment here 
				#end 
				
				##DEBUG IMG ALIGN $imgAlign <br>

				#######################################################################################
				## Figcaption Content 
				##         - locate figcaption content on the img and store it in $figCaptionContent
				#######################################################################################
				#set( $figCaptionContent = $input)
				#set( $figCaptionContent = $figCaptionContent.replaceAll("\n|\t", ""))

				#if( $imgInFigure)
			      	#set( $figCaptionContent = $input.replaceAll("[^*]*?$find.*?(<figcaption.*?>)(.*?\s*?|.*\n*?|.*\t*?)(<\/figcaption>)(?:.*)", "$1$2$3"))

			      	#set( $figCaptionContent = $figCaptionContent.replaceAll("<\/figcaption>",""))
			      	#set( $figCaptionContent = $figCaptionContent.replaceAll("<figcaption>",""))
			    #end 

			    ##DEBUG FIG CAP CONTENT $figCaptionContent <br>

				#######################################################################################
				## - Word img and figcaption $replace handling: One of the following macros will 
				##			set $replace accordingly with the Word Shape $imgSource of that img.
				#######################################################################################
				#if( $format == "doc")

					#if( $find.contains("equation"))
						#formatEquation_DOC( $targetWidth $targetHeight $imgSource $imgAlign )

					#elseif( $imgInTable )
						#formatImgInTable_DOC( $targetWidth $targetHeight $imgSource )

					#elseif( $imgInFigure )
						#formatFigWithCaptions_DOC( $targetWidth $targetHeight $imgSource $imgAlign $figCapAlign $figCaptionContent )
						
					#else 				
						#formatImgWithOptionForCaptions_DOC( $targetWidth $targetHeight $imgSource $imgAlign $figCapAlign)

					#end 

				#######################################################################################
				## - PDF img and figcaption $replace handling: One of the following macros will 
				##		                  set $replace accordingly with the base64 of that img.
				#######################################################################################
				#elseif( $format == "pdf") 
					
					#if( $find.contains("equation"))
						#formatEquation_PDF( $imgIndex $targetWidth $imageBase64s $imgAlignMargin )
					
					#elseif( $imgInTable ) 
						#formatImgInTable_PDF( $imgIndex $targetWidth $imageBase64s ) 

					#elseif( $imgInFigure )
						#formatFigWithCaptions_PDF( $imgIndex $targetWidth $imageBase64s $imgAlignMargin $figCapAlign $figCaptionContent )
			
					#else 
						#formatImgWithOptionForCaptions_PDF( $imgIndex $targetWidth $imageBase64s $imgAlignMargin $figCapAlign )    

					#end 
				#######################################################################################
				## - Else likely html format, set generic img replacement 
        		#######################################################################################
        		#else 
           		    #set( $replace = "<img src='$imageBase64s.get($foreach.index)' style='height:${targetHeight}pt;width:${targetWidth}pt' />" )
				#end 
			
		        ########################################################################################
		        ## - Now that $replace is set with the proper replacement format, 
		        ##   it is utilized to officially $replace the img in the rich text $output string
		        ########################################################################################
		   		#if( $imgInFigure )
		   			#set( $output = $output.replaceAll( "(<figure.*?>|<div.*?>)(.*\s*?|.*\n*?|.*\t*?)($find.*?)(<figcaption.*?>)(.*?\s*?.*?\s*?)(<\/figcaption>)(.*\s*?|.*\n*?|.*\t*?)(<\/figure>|<\/div>)", "$3"))
		   			#set( $output = $output.replaceAll( $find, $replace))	
				#else
			        #set( $output = $output.replaceAll( $find, $replace ))
			    #end 
			    

        #end ##if( $inputStart > -1 && $inputEnd > -1 )
      #end 	##if( $imgUrls.get($imgIndex).indexOf(";base64") == -1 )
    #end  ##foreach( $imgSource in $imgSources)
  #end ##if( $input.indexOf("<img") > -1 )
  ##------------------------
  ##  Return String        #
  ##------------------------
  $output
#end
##
###################################################################################################################
##                                                                                                               ##
##  DOC Format Image Replace Macros ( Sub macros of #convertFigures )                                            ##
##  #formatEquation_DOC, #formatImgInTable_DOC, #formatFigWithCaptions_DOC, #formatImgWithOptionForCaptions_DOC  ## 
##  Return: $replace                                                                                             ##
##                                                                                                               ## 
###################################################################################################################
##--------------------------##  
##  formatEquation_DOC
##  - formats equation 
##--------------------------##  
#macro( formatEquation_DOC $targetWidth $targetHeight $imgSource $imgAlign)
	#set( $tableWidth = $targetWidth +50)
	#set( $equationRefNum = $equationRefNum +1)

	#set( $replace = "<table align=$imgAlign class='invisibleTableContainsFIGURE' border='0' cellpadding='1' cellspacing='0' style='border-collapse:collapse;borders:none;margin:0;width:${tableWidth};'><tr><td style='margin:0;text-align:right;'><!--[if gte vml 1]><v:shape style='width:${targetWidth}pt;height:${targetHeight}pt;visibility:visible;mso-wrap-style:square'><v:imagedata src='$imgSource' o:title='$imgSource' /></v:shape><![endif]--><span class=MsoCaption>eq. $equationRefNum</span></td></tr></table>")
#end 
#* If creating bookmark for caption, code to utilize:
<div align='$imgAlign' class=MsoCaption style='page-break-inside:avoid;'><!--[if gte vml 1]><v:shape style='width:${targetWidth}pt;height:${targetHeight}pt;visibility:visible;mso-wrap-style:square'><v:imagedata src='$imgSource' o:title='$imgSource' /></v:shape><![endif]--><span style='mso-tab-count:1'><a name='_FIG${$equationRefNum}''>eq.</a><span style='mso-spacerun:yes'></span><!--[if supportFields]><span style='mso-bookmark:_FIG${$equationRefNum}'></span><span style='mso-element:field-begin'></span><span style='mso-bookmark:_FIG${$equationRefNum}'><span style='mso-spacerun:yes'></span>SEQ Equation \* ARABIC <span style='mso-element:field-separator'></span></span><![endif]--><span style='mso-bookmark:_FIG${$equationRefNum}'><span style='mso-no-proof:yes'>$equationRefNum</span></span><!--[if supportFields]><span style='mso-bookmark:_FIG${$equationRefNum}'></span><span style='mso-element:field-end'></span><![endif]--><span style='mso-bookmark:_FIG${$equationRefNum}'></span></span></p></div>
*#
##
##---------------------------------------------## 
##  formatImgInTable_DOC
##  - formats image ready to insert into table 
##---------------------------------------------## 
#macro( formatImgInTable_DOC $targetWidth $targetHeight $imgSource ) 

	#set( $replace = "<!--[if gte vml 1]><v:shape style='width:${targetWidth}pt;height:${targetHeight}pt;visibility:visible;mso-wrap-style:square'><v:imagedata src='$imgSource' o:title='$imgSource' /></v:shape><![endif]-->" )
#end
## 
##---------------------------------------------## 
##  formatFigWithCaptions_DOC
##  - formats figure with figure captions
##---------------------------------------------## 
#macro( formatFigWithCaptions_DOC $targetWidth $targetHeight $imgSource $imgAlign $figCapAlign $figCaptionContent)

	#set( $tableWidth = $targetWidth +1)
	#set( $figureRefNum = $figureRefNum + 1)

  	#set( $replace = "<table align=$imgAlign class='invisibleTableContainsFIGURE' border='0' cellpadding='1' cellspacing='0' style='border-collapse:collapse;borders:none;margin:0'><tr><td style='text-align:center;width:${tableWidth}pt;margin:0;'><!--[if gte vml 1]><v:shape style='width:${targetWidth}pt;height:${targetHeight}pt;visibility:visible;mso-wrap-style:square;margin:0'><v:imagedata src='$imgSource' o:title='$imgSource' /></v:shape><![endif]--><p class=MsoCaption style='margin-top:-10pt;text-align:$figCapAlign;'><a name='_FIG${figureRefNum}'>Figure </a><!--[if supportFields]><span style='mso-bookmark:_FIG${figureRefNum}'></span><span style='mso-element:field-begin'></span><span style='mso-bookmark:_FIG${figureRefNum}'>SEQ Figure \\* ARABIC <span style='mso-element:field-separator'></span></span><![endif]--><span style='mso-bookmark:_FIG${figureRefNum}'><span style='mso-no-proof:yes'>$figureRefNum</span></span><!--[if supportFields]><span style='mso-bookmark:_FIG${figureRefNum}'></span><span style='mso-element:field-end'></span><![endif]--><span style='mso-bookmark:_FIG${figureRefNum}'></span> $figCaptionContent</p></td></tr></table>" )

#end 
##
##---------------------------------------------------------------------------------------------------------------------##
##  formatImgWithOptionForCaptions_DOC
##  1. considering img is not in fig tags w/ figcaptions, option to format img with captions and include in the TOF 
##     - consider another parameter that may store figcaption content whether utilizing the document name, a field, or 
##        extracted rich text content 
##---------------------------------------------------------------------------------------------------------------------##	
#macro( formatImgWithOptionForCaptions_DOC $targetWidth $targetHeight $imgSource $imgAlign $figCapAlign )
#set( $tableWidth = $targetWidth +1)

	#if( $TOF_includeAllFigures )
		
		## Add Figcaptions to All Images and Include in the TOF ##  
		#set( $figureRefNum = $figureRefNum + 1)

	    #set( $replace = "<table align=$imgAlign class='invisibleTableContainsFIGURE' border='0' cellpadding='1' cellspacing='0' style='border-collapse:collapse;borders:none;margin:0'><tr><td style='text-align:center;width:${tableWidth}pt;margin:0'><!--[if gte vml 1]><v:shape style='width:${targetWidth}pt;height:${targetHeight}pt;visibility:visible;mso-wrap-style:square;margin:0'><v:imagedata src='$imgSource' o:title='$imgSource' /></v:shape><![endif]--><p class=MsoCaption style='margin-top:-10pt;text-align:$figCapAlign'><a name='_FIG${figureRefNum}'>Figure </a><!--[if supportFields]><span style='mso-bookmark:_FIG${figureRefNum}'></span><span style='mso-element:field-begin'></span><span style='mso-bookmark:_FIG${figureRefNum}'>SEQ Figure \\* ARABIC <span style='mso-element:field-separator'></span></span><![endif]--><span style='mso-bookmark:_FIG${figureRefNum}'><span style='mso-no-proof:yes'>$figureRefNum</span></span><!--[if supportFields]><span style='mso-bookmark:_FIG${figureRefNum}'></span><span style='mso-element:field-end'></span><![endif]--><span style='mso-bookmark:_FIG${figureRefNum}'></span></p></td></tr></table>" )
	#else

	    ## No Extra Figcaptions No Inclusion in TOF ## 
	    
	    #set( $replace = "<!--[if gte vml 1]><v:shape style='width:${targetWidth}pt;height:${targetHeight}pt;visibility:visible;mso-wrap-style:square'><v:imagedata src='$imgSource' o:title='$imgSource' /></v:shape><![endif]-->" )
	#end 

#end
##
###################################################################################################################
##                                                                                                               ##
##  PDF Format Image Replace Macros ( Sub macros of #convertFigures )                                            ##
##  #formatEquation_PDF, #formatImgInTable_PDF, #formatFigWithCaptions_PDF, #formatImgWithOptionForCaptions_PDF  ## 
##  Return: $replace                                                                                             ##
##                                                                                                               ## 
###################################################################################################################
##--------------------------## 
##  formatEquation_PDF
##  1. formats equation 
##--------------------------## 
#macro( formatEquation_PDF $imgIndex $targetWidth $imageBase64s $imgAlignMargin)

	#set( $equationRefNum = $equationRefNum +1)
	#set( $replace = "<div style='display:block;$imgAlignMargin'><div style='display:inline-block'><figure style='height:auto;width:${targetWidth}pt'><img src='$imageBase64s.get($imgIndex) style='width=${targetWidth} !important;height:auto;object-fit:contain;'/></figure></div><div style='display:inline-block'><p class=MsoCaption style='text-align:left;'>eq. ${equationRefNum}</p></div></div>")
#end 
##
##---------------------------------------------## 
##  formatImgInTable_PDF
##  - formats image ready to insert into table 
##---------------------------------------------## 
#macro( formatImgInTable_PDF $imgIndex $targetWidth $imageBase64s ) 

    #set( $replace = "<img src='$imageBase64s.get($imgIndex)' style='height:auto;width:${targetWidth}pt;object-fit:scale-down;'/>" )

#end 
##
##---------------------------------------------## 
##  formatFigWithCaptions_PDF
##  - formats figure with figure captions
##---------------------------------------------## 
#macro( formatFigWithCaptions_PDF $imgIndex $targetWidth $imageBase64s $imgAlignMargin $figCapAlign $figCaptionContent )    

    #set( $replace = "<figure style='height:auto;width:${targetWidth}pt!important;text-align:$figCapAlign !important;$imgAlignMargin'><img src='$imageBase64s.get($imgIndex) style='width=100% !important;height:auto;object-fit:contain;'/><figcaption style='margin-top:-4pt'>$!figCaptionContent</figcaption></figure>")
#end
##
##---------------------------------------------------------------------------------------------------------------------##
##  formatImgWithOptionForCaptions_PDF
##  1. considering img is not in fig tags w/ figcaptions, option to format img with captions and include in the TOF 
##     - consider another parameter that may store figcaption content whether utilizing the document name, a field, or 
##        extracted rich text content 
##---------------------------------------------------------------------------------------------------------------------##
#macro( formatImgWithOptionForCaptions_PDF $imgIndex $targetWidth $imageBase64s $imgAlignMargin $figCapAlign )

	#if( $TOF_includeAllFigures )

		## Add Figcaptions to All Images and Include in the TOF ##  
		#set( $figureRefNum = $figureRefNum + 1)
		#set( $replace = "<figure style='height:auto;width:${targetWidth}pt;text-align:$figCapAlign !important;$imgAlignMargin'><img src='$imageBase64s.get($imgIndex) style='width=100% !important;height:auto;object-fit:contain;'/><figcaption style='margin-top:-4pt'></figcaption></figure>")

	#else 

		## No Extra Figcaptions No Inclusion in TOF ## 
		#set( $replace = "<figure style='height:auto;width:${targetWidth}pt;text-align:$figCapAlign !important;$imgAlignMargin'><img src='$imageBase64s.get($imgIndex) style='width=100% !important;height:auto;object-fit:contain;'/></figure>")
	#end 
#end 
##
#########################################################################################################################
##
##          START WORK IN PROGRESS
## 
#########################################################################################################################

#########################################################################################################################
##          Macro: Extracts image size from image source, if possible, in case there is no size specified in html     ###
##                      $base64Source - base64 source for the image                                                   ###
##                      $imageSizeReturn - size of image                                                              ###
#########################################################################################################################
#macro( getImageSize $base64Source )
  ## if this a PNG, get the size
  #if( $base64Source.substring(0, 16) == "iVBORw0KGgoAAAAN")
    #set( $base64ImageHeader = $base64Source.substring(16, 32) )
    
    #set( $binaryImageHeader = "")
    #foreach( $i in [0..15] )
      #set( $j = $i + 1 )
      #set( $value = $base64ImageHeader.substring($i, $j) )
      ##$value
      #if( $value == "A" ) #set( $binaryImageHeader = "${binaryImageHeader}000000")
      #elseif( $value == "B" ) #set( $binaryImageHeader = "${binaryImageHeader}000001")
      #elseif( $value == "C" ) #set( $binaryImageHeader = "${binaryImageHeader}000010")
      #elseif( $value == "D" ) #set( $binaryImageHeader = "${binaryImageHeader}000011")
      #elseif( $value == "E" ) #set( $binaryImageHeader = "${binaryImageHeader}000100")
      #elseif( $value == "F" ) #set( $binaryImageHeader = "${binaryImageHeader}000101")
      #elseif( $value == "G" ) #set( $binaryImageHeader = "${binaryImageHeader}000110")
      #elseif( $value == "H" ) #set( $binaryImageHeader = "${binaryImageHeader}000111")
      #elseif( $value == "I" ) #set( $binaryImageHeader = "${binaryImageHeader}001000")
      #elseif( $value == "J" ) #set( $binaryImageHeader = "${binaryImageHeader}001001")
      #elseif( $value == "K" ) #set( $binaryImageHeader = "${binaryImageHeader}001010")
      #elseif( $value == "L" ) #set( $binaryImageHeader = "${binaryImageHeader}001011")
      #elseif( $value == "M" ) #set( $binaryImageHeader = "${binaryImageHeader}001100")
      #elseif( $value == "N" ) #set( $binaryImageHeader = "${binaryImageHeader}001101")
      #elseif( $value == "O" ) #set( $binaryImageHeader = "${binaryImageHeader}001110")
      #elseif( $value == "P" ) #set( $binaryImageHeader = "${binaryImageHeader}001111")
      #elseif( $value == "Q" ) #set( $binaryImageHeader = "${binaryImageHeader}010000")
      #elseif( $value == "R" ) #set( $binaryImageHeader = "${binaryImageHeader}010001")
      #elseif( $value == "S" ) #set( $binaryImageHeader = "${binaryImageHeader}010010")
      #elseif( $value == "T" ) #set( $binaryImageHeader = "${binaryImageHeader}010011")
      #elseif( $value == "U" ) #set( $binaryImageHeader = "${binaryImageHeader}010100")
      #elseif( $value == "V" ) #set( $binaryImageHeader = "${binaryImageHeader}010101")
      #elseif( $value == "W" ) #set( $binaryImageHeader = "${binaryImageHeader}010110")
      #elseif( $value == "X" ) #set( $binaryImageHeader = "${binaryImageHeader}010111")
      #elseif( $value == "Y" ) #set( $binaryImageHeader = "${binaryImageHeader}011000")
      #elseif( $value == "Z" ) #set( $binaryImageHeader = "${binaryImageHeader}011001")
      #elseif( $value == "a" ) #set( $binaryImageHeader = "${binaryImageHeader}011010")
      #elseif( $value == "b" ) #set( $binaryImageHeader = "${binaryImageHeader}011011")
      #elseif( $value == "c" ) #set( $binaryImageHeader = "${binaryImageHeader}011100")
      #elseif( $value == "d" ) #set( $binaryImageHeader = "${binaryImageHeader}011101")
      #elseif( $value == "e" ) #set( $binaryImageHeader = "${binaryImageHeader}011110")
      #elseif( $value == "f" ) #set( $binaryImageHeader = "${binaryImageHeader}011111")
      #elseif( $value == "g" ) #set( $binaryImageHeader = "${binaryImageHeader}100000")
      #elseif( $value == "h" ) #set( $binaryImageHeader = "${binaryImageHeader}100001")
      #elseif( $value == "i" ) #set( $binaryImageHeader = "${binaryImageHeader}100010")
      #elseif( $value == "j" ) #set( $binaryImageHeader = "${binaryImageHeader}100011")
      #elseif( $value == "k" ) #set( $binaryImageHeader = "${binaryImageHeader}100100")
      #elseif( $value == "l" ) #set( $binaryImageHeader = "${binaryImageHeader}100101")
      #elseif( $value == "m" ) #set( $binaryImageHeader = "${binaryImageHeader}100110")
      #elseif( $value == "n" ) #set( $binaryImageHeader = "${binaryImageHeader}100111")
      #elseif( $value == "o" ) #set( $binaryImageHeader = "${binaryImageHeader}101000")
      #elseif( $value == "p" ) #set( $binaryImageHeader = "${binaryImageHeader}101001")
      #elseif( $value == "q" ) #set( $binaryImageHeader = "${binaryImageHeader}101010")
      #elseif( $value == "r" ) #set( $binaryImageHeader = "${binaryImageHeader}101011")
      #elseif( $value == "s" ) #set( $binaryImageHeader = "${binaryImageHeader}101100")
      #elseif( $value == "t" ) #set( $binaryImageHeader = "${binaryImageHeader}101101")
      #elseif( $value == "u" ) #set( $binaryImageHeader = "${binaryImageHeader}101110")
      #elseif( $value == "v" ) #set( $binaryImageHeader = "${binaryImageHeader}101111")
      #elseif( $value == "w" ) #set( $binaryImageHeader = "${binaryImageHeader}110000")
      #elseif( $value == "x" ) #set( $binaryImageHeader = "${binaryImageHeader}110001")
      #elseif( $value == "y" ) #set( $binaryImageHeader = "${binaryImageHeader}110010")
      #elseif( $value == "z" ) #set( $binaryImageHeader = "${binaryImageHeader}110011")
      #elseif( $value == "0" ) #set( $binaryImageHeader = "${binaryImageHeader}110100")
      #elseif( $value == "1" ) #set( $binaryImageHeader = "${binaryImageHeader}110101")
      #elseif( $value == "2" ) #set( $binaryImageHeader = "${binaryImageHeader}110110")
      #elseif( $value == "3" ) #set( $binaryImageHeader = "${binaryImageHeader}110111")
      #elseif( $value == "4" ) #set( $binaryImageHeader = "${binaryImageHeader}111000")
      #elseif( $value == "5" ) #set( $binaryImageHeader = "${binaryImageHeader}111001")
      #elseif( $value == "6" ) #set( $binaryImageHeader = "${binaryImageHeader}111010")
      #elseif( $value == "7" ) #set( $binaryImageHeader = "${binaryImageHeader}111011")
      #elseif( $value == "8" ) #set( $binaryImageHeader = "${binaryImageHeader}111100")
      #elseif( $value == "9" ) #set( $binaryImageHeader = "${binaryImageHeader}111101")
      #elseif( $value == "+" ) #set( $binaryImageHeader = "${binaryImageHeader}111110")
      #elseif( $value == "/" ) #set( $binaryImageHeader = "${binaryImageHeader}111111") #end
    #end
    ##IMAGE HEADER: $binaryImageHeader
    #set( $width = $mathTool.toInteger($binaryImageHeader.substring(32, 33)) * 2147483648 +
                   $mathTool.toInteger($binaryImageHeader.substring(33, 34)) * 1073741824 +
                   $mathTool.toInteger($binaryImageHeader.substring(34, 35)) * 536870912 +
                   $mathTool.toInteger($binaryImageHeader.substring(35, 36)) * 268435456 +
                   $mathTool.toInteger($binaryImageHeader.substring(36, 37)) * 134217728 +
                   $mathTool.toInteger($binaryImageHeader.substring(37, 38)) * 67108864 +
                   $mathTool.toInteger($binaryImageHeader.substring(38, 39)) * 33554432 +
                   $mathTool.toInteger($binaryImageHeader.substring(39, 40)) * 16777216 +
                   $mathTool.toInteger($binaryImageHeader.substring(40, 41)) * 8388608 +
                   $mathTool.toInteger($binaryImageHeader.substring(41, 42)) * 4194304 +
                   $mathTool.toInteger($binaryImageHeader.substring(42, 43)) * 2097152 +
                   $mathTool.toInteger($binaryImageHeader.substring(43, 44)) * 1048576 +
                   $mathTool.toInteger($binaryImageHeader.substring(44, 45)) * 524288 +
                   $mathTool.toInteger($binaryImageHeader.substring(45, 46)) * 262144 +
                   $mathTool.toInteger($binaryImageHeader.substring(46, 47)) * 131072 +
                   $mathTool.toInteger($binaryImageHeader.substring(47, 48)) * 65536 +
                   $mathTool.toInteger($binaryImageHeader.substring(48, 49)) * 32768 +
                   $mathTool.toInteger($binaryImageHeader.substring(49, 50)) * 16384 +
                   $mathTool.toInteger($binaryImageHeader.substring(50, 51)) * 8192 +
                   $mathTool.toInteger($binaryImageHeader.substring(51, 52)) * 4096 +
                   $mathTool.toInteger($binaryImageHeader.substring(52, 53)) * 2048 +
                   $mathTool.toInteger($binaryImageHeader.substring(53, 54)) * 1024 +
                   $mathTool.toInteger($binaryImageHeader.substring(54, 55)) * 512 +
                   $mathTool.toInteger($binaryImageHeader.substring(55, 56)) * 256 +
                   $mathTool.toInteger($binaryImageHeader.substring(56, 57)) * 128 +
                   $mathTool.toInteger($binaryImageHeader.substring(57, 58)) * 64 +
                   $mathTool.toInteger($binaryImageHeader.substring(58, 59)) * 32 +
                   $mathTool.toInteger($binaryImageHeader.substring(59, 60)) * 16 +
                   $mathTool.toInteger($binaryImageHeader.substring(60, 61)) * 8 +
                   $mathTool.toInteger($binaryImageHeader.substring(61, 62)) * 4 +
                   $mathTool.toInteger($binaryImageHeader.substring(62, 63)) * 2 +
                   $mathTool.toInteger($binaryImageHeader.substring(63, 64)) * 1 )
    #set( $height = $mathTool.toInteger($binaryImageHeader.substring(64, 65)) * 2147483648 +
                   $mathTool.toInteger($binaryImageHeader.substring(65, 66)) * 1073741824 +
                   $mathTool.toInteger($binaryImageHeader.substring(66, 67)) * 536870912 +
                   $mathTool.toInteger($binaryImageHeader.substring(67, 68)) * 268435456 +
                   $mathTool.toInteger($binaryImageHeader.substring(68, 69)) * 134217728 +
                   $mathTool.toInteger($binaryImageHeader.substring(69, 70)) * 67108864 +
                   $mathTool.toInteger($binaryImageHeader.substring(70, 71)) * 33554432 +
                   $mathTool.toInteger($binaryImageHeader.substring(71, 72)) * 16777216 +
                   $mathTool.toInteger($binaryImageHeader.substring(72, 73)) * 8388608 +
                   $mathTool.toInteger($binaryImageHeader.substring(73, 74)) * 4194304 +
                   $mathTool.toInteger($binaryImageHeader.substring(74, 75)) * 2097152 +
                   $mathTool.toInteger($binaryImageHeader.substring(75, 76)) * 1048576 +
                   $mathTool.toInteger($binaryImageHeader.substring(76, 77)) * 524288 +
                   $mathTool.toInteger($binaryImageHeader.substring(77, 78)) * 262144 +
                   $mathTool.toInteger($binaryImageHeader.substring(78, 79)) * 131072 +
                   $mathTool.toInteger($binaryImageHeader.substring(79, 80)) * 65536 +
                   $mathTool.toInteger($binaryImageHeader.substring(80, 81)) * 32768 +
                   $mathTool.toInteger($binaryImageHeader.substring(81, 82)) * 16384 +
                   $mathTool.toInteger($binaryImageHeader.substring(82, 83)) * 8192 +
                   $mathTool.toInteger($binaryImageHeader.substring(83, 84)) * 4096 +
                   $mathTool.toInteger($binaryImageHeader.substring(84, 85)) * 2048 +
                   $mathTool.toInteger($binaryImageHeader.substring(85, 86)) * 1024 +
                   $mathTool.toInteger($binaryImageHeader.substring(86, 87)) * 512 +
                   $mathTool.toInteger($binaryImageHeader.substring(87, 88)) * 256 +
                   $mathTool.toInteger($binaryImageHeader.substring(88, 89)) * 128 +
                   $mathTool.toInteger($binaryImageHeader.substring(89, 90)) * 64 +
                   $mathTool.toInteger($binaryImageHeader.substring(90, 91)) * 32 +
                   $mathTool.toInteger($binaryImageHeader.substring(91, 92)) * 16 +
                   $mathTool.toInteger($binaryImageHeader.substring(92, 93)) * 8 +
                   $mathTool.toInteger($binaryImageHeader.substring(93, 94)) * 4 +
                   $mathTool.toInteger($binaryImageHeader.substring(94, 95)) * 2 +
                   $mathTool.toInteger($binaryImageHeader.substring(95, 96)) * 1 )
    #set( $imageSizeReturn = {"width":$width, "height":$height} )
  #else
    #set( $imageSizeReturn = {"width": false, "height": false} )
  #end
#end
#########################################################################################################################
##                     Macro: Embeds attached images as base64                                                        ###
##                      $jamaUrl - Url of an attached image in Jama                                                   ###
##                      $returnSource - Replacement source ID for the now embedded image                              ###
##                      $returnBase64Image - Base64 encoded image 
#########################################################################################################################
#macro( embedImage $jamaUrl )      
  #set( $returnSource = false )
  ## Define a figure array if none exists (first image in the doc)
  #if( !$figure ) #set( $figure = [] ) #end
  ## Define a files array if none exists (first image in the doc)
  #if( !$files ) #set( $files = [] ) #end

  #if( $jamaUrl )
    ## Get attachment ID and file extension
    #set( $srcEnd = $jamaUrl.indexOf("attachment/"))
    #if ( $srcEnd < 0 )
      #set( $srcEnd = $jamaUrl.indexOf("diagram/"))
      #set( $attStart = $srcEnd + 8)
    #else
      #set( $attStart = $srcEnd + 11)
    #end
    #set( $attEnd = $jamaUrl.indexOf( "/", $attStart))
    #set( $attachmentId = $jamaUrl.substring( $attStart, $attEnd))
    #set( $fileExtStart = $jamaUrl.indexOf( ".", $attEnd))
    #set( $fileExtStart = $fileExtStart + 1)
    #set( $fileExt = $jamaUrl.substring( $fileExtStart, $s.length()))
    ## Create new file name, File List Entry and Embedded file
    #set( $f = "JAMA_IMG_")
    #set( $f = $f.concat($attachmentId))
    #set( $f = $f.concat("."))
    #set( $f = $f.concat($fileExt))
    #set( $file = '<o:File HRef="')
    #set( $file = $file.concat( $f))
    #set( $file = $file.concat('"/>'))
    #if( $files.add( $file)) #end
    #set( $jama_cid = $f)
    #set( $newSourceLink = "cid:")
    #set( $newSourceLink = $newSourceLink.concat( $jama_cid))
    #if( $figure.add( $boundaryString)) #end
    #set( $img_jama_cid = "Content-ID: ")
    #set( $img_jama_cid = $img_jama_cid.concat( $jama_cid))
    #if( $figure.add( $img_jama_cid)) #end
    #if( $figure.add( "Content-Transfer-Encoding: base64 ")) #end
    #set( $contentType =  "Content-Type: image/")
    #set( $contentType = $contentType.concat($fileExt))
    #if( $figure.add( $contentType)) #end
    #if( $figure.add( "")) #end
    #set( $base64Fig = $attachmentService.getBase64Image( $mathTool.toInteger( $attachmentId)))
    #if( $figure.add( $base64Fig)) #end
    #if( $figure.add( "")) #end
    #set( $imageData = "data:image/" )
    #set( $imageData = $imageData.concat($fileExt) )
    #set( $imageData = $imageData.concat(";base64, ") )
    #set( $imageData = $imageData.concat($base64Fig) )
##
    ## Return Values
    #set( $returnSource = $newSourceLink )
    #set( $returnBase64Image = $base64Fig )
  #end
#end
#########################################################################################################################
##                          Macro: Resizes images larger than maximum                                               
##                           $inHeight - starting height of image
##                           $inWidth - starting width of image
##                           $maxHeight - maximum allowed height of image
##                           $maxWidth - maximum allowed width of image
##                           $returnHeight - resized height
##                           $returnWidth - resized width                                     
#########################################################################################################################
#macro( resizeImage $inHeight $inWidth $maxHeight $maxWidth )
  #if( $inHeight && $inWidth && $maxHeight && $maxWidth )
    #set( $widthInt = $mathTool.toNumber($inWidth) )
    #set( $heightInt = $mathTool.toNumber($inHeight) )
    #### Debug: $widthInt x $heightInt
##
    #set ($aspectRatio = 1.5)
    #set ($aspectRatio = $mathTool.toDouble($widthInt) / $mathTool.toDouble($heightInt))
    #### Debug Aspect Ratio: $aspectRatio
##
    ## if the image is a formula created by Wiris and less than the max width, reduce the size to 75%
    #if( $input.indexOf("Wirisformula") > -1 && $widthInt <= $maxWidth )
      #set( $returnWidth = $mathTool.mul($widthInt, 0.75) )
      #set( $returnHeight = $mathTool.div($mathTool.toNumber($returnWidth), $aspectRatio) )
##
    ## if the image is higher than allowed, resize
    #elseif( $heightInt > $maxHeight )
      #set ($returnHeight = $maxHeight)
      #set ($returnWidth = $mathTool.mul($mathTool.toNumber($returnHeight), $aspectRatio))
##
      ## if the image is still wider than allowed, resize again
      #if( $returnWidth > $maxWidth )
        #set ($returnWidth = $maxWidth)
        #set ($returnHeight = $mathTool.div($mathTool.toNumber($returnWidth), $aspectRatio))
      #end
##
    ## if the image is wider than allowed, resize
    #elseif( $widthInt > $maxWidth )
      #set ($returnWidth = $maxWidth)
      #set ($returnHeight = $mathTool.div($mathTool.toNumber($returnWidth), $aspectRatio))
##
      ## if the image is still higher than allowed, resize again
      #if( $returnHeight > $maxHeight )
        #set ($returnHeight = $maxHeight)
        #set ($returnWidth = $mathTool.mul($mathTool.toNumber($returnHeight), $aspectRatio))
      #end
    #else
      #set ($returnWidth = $widthInt)
      #set ($returnHeight = $heightInt)
    #end
  #else
    #set ($returnWidth = false )
    #set ($returnHeight = false )
  #end
#end


#########################################################################################################################
##          Macro: convertEquals
##          Input: $inString - input string
##          Return: string, ready for opening in Word
#########################################################################################################################
#macro( convertEquals $inString )
#set( $string = $inString )
#set( $string = $string.replaceAll("=", "=3D"))
$string
#end
#########################################################################################################################
##          Macro: formatText
##          Input: $inString - input string
##          Return: string, ready for opening in Word
#########################################################################################################################
#macro( formatText $inString )
#set( $string = $inString )
## Remove divs for pdf so that there are no unexpected formatting containers
#set( $string = $string.replaceAll("<div.*?>|<\/div>", ""))
### COMMENTED OUT FOR FORMAT TESTING ## 
## clear all span satements to remove character formatting
#set( $string = $string.replaceAll("<span.*?>",""))
#set( $string = $string.replaceAll("<\/span>",""))
## clear all embedded headings from rich text fields
##set( $string = $string.replaceAll("<h\d*?.*?>","<p><strong>"))
##set( $string = $string.replaceAll("<\/h\d*?>","</strong></p>"))
## remove any empty image strings
#set( $string = $string.replaceAll("<img alt=[\x27\x22][\x27\x22] />", ""))
#set( $string = $string.replaceAll("<img \/>",""))
## replace Micro aka Legacy Symbol to prevent overlapping characters, issue with pdf
#set( $string = $string.replaceAll("sec", "&mu;sec"))
#if( $format == 'pdf')
#set( $string = $string.replaceAll("", "&#9744;"))
#end 
$string
#end
#########################################################################################################################
##          Macro: formatTables
##          Input: $inString - input string
##                 $maxWidth - number: maximum allowed width(pts) of tables, resize if greater 
##                 $tableAlign - left, right, center alignment of table              
##          Return: string, ready for opening in Word
#########################################################################################################################
#macro( formatTables $inString $maxWidth $tableAlign)
##
  #if( $inString.contains("<table") )
    ## Clear variables used in the macro
    #set( $output = "" ) ##
    #set( $table = false ) ##
    #set( $tableHeader = false ) ##
    #set( $tableCell = false ) ##
    #set( $tableCellParagraph = false ) ##
##
    ## For tables, each tag that makes up the table needs to be independently processed, so split the description into
    ## an array where each each value in the array is a single tag of the HTML, split on '>'
    ## $sub = array of individual tags in the description
    #set ( $subs = $inString.split(">"))##
##
    ## Iterate on each substring
    #foreach ($sub in $subs) ##
      ## append > to each sub except the last one since the split cut it off
      #if( !$foreach.last) #set( $sub = "${sub}>") #end ##
##
      ## Determine where in a table we are
      #if( $sub.contains("<table") ) 
        #set( $table = true )  
        #set( $ogTableWidthPt = false ) ## clear value since this table is new 
        #set( $newTableWidthPt = false ) ## clear value since this table is new 
        #set( $tableScaleFactor = false ) ## clear value since this table is new 
      #end ##
      #if( $sub.contains("<thead") ) #set( $tableHeader = true )  #end ##
      #if( $sub.contains("<td") || $sub.contains("<th") ) #set( $tableCell = true )  #end ##
      #if( $sub.contains("<p") || $sub.contains("<li") ) #set( $tableCellParagraph = true )  #end ##
##
      ###########################################################################
      ## - make sure all table cells include a paragraph with an appropriate class
      ###########################################################################
     #if( $table && !$tableHeader && $tableCell)
        #set($sub = $sub.replaceAll('<p(.*)','<p class=TableCell$1')) ##
        #set( $sub = $sub.replaceAll('<li(.*?)>','<li class=TableCell$1>'))
      #end


      #if($table && $tableHeader && $tableCell)
        #set($sub = $sub.replaceAll('<p(.*)','<p class=TableHeader$1')) ##
        #set( $sub = $sub.replaceAll('<li(.*?)>','<li class=TableHeader$1>'))
      #end

      ## cells with no formatting
      #if( $sub.contains("<td") &&
            !$subs[$nextSubIndex].contains("<p") && 
            !$subs[$nextSubIndex].contains("<li") )
        #set( $sub = "$sub<p class=TableCell>")
      #end

      #if( $sub.contains("<th") && ($docName != "Inspection Plan" && $docName != "Release History") &&
            !$subs[$nextSubIndex].contains("<p") && 
            !$subs[$nextSubIndex].contains("<li") )
        #set( $sub = "$sub<p class=TableHeader>")
      #end
      #if( ($sub.contains("</td") || $sub.contains("</th")) &&
            !$subs[$prevSubIndex].contains("</p") && 
            !$subs[$prevSubIndex].contains("</li") )
        #set( $end = $sub.indexOf("</t") )
        #set( $contents = $sub.substring(0, $end) ) ##
        #set( $endTag = $sub.substring($end, $sub.length()) )
        #set( $sub = "$contents</p>$endTag")
      #end
      ###########################################################################
##
      ###########################################################################
      ## - make sure all tables have the borders collapsed
      ###########################################################################
      #if( $sub.contains("<table") && !$sub.contains("border-collapse") )
          #if( $sub.contains("style") )
            #set( $sub = $sub.replaceAll("(<table)(.*?style=[\x27\x22])(.*?)([\x27\x22].*?>)","$1$2$3;border-collapse:collapse$4") )
          #else
            #set( $sub = $sub.replaceAll("(<table)(.*?)(>)","$1$2 style='border-collapse:collapse'$3") )
          #end
      #end

      ###########################################################################  
      ## - make if the table has a border definition that the border attribute 
      ##   is placed to ensure the outer border box is created
      ###########################################################################
      #set( $tableInlineStyle = $sub.replaceAll("(<table)(.*?style=[\x27\x22])(.*?)([\x27\x22].*?>)","$3") )

      #if($tableInlineStyle.contains("border:"))  ## Ensure the outside border is created if the table has a border style definition 
        #set( $sub = $sub.replaceAll("(<table)(.*?style=[\x27\x22])(.*?)([\x27\x22].*?>)","$1 border='1' $2$3$4") )
      #end

      ###########################################################################
##
      ###########################################################################
      ## - add header background color
      ###########################################################################
      #if( ($tableHeader && $sub.contains("<td")) || $sub.matches("(?s).*<th[^e].*") )
         
        ## If user has table header color set then use that color
        #set($tableHeaderColor = $sub.replaceAll('background-color:(.*?)[;|"]|[^*]', "$1"))
         
        #if($tableHeaderColor != '' || $!tableHeaderColor)
          #set($tableHeaderBackgroundColor = $tableHeaderColor.trim())
        #end

        ## Remove old background color from style attribute with multiple CSS or where Background-Color is the only
        ##  style attribute.
        #set($sub = $sub.replaceAll("background-color:.*?;", ""))
        #set($sub = $sub.replaceAll("style='background-color:.*?'", ""))
        #set($sub = $sub.replaceAll('style="background-color:.*?"', ""))
        #set($sub = $sub.replaceAll('style=""|style=" "', ""))
        #set($sub = $sub.replaceAll("style=''|style=' '", ""))

        ## Preserve already assigned cell color if already set to prevent double inline style setting.
        #if( $sub.contains("style") && !$sub.contains("background-color"))
          #if( $sub.contains("style") )
            #set( $replace = "$1$2;background-color:$tableHeaderBackgroundColor$3" )
            #set( $sub = $sub.replaceAll("(<t.*?style=[\x27\x22])(.*?)([\x27\x22].*?>)",$replace) )
          #else
            #set( $replace = "$1 style='background-color:$tableHeaderBackgroundColor'$2" )
            #set( $sub = $sub.replaceAll("(<t.*?)(>)",$replace) )
          #end
        #end
      #end
      ###########################################################################
##
      ###########################################################################
      ## - add border color
      ###########################################################################
      #*
      #if( $sub.contains("<table") )
          #if( $sub.contains("style") )
            #set( $sub = $sub.replaceAll("(<table)(.*?style=[\x27\x22])(.*?)([\x27\x22].*?>)","$1$2$3;border: 0.5pt solid $tableBorderColor$4") )
          #else
            #set( $sub = $sub.replaceAll("(<table)(.*?)(>)","$1$2 style='border: 0.5pt solid $tableBorderColor'$3") )
          #end
      #end
      *#
      #if( $sub.contains("<td") || $sub.matches("(?s).*<th[^e].*") )
        #if( $sub.contains("style") )
          #set( $replace = "$1$2;border-color: $tableBorderColor$3" )
          #set( $sub = $sub.replaceAll("(<t.*?style=[\x27\x22])(.*?)([\x27\x22].*?>)",$replace) )
        #else
          #set( $replace = "$1 style='border-color: $tableBorderColor'$2" )
          #set( $sub = $sub.replaceAll("(<t.*?)(>)",$replace) )
        #end
      #end
      ###########################################################################
##
      ###########################################################################
      ## - resize table widths to fit the page and use only point-based widths
      ###########################################################################
     #if( $sub.contains("<table") )
        ## Try finding a width
        #set( $tableWidth = $sub.replaceAll("(?s).*[\x22\x27; ]width.*?:.*?(\d*.*?)[;\x27\x22].*","$1") )
        ## there is no width already, see if the cells can be added up to calculate a width
        #if( $tableWidth == $sub)
          #set( $calcTableWidth = 0 )
          #set( $rowWidth = 0)
          #set( $start = $foreach.index )
          #set( $end = $subs.size() - 1 )
          ## Iterate through each sub between the current position and the end of the table
          #foreach( $i in [$start..$end] )
            #set( $iSub = $subs.get($i) )
            #if( $iSub.contains("<td") )
              #set( $cellWidth = $iSub.replaceAll("(?s).*[\x22\x27; ]width\s*:\s*(\d*.*?)[;\x27\x22].*","$1") )
              ## cell width found
              #if( $cellWidth != $iSub)
                ## width in pt
                #if( $cellWidth.contains("pt") ) ##
                  #set( $cellWidth = $mathTool.toDouble($cellWidth.substring(0,$cellWidth.indexOf("pt"))) ) ##
                ## width in px
                #elseif( $cellWidth.contains("px") ) ##
                  #set( $cellWidth = $mathTool.toDouble($cellWidth.substring(0,$cellWidth.indexOf("px"))) ) ## Extract number part
                  #set( $cellWidth = $cellWidth * 0.75 ) ## Convert px to pt
                ## width in % or other.  Essentially ignoring
                #else
                  #set( $cellWidth = 0 )
                #end
              ## no cell width found
              #else
                #set( $cellWidth = 0 )
              #end
              #set( $rowWidth = $rowWidth + $cellWidth )
            #end
            ## calculate width for each row and take the widest one
            #if( $iSub.contains("</tr") )
              #if( $rowWidth > $calcTableWidth )
                #set( $calcTableWidth = $rowWidth )
              #end
              #set( $rowWidth = 0)
            #end
            ## stop once the end of the table is reached in case there are mutliple tables
            #if( $iSub.contains("</table>") )
              #break
            #end
          #end
##
          ## Save table width in pt for cell processing 
          #set( $ogTableWidthPt = $calcTableWidth ) 
          #set( $newTableWidthPt = $calcTableWidth ) 
          #set( $newTableWidthPerc = 0 )
##        
          ## Resize all tables greater than 100% to 100% || Resize all tables less than 1% to 100%
          #if( $ogTableWidthPt > $maxWidth ||  $ogTableWidthPt < 1 )
             #set( $newTableWidthPerc = 100 )
          #end
    
          ## Calculate resize factor for use later
          ## Debug New Table Width (Calc): $newTableWidthPt
          #set( $tableScaleFactor = $newTableWidthPt / $ogTableWidthPt )
          ## Debug Scale Factor (Calc): $tableScaleFactor

          #if( $newTableWidthPerc == 0)
          	#set( $widthCalculation = $newTableWidthPt / $maxWidth)
	      	#set( $newTableWidthPerc = $mathTool.round( $widthCalculation * 100 ))
          #end
          ###NEW Table Width Perc $newTableWidthPerc <br>
          ## add a table width to the table
            #if( $sub.contains("style") )
                #set( $sub = $sub.replaceAll("(<table)(.*?style=[\x27\x22])(.*?)([\x27\x22].*?>)","$1$2$3;width:${newTableWidthPerc}% !important;$4") )
            #else
                #set( $sub = $sub.replaceAll("(<table)(.*?)(>)","$1$2 style='width:${newTableWidthPerc}% !important!'$3") )
            #end
      
        ## There is a width, convert it to a point-based width equal or less than maxWidth
        #else
          ## widths in pt
          #if( $tableWidth.contains("pt") ) ##
            #set( $tableWidth = $mathTool.toDouble($tableWidth.substring(0,$tableWidth.indexOf("pt"))) ) ##
            ##<p>DEBUG FOUND TABLE WIDTH (pt) 1: $tableWidth</p>
            #set( $ogTableWidthPt = $tableWidth ) ## Save table width in pt for cell processing 
            ##<p>DEBUG FOUND TABLE WIDTH (pt) 2: $tableWidth</p>
          ## widths in px
          #elseif( $tableWidth.contains("px") ) ##
            #set( $tableWidth = $mathTool.toDouble($tableWidth.substring(0,$tableWidth.indexOf("px"))) ) ## Extract number part
            ##<p>DEBUG FOUND TABLE WIDTH (px) 1: $tableWidth</p>
            #set( $tableWidth = $tableWidth * 0.75 ) ## Convert px to pt
            #set( $ogTableWidthPt = $tableWidth ) ## Save table width in pt for cell processing 
            ##<p>DEBUG FOUND TABLE WIDTH (px) 2: $tableWidth</p>
          ## widths in %
          #elseif( $tableWidth.contains("%") ) ##
            #set( $tableWidth = $mathTool.toDouble($tableWidth.substring(0,$tableWidth.indexOf("%"))) ) ##
            #set( $ogTableWidthPt = $maxWidth * ($tableWidth/100) ) ## Save table width in pt for cell processing
            ##<p>DEBUG FOUND TABLE WIDTH (%) 1: $tableWidth</p>
          ## unknown width, force to 100%
          #else
            #set( $ogTableWidthPt = $maxWidth ) ## Save table width in pt for cell processing
          #end
          ##<p>DEBUG FOUND TABLE WIDTH 3: $tableWidth</p>
          #set( $newTableWidthPt = $ogTableWidthPt )
          ## Resize all tables greater than 100% to 100%
          #if( $ogTableWidthPt > $maxWidth )
            #set( $newTableWidthPt = $maxWidth )
          #end
          ##<p>DEBUG FOUND TABLE WIDTH 4: $tableWidth</p>
          ## Calculate resize factor for use later
          ## Debug New Table Width: $newTableWidthPt
          #set( $tableScaleFactor = $newTableWidthPt / $ogTableWidthPt )
          ##<p>Debug Scale Factor: $tableScaleFactor = $newTableWidthPt divided by $ogTableWidthPt</p>
##
          ## replace width with new value
          #if( $newTableWidthPt ) ## size both pdf and word tables as percentages in relation to page 
	          #set( $widthCalculation = $newTableWidthPt / $maxWidth)
	          #set( $newTableWidthPerc = $mathTool.round( $widthCalculation * 100 ))
	          #if( $newTableWidthPerc > 100 )
	            #set( $newTableWidthPerc = 100 )
	          #end 
	          #set( $find = "(?s)(.*[\x22\x27;* ]width.*?:.*?)(\d*.*?)([;\x27\x22].*)")
	          #set( $replace = "$1${newTableWidthPerc}% !important$3" )
	          #set( $sub = $sub.replaceAll($find, $replace) )
          #end
        #end
      #end ##if( $sub.contains("<table") )
      ###########################################################################
##
      ###########################################################################
      ## - resize cell widths to use only point-based widths
      ## - requires the following values from the table width sizing
      ##   $newTableWidthPt
      ##   $tableScaleFactor
      ###########################################################################
      #if( $sub.contains("<td") || $sub.matches("(?s).*<th[^e].*"))
        #set( $cellWidth = $sub.replaceAll("(?s).*[\x22\x27; ]width\s*:\s*(\d*.*?)[;\x27\x22].*","$1") )
        ##<p>DEBUG cell width: |$cellWidth|</p>
        ##<p>DEBUG table scale: |$tableScaleFactor|</p>
        ## if there is a width, convert to % and scale with table resizing
        #if( $cellWidth != $sub)
          ## widths in pt
          #if( $cellWidth.contains("pt") ) ##
            #if( $tableScaleFactor && $newTableWidthPt)
              #set( $cellWidth = $mathTool.toDouble($cellWidth.substring(0,$cellWidth.indexOf("pt"))) ) ##
              ## Debug Start Width (pt): $cellWidth
              ## Debug Scale Factor: $tableScaleFactor
              #set( $cellWidthPt = $cellWidth * $tableScaleFactor ) ## Scale cell proportial to table
              ## Debug scaled Width (pt): $cellWidth
            #end
          ## widths in px
          #elseif( $cellWidth.contains("px") ) ##
            #if( $tableScaleFactor && $newTableWidthPt)
              #set( $cellWidth = $mathTool.toDouble($cellWidth.substring(0,$cellWidth.indexOf("px"))) ) ## Extract number part
              #set( $cellWidth = $cellWidth * 0.75 ) ## Convert px to pt
              #set( $cellWidthPt = $cellWidth * $tableScaleFactor ) ## Scale cell proportial to table
              ##<p>Debug scaled Width (%): $cellWidth</p>
            #end
          ## widths in %
          #elseif( $cellWidth.contains("%") ) ##
            #set( $cellWidth = $mathTool.toDouble($cellWidth.substring(0,$cellWidth.indexOf("%"))) ) ##
            #if( $newTableWidthPt )
              #if( $newTableWidthPt == 0)
                #set( $newTableWidthPt = $newTableWidthPerc)
              #end
              #set( $cellWidthPt = ($cellWidth/100) * $newTableWidthPt ) ## Convert % to pt
            #else
              #set( $cellWidthPt = ($cellWidth/100) * $maxWidth )
            #end
          #else
            ## Ignoring widths uzing unknown units
          #end
          ## replace width with new value
          #if( $cellWidthPt ) ## size both pdf and word tables as percentages in relation to page 
              #set( $cellWidthPt = $cellWidthPt - 4 ) ## account for cell padding
              #set( $widthCalculation = $cellWidthPt / $newTableWidthPt )
              #set( $cellWidthPerc = $mathTool.round($widthCalculation * 100 ))    
              #set( $find = "(?s)(.*[\x22\x27; ]width.*?:.*?)(\d*.*?)([;\x27\x22].*)")
              #set( $replace = "$1${cellWidthPerc}% !important$3" )
              #set( $sub = $sub.replaceAll($find, $replace) )
          #else
            #set( $cellWidthPt = false )
          #end
        #end
      #end
      ###########################################################################
      ## - resize any images in the table
      ###########################################################################
      #if( $tableCell && $sub.contains("<v:shape") )
        ## Width
        #set( $start = $mathTool.toNumber($sub.indexOf("width")) + 6 )
        #set( $end = $mathTool.toNumber($sub.indexOf("pt",$start)) )
        #if($start != -1 && $end != -1)
          #set( $width = $mathTool.toDouble($sub.substring($start,$end)) )
        #else
          #set($width =$mathTool.toDouble("180")) ## else default set to 2.5 inches 
        #end
        ## Height
        #set( $start = $mathTool.toNumber($sub.indexOf("height")) + 7 )
        #set( $end = $mathTool.toNumber($sub.indexOf("pt",$start)) )
        #if($start != -1 && $end != -1)
          #set( $height = $mathTool.toDouble($sub.substring($start,$end)) )
        #else
           #set($height = $mathTool.toDouble("180")) ## else default set to 2.5 inches 
        #end

        #set( $aspectRatio = $height / $width )
        ##<p>DEUBG cell width: $cellWidthPt</p>
        ##<p>DEUBG img width: $width</p>

        #if( $cellWidthPt )
          #if( $width > ($cellWidthPt - 8) )
            #set( $width = $cellWidthPt - 8 )
            #set( $height = $width * $aspectRatio )
            #set( $replace = "width:${width}pt" )
            #set( $sub = $sub.replaceAll("width:([\d\.]*?)pt",$replace) )
            #set( $replace = "height:${height}pt" )
            #set( $sub = $sub.replaceAll("height:([\d\.]*?)pt",$replace) )
          #end
        #end
      #end
      ###########################################################################
      ## - align table per $tableAlign, find unique alignments coming from Jama 
      ##   and preserve them. If a unique alignment is not found the parameter 
      ##   value of $tableAlign is preserved. 
      ## - DOC alignments can be removed from the table and set to a parent div.
      ## - PDF alignments also must be removed from the table and set via margins 
      ###########################################################################
    
        #if( $sub.contains("<table") && $sub.contains("align") )
        	#set( $isAlignTable = $sub )
        	#set( $isAlignTable= $isAlignTable.replaceAll("\n|\t", ""))
            #set( $isAlignTable = $isAlignTable.replaceAll("[^*]*?align=([\x27\x22].*?[\x27\x22]|\w*)(?:.*)", "$1") )
            #set( $isAlignTable = $isAlignTable.replaceAll("\x27|\x22", ""))
            #set( $isAlignTable = $isAlignTable.trim())
            #if( $isAlignTable == "center" || $isAlignTable == "right" || $isAlignTable == "left" )
            	#set( $tableAlign = $isAlignTable)
            #end 
        #end 
        #set( $sub = $sub.replaceAll("(margin-left|margin-right|margin):.*?([\x27\x22])", "$2") )
    
        #if( $sub.contains("<table") )
        	#if( $format == 'doc')
				#set( $sub = $sub.replaceAll("align=([\x27\x22].*?[\x27\x22]|\w*)", "") )
				#set( $sub = $sub.replaceAll("<table", "<div align=$tableAlign><table"))
			
			#elseif( $format == 'pdf')
				#if( $tableAlign == "left")
					## Default alignment is left so take left alignment off to stop float left
					#set( $sub = $sub.replaceAll("align=([\x27\x22].*?[\x27\x22]|\w*)", "") )
				#elseif( $tableAlign == "center")
					#set( $sub = $sub.replaceAll("align=([\x27\x22].*?[\x27\x22]|\w*)", "") )
					#if( $sub.contains("style"))
						#set( $sub = $sub.replaceAll("(<table)(.*?style=[\x27\x22])(.*?)([\x27\x22].*?>)","$1$2$3;margin:auto;$4"))
					#else 
						#set( $sub = $sub.replaceAll("(<table)","$1 style='margin:auto'"))
					#end 
				#elseif( $tableAlign == "right")
					#set( $sub = $sub.replaceAll("align=([\x27\x22].*?[\x27\x22]|\w*)", "") )
					#if( $sub.contains("style"))
						#set( $sub = $sub.replaceAll("(<table)(.*?style=[\x27\x22])(.*?)([\x27\x22].*?>)","$1$2$3;margin-left:auto;margin-right:0pt;$4"))
					#else 
						#set( $sub = $sub.replaceAll("(<table)","$1 style='margin-left:auto;margin-right:0pt;'"))
					#end 
				#end 	
			#end 
        #end 

        #if( $sub.contains("</table") && $format == 'doc')
          #set( $sub = "$sub</div>")  
        #end 
    
 		#if( $format == 'pdf')
 			#set( $sub = $sub.replaceAll("writing-mode:tb-rl",""))
        #end
 		
		#if( $sub.contains("<td") || $sub.contains("<th") )
    	  #set( $sub = $sub.replaceAll("padding.*?([;\x27\x22])", "$1") )
    	#end 
    	## Handle text content alignment for vertical text on tables
    	#if($sub.contains("transform:rotate(180deg);"))
        	#set( $sub = $sub.replaceAll("transform:rotate\(180deg\);","mso-rotate:90;") )
      	#end 
           
   
      ###########################################################################
      ## add the processed sub to the output string
      #set ( $output = "${output}${sub}" ) ##
      ## Determine where in a table we are
      #if( $sub.contains("</p") || $sub.contains("</li") ) #set( $tableCellParagraph = false )  #end ##
      #if( $sub.contains("</thead") ) #set( $tableHeader = false ) #end ##
      #if( $sub.contains("</td") || $sub.contains("</th") ) #set( $tableCell = false ) #end ##
      #if( $sub.contains("</table") ) #set( $table = false ) #end ##
    #end ##foreach ($sub in $subs)
  #else ##
    #set ( $output = $inString )
  #end ##if( $inString.contains("<table") )

  #######################################################################################
  ## - Word caption handling by extracting caption and creating a new single cell table on top
  ## - This allows preservation of the caption alignment and prevents word from applying
  ## - Heading formatting to the caption as it does when caption is still present on 
  ## - original table as the first table row.
  ##   #buildTableCaptions_DOC will add captions to tables that do not have them
  ##   if $TOT_includeAllTables is true so that they can be included in the TOT
  #######################################################################################
  #######################################################################################
  ## - PDF captions are automatically found by the template and do not need to be reformatted
  ##  #buildTableCaptions_PDF will add captions to tables that do not have them
  ##   if $TOT_includeAllTables is true so that they can be included in the TOT
  #######################################################################################
  
  
    ## check each table for table captions and format accordingly,format pdf tables with fixed column widths 
	#if($output.contains("</table>"))
	  	#if( $format == 'pdf') 
	  		#buildTableCaptions_PDF( $output $tableAlign) 
	  		#fixedColumnWidths( $output ) ## Ensure fixed column widths 	
	  	#else 
	  		#buildTableCaptions_DOC( $output )
	  	#end 
	#end	 
	$output 	 

#end 
##
##
#########################################################################################################################
##  DOC                                                                                                                ## 
##  #buildTableCaptions_DOC                                                                                            ##
##  1. For each table found check if it has a caption                                                                  ##
##  2. If caption utilize the caption content and construct caption for Word                                           ##
##  3. Else considering a table does not have captions, option to format table with captions and include in the TOT    ## 
##     - consider another parameter that may store caption content whether utilizing the document name, a field, or    ##
##        extracted rich text content                                                                                  ## 
#########################################################################################################################
#macro( buildTableCaptions_DOC $output )
#set( $tempInString = "")
#set( $caption = "")
#set( $output = $output.replaceAll("<table", "<table[TABLE]"))
#set( $splitList = $output.split("<table"))
##
	#foreach ($splitItem in $splitList)
	    #if( $splitItem.contains("[TABLE]"))
		    ## Replace the placeholder with the <table tag that was removed in split
		    #set( $splitItem = $splitItem.replaceAll("\[TABLE\]", "<table"))
		    ## Extract table width

		    #if( !$splitItem.contains("invisibleTableContainsFIGURE"))
			    #set( $tableWidth = '')
			    #set( $tableWidth = $splitItem.replaceAll("<table.*width.*?:.*?(\d*.*?)[;\x27\x22].*|[\w|\W]","$1") )

			    #set( $captionContent = "")
			    #if( $splitItem.contains("</caption>"))
			      #set( $tableRefNum = $tableRefNum + 1) 
			      ## Extract Caption Content

			      #set( $captionContent = $splitItem.replaceAll("(<caption.*\s*.*\s*<\/caption>)|[\w|\W]", "$1"))
			      #set( $captionContent = $captionContent.replaceAll("<\/caption>", ""))
			      #set( $getAlign = $captionContent.replaceAll("<caption(.*?)>", "$1"))
			      #set( $captionContent = $captionContent.replaceAll("<caption.*?>", ""))
		          
		          #set( $captionAlign = '')
		          #set( $captionAlign = $getAlign.replaceAll("[^*]*?text-align:(\w*).*(?:.*)", "$1"))


		          #set( $captionContent = $captionContent.replaceAll("<\/p>", ""))
		          #set( $captionContent = $captionContent.replaceAll("<p.*?>", ""))

		          #if( $!captionContent && $captionContent != '')
		            #if( $captionAlign != '')
			          #set($caption = "<table border='0' cellpadding='1' cellspacing='0' style='border-collapse:collapse;borders:none;width:$tableWidth'><tr><td style='width:$tableWidth'><p class=MsoNormal style='text-align:$captionAlign;font-size:10pt;font-family:'Helvetica',sans-serif;font-weight:bold'><p class=MsoCaption style='text-align:$captionAlign !important;margin-top:6pt;page-break-after:avoid'><a name='_TBL${tableRefNum}'>Table </a><!--[if supportFields]><span style='mso-bookmark:_TBL${tableRefNum}'></span><span style='mso-element:field-begin'></span><span style='mso-bookmark:_TBL${tableRefNum}'>SEQ Table \\* ARABIC <span style='mso-element:field-separator'></span></span><![endif]--><span style='mso-bookmark:_TBL${tableRefNum}'><span style='mso-no-proof:yes'>$tableRefNum</span></span><!--[if supportFields]><span style='mso-bookmark:_TBL${tableRefNum}'></span><span style='mso-element:field-end'></span><![endif]--><span style='mso-bookmark:_TBL${tableRefNum}'></span> $!captionContent</p></td></tr></table>" )
			        #else
			          #set($caption = "<table border='0' cellpadding='1' cellspacing='0' style='border-collapse:collapse;borders:none;width:$tableWidth'><tr><td style='width:$tableWidth'><p class=MsoNormal style='text-align:$tableAlign;font-size:10pt;font-family:'Helvetica',sans-serif;font-weight:bold'><p class=MsoCaption style='text-align:$tableAlign;margin-top:6pt;page-break-after:avoid'><a name='_TBL${tableRefNum}'>Table </a><!--[if supportFields]><span style='mso-bookmark:_TBL${tableRefNum}'></span><span style='mso-element:field-begin'></span><span style='mso-bookmark:_TBL${tableRefNum}'>SEQ Table \\* ARABIC <span style='mso-element:field-separator'></span></span><![endif]--><span style='mso-bookmark:_TBL${tableRefNum}'><span style='mso-no-proof:yes'>$tableRefNum</span></span><!--[if supportFields]><span style='mso-bookmark:_TBL${tableRefNum}'></span><span style='mso-element:field-end'></span><![endif]--><span style='mso-bookmark:_TBL${tableRefNum}'></span> $!captionContent</p></td></tr></table>" )
			        #end
			      #end

			      #set($splitItem = $splitItem.replaceAll("<caption.*\s*.*\s*<\/caption>", ""))
			      #set($splitItem = $splitItem.replaceAll("<table", "$caption<table"))

			    ## Add captions to All Tables ##
			    ## Comment out this block if you only want captions for tables that have captions
			    #else
			    	#if( $TOT_includeAllTables )
			    		#set( $tableRefNum = $tableRefNum + 1)
			    		#set($caption = "<table border='0' cellpadding='1' cellspacing='0' style='border-collapse:collapse;borders:none;width:$tableWidth'><tr><td style='width:$tableWidth'><p class=MsoNormal style='text-align:$tableAlign;font-size:10pt;font-family:'Helvetica',sans-serif;font-weight:bold'><p class=MsoCaption style='text-align:center;margin-top:6pt;page-break-after:avoid'><a name='_TBL${tableRefNum}'>Table </a><!--[if supportFields]><span style='mso-bookmark:_TBL${tableRefNum}'></span><span style='mso-element:field-begin'></span><span style='mso-bookmark:_TBL${tableRefNum}'>SEQ Table \\* ARABIC <span style='mso-element:field-separator'></span></span><![endif]--><span style='mso-bookmark:_TBL${tableRefNum}'><span style='mso-no-proof:yes'>$tableRefNum</span></span><!--[if supportFields]><span style='mso-bookmark:_TBL${tableRefNum}'></span><span style='mso-element:field-end'></span><![endif]--><span style='mso-bookmark:_TBL${tableRefNum}'></span></p></td></tr></table>" )
			    		#set($splitItem = $splitItem.replaceAll("<table", "$caption<table"))
			    	#end 
	    		#end  ##if($splitItem.contains("</caption>"))
	    	#end ##if( !$splitItem.contains("invisibleTableContainsFIGURE"))
		#end  ##if( $splitItem.contains("[TABLE]"))
##
	  	## Rebuild the now modified inString content
	  	#set ( $tempInString = "${tempInString}${splitItem}" )

	#end  ##foreach ($splitItem in $splitList)

	## Reassign inString to its now caption modified version

	#set($output = $tempInString)
##
  ##------------------------------##
  ## Returns $output
  ##------------------------------##
##
#end 
## 
#########################################################################################################################
##  PDF                                                                                                                ##
##  #buildTableCaptions_PDF                                                                                            ##
##  1. considering table does not have captions, option to format table with captions and include in the TOT           ## 
##     - consider another parameter that may store caption content whether utilizing the document name, a field, or    ##
##        extracted rich text content                                                                                  ##
##                                                                                                                     ## 
#########################################################################################################################
#macro( buildTableCaptions_PDF $output $tableAlign)
#set( $tempInString = "")
#set( $caption = "")
#set( $output = $output.replaceAll("<table", "<table[TABLE]"))
#set( $splitList = $output.split("<table"))

#foreach ($splitItem in $splitList)
  	#if( $splitItem.contains("[TABLE]"))
		## Replace the placeholder with the <table tag that was removed in split
		#set( $splitItem = $splitItem.replaceAll("\[TABLE\]", "<table"))

		#if(!$splitItem.contains("</caption>") && $TOT_includeAllTables )
			#if( $tableAlign=='center')
				#set($caption = "<caption style='text-align:center !important;margin:auto !important'></caption>" )
			#elseif( $tableAlign =='right')
				#set($caption = "<caption style='text-align:right !important;margin-right:0pt !important;'></caption>" )
			#else 
				#set($caption = "<caption style='text-align:center !important;margin:auto !important;'></caption>" ) ## set default caption align
			#end 
		#set($splitItem = $splitItem.replaceAll("(<table.*?>)", "$1 $caption"))

	#end  ##if(!$splitItem.contains("</caption>"))
  #end  ##if( $splitItem.contains("[TABLE]"))
  
  ## Rebuild the now modified inString content
  #set ( $tempInString = "${tempInString}${splitItem}" )

#end  ##foreach ($splitItem in $splitList)

## Reassign inString to its now caption modified version

#set($output = $tempInString)

##------------------------------##
## Returns $output
##------------------------------##

#end 
##
#########################################################################################################################
##          Macro: fixedColumnWidths
##          Input: $formatTablesOutput      
##          Return: $returnFixedColumnWidths string, ready for opening in Word
#########################################################################################################################
#macro( fixedColumnWidths $formatTablesOutput )
#set( $output = "")
#set( $checkAllTables = $formatTablesOutput )
#set( $checkAllTables = $checkAllTables.replaceAll("<table", "<table[TABLE]"))
#set( $split_Col_List = [])
#set( $split_Table_List = $checkAllTables.split("<table"))
#set( $tableCount = 0 )
##
	#foreach( $table in $split_Table_List)
		#if( $table.contains("[TABLE]"))
			#set( $tableCount = $tableCount +1)
		#end 
	#end 
	#if( $tableCount > 1 )
		#foreach( $table in $split_Table_List )
			#if( $table.contains("[TABLE]"))
				#set( $table = $table.replaceAll( "\[TABLE\]", "<table"))
				#calculateMaxColsAndSetColGroup( $table )
				#set( $output = $output.concat( $returnTableString ))	
			#else 
				#set( $output = $output.concat( $table ))
			#end 
		#end 
	#else 
		#calculateMaxColsAndSetColGroup( $formatTablesOutput )
		#set( $output = $returnTableString )
	#end 

#end 
##
##DEBUG returnTableString #set( $TESTreturnTableString = $returnTableString.replaceAll("<|>", "&nbsp;&nbsp;"))<br>***<br> $TESTreturnTableString <br>***<br> ##
#########################################################################################################################
##          Macro: calculateMaxColsAndSetColGroup
##          Input: $inputTable           
##          Return: string, ready for opening in Word
#########################################################################################################################
#macro( calculateMaxColsAndSetColGroup $inputTable )
##
##  In order to have reliable fixed widths we need to find the row with the most unique width specifications ## 
#set( $checkRowsForWidths = $inputTable.replaceAll("<tr", "<tr[ROW]"))
#set( $split_Row_List = $checkRowsForWidths.split("<tr"))
#set( $maxWidthCount = 0 )
#set( $tempWidthCount = 0 )
#set( $rowForColGroup = "")
#set( $colWidthPresent = false )
##
	#foreach( $row in $split_Row_List )
		#if( $row.contains("[ROW]"))
			#set( $row = $row.replaceAll("\[ROW\]", "<tr"))
			#set( $isThereWidth = "")
			#set( $isThereWidth = $row.replaceAll("([^*]*?)(<td.*?|<th.*?)(width)", "$1$2[wid][WIDTH]"))	
			#if( $isThereWidth.contains("[WIDTH]"))			
				#set( $colWidthPresent = true )
				#set( $widthFound = [] )
				#set( $widthFound = $isThereWidth.split("[wid]"))
##
				#foreach( $wid in $widthFound )
					#if( $wid.contains("[WIDTH]"))
						#set( $tempWidthCount = $tempWidthCount +1)
					#end 
				#end 
			#end 
			#if( $tempWidthCount > $maxWidthCount )
				#set( $maxWidthCount = $tempWidthCount )
				#set( $rowForColGroup = $row )
			#end 
			#set( $tempWidthCount = 0)
		#end 
	#end 
    ##DEBUG Max Columns with Width Present: $maxWidthCount <br>
##
    ## Ensure that we are looking at a table with cell widths present
	#if( $colWidthPresent == true )
		#set( $columnList = $rowForColGroup )
		#set( $columnList = $columnList.replaceAll("<th", "<th[COL]"))
		#set( $columnList = $columnList.replaceAll("<td", "<td[COL]"))
		#set( $split_Col_List = $columnList.split("<td|<th"))
		#set( $colGroup = "<colgroup>")
		#set( $colsReplaceString = "" )
		##-------------------------------------------------------------------------------##                
		##   Build the colgroup- for each td || th in the row add a <col> HTML element   ##
		##   to the $colGroup string, utilizing width if found. If a cell has colspan,   ##
		##   for each count in colspan add <col> to the colgroup                         ## 
		##-------------------------------------------------------------------------------##
		#foreach( $col in $split_Col_List )			
			#if(  $col.contains("[COL]") && $col.contains("</th"))
				#set( $col = $col.replaceAll("\[COL\]", "<th "))
			#elseif( $col.contains("[COL]") && $col.contains("</td")) 
				#set( $col = $col.replaceAll("\[COL\]", "<td "))
			#end 
			#if( $col.contains("<td") || $col.contains("<th"))
				#set( $colWidth = "")
				#if( $col.contains("width"))
					#set( $colWidth = $col.replaceAll("[^*]*?(<td.*?|th.*?)(width\s*)(:|=)\s*\x27?\x22?(\d*.*?)[;\x27\x22].*(?:.*)", "$4"))
				#end					
				#if( $col.contains("colspan") )
					#set( $colspanFound = $col.replaceAll( "[^*]*?(<td.*?|th.*?)(colspan\s*=)[\x27\x22](\d*.*?)[\x27\x22].*(?:.*)", "$3"))
					#set( $colspanFound = $colspanFound.trim())
					#set( $colspanCount = $mathTool.toInteger($colspanFound))
					#foreach( $x in [1..$colspanCount])
						#set( $colGroup = "${colGroup}<col>" )
					#end 
				#elseif( $colWidth != "")
					#set( $colGroup = "${colGroup}<col style='width:${colWidth}'>" )
				#else 
					#set( $colGroup = "${colGroup}<col>" )
				#end 
				#set( $colsReplaceString = "${colsReplaceString}${col}")
			#end 
		#end ##foreach( $col in $split_Col_List )
##
	    #set( $colGroup = "$colGroup" + "<\/colgroup>") ## close the colgroup ## 
	    ## DEBUG ColGroup #set( $testColGroup = $colGroup.replaceAll("<|<\/|>", "")) $testColGroup

		##   Ensure the table element has 'table-layout:fixed' ##
		#set( $isTableLayoutFixed = $inputTable.replaceAll("[^*]*?(<table.*?)(table-layout\s*:)(\s*fixed)", "$3"))
		#set( $isTableLayoutFixed = $isTableLayoutFixed.trim())
	
		#if( !$isTableLayoutFixed.toUpperCase().contains("FIXED"))
			#set( $inputTable = $inputTable.replaceAll("(<table.*?style=[\x27\x22])(.*?)([\x27\x22].*?>)","$1$2;table-layout:fixed$3"))
		#end 

		##   Add the colgroup just after the opening table element  ##  
		#set( $returnTableString = $inputTable.replaceAll("(<table.*?>)","$1 $colGroup"))
##
	## else this table does not have widths present and does not need to be processed ## 
	#else 
		#set( $returnTableString = $inputTable )
	#end ##if( $colWidthPresent = true )
#end 
##
#########################################################################################################################
##          Macro: formatTableCell
##          Input: $inString - input string
##                 $justification - string, justification to apply to output. (left, right, center)
##                 $$maxImageWidth - number, maximum wide of any image in the cell
##          Output: string, ready for opening in Word
#########################################################################################################################
#macro( formatTableCell $inString $justification $maxImageWidth)
	#if( $inString && $justification && $maxImageWidth )
		#set( $string = $inString.toString() )
		## Re-format text for consistent look and feel
		#set( $string = "#formatText($string)" )
		#if( $format == 'pdf')
			## First re-format tables for consistent look and feel, and fixed column widths
			#set( $string = "#formatTables($string, $maxImageWidth, 'left')" )
			## Then prep figures to base64 after formatting tables
			#set( $string = "#convertFigures($string, $maxImageWidth)" )
		#else
			## Prep figures for Word- figures go in invisible table class
			#set( $string = "#convertFigures($string, $maxImageWidth)" )
			## then Re-format tables for consistent look and feel
			#set( $string = "#formatTables($string, $maxImageWidth, 'left')" )
		#end 
		## format lists appropriately
		#set( $string = $string.replaceAll('<li>','<li class=TableCell>') )
		#set( $string = $string.replaceAll('<li\s([^c].*?)>','<li class=TableCell $1>') )
		## Make sure all cells are contained in a paragraph with the appropriate style
		#if( !$string.contains("<p"))
		  #set( $string = "<p class=TableCell style='text-align:$justification'>$string</p>" )
		#else
		  #set( $string = $string.replaceAll("<p>","<p class=TableCell style='text-align:$justification'>") )
		  #set( $string = $string.replaceAll("<p\s([^c].*?)>","<p class=TableCell $1 style='text-align:$justification'>") )
		#end
		$string
	#end
#end
#########################################################################################################################
##          Macro: formatRichText
##          Input: $inString - input string
##          Return: string, ready for opening in Word
#########################################################################################################################
#macro( formatRichText $inString )
	#if( $inString )
		#set( $string = $inString.toString() )
		## Re-format text for consistent look and feel
		#set( $string = "#formatText($string)" )
		#if( $format == 'pdf')
			## First re-format tables for consistent look and feel and fixed column widths
			#set( $string = "#formatTables($string, $maxPageWidth, 'center')" )
			## Then prep figures to base64 after formatting tables
			#set( $string = "#convertFigures($string, $maxPageWidth)" )
		#else
			## Prep figures for Word- figures go in invisible table class
			#set( $string = "#convertFigures($string, $maxPageWidth)" )
			## then Re-format tables for consistent look and feel
			#set( $string = "#formatTables($string, $maxPageWidth, 'center')" )
		#end 
		## format lists appropriately
		#set( $string = $string.replaceAll('<li>','<li class=MsoListParagraph>'))
		#set( $string = $string.replaceAll('<li\s([^c].*?)>','<li class=MsoListParagraph $1>'))
		## Make sure all content that is not already in a paragraph with a class is in a paragraph with class Normal
		#if( !$string.contains("<p"))
		  #set( $string = "<p class=MsoNormal>$string</p>" )
		#else
		  #set( $string = $string.replaceAll("<p>","<p class=MsoNormal>") )
		  #set( $string = $string.replaceAll("<p\s([^c].*?)>","<p class=MsoNormal $1>") )
		#end
		$string
	#end
#end
#########################################################################################################################
## **********************************************************************************************************************
##
##  5.2 ITEM_TYPE_MACROS: Item Type Formatting Macros
##
##  >>>> Create one macro for each item format <<<<
##
##  Macros can be used for one or more Jama item types
##
## **********************************************************************************************************************
#########################################################################################################################
##
## Create a heading with the name of the document object and a bookmark named by the Jama API ID 
## bookmarks are used for cross-references
#macro( formatHeading $doc $hierarchyLevel $docStatus )
  #if( !$excludedStatuses.contains($docStatus) )
    #if( $baselineMode ) 
      #set($docID = $doc.currentVersion.id) 
    #else 
      #set($docID = $doc.id)
    #end

    #if( $format == "doc")

      #if( $hierarchyLevel < 7 )
        <h$hierarchyLevel style='text-align:left !important'>
          <a name="_API$docID"><span style='mso-bookmark:_API$docID'>$doc.name</span></a>
        </h$hierarchyLevel>
      #else
        <p class=MsoHeading7 style='text-align:left !important'>
          <a name="_API$docID"><span style='mso-bookmark:_API$docID'>$doc.name</span></a>
        </p>
      #end

    #else ## pdf
        #if( $hierarchyLevel < 7 )
      		<h$hierarchyLevel style='text-align:left !important'>$!doc.name</h$hierarchyLevel>
    	#else
      		<p class=MsoHeading7 style='text-align:left !important'>$!doc.name</p>
    	#end

    #end ##if( $format == "doc")...#else ## 
  #end
#end
##
## Simple Name and Description, suitable for Text Items similar item types
#macro( formatNameDescription $doc $hierarchyLevel $docStatus )
  #if( !$excludedStatuses.contains($docStatus) )
    #if( $baselineMode ) 
      #set($docID = $doc.currentVersion.id) 
    #else 
      #set($docID = $doc.id)
    #end

    #if( $format == "doc")
      #if( $hierarchyLevel < 7 )
        <h$hierarchyLevel style='text-align:left !important'>
          <a name="_API$docID"><span style='mso-bookmark:_API$docID'>$doc.name</span></a>
        </h$hierarchyLevel>
      #else
        <p class=MsoHeading7 style='text-align:left !important'>
          <a name="_API$docID"><span style='mso-bookmark:_API$docID'>$doc.name</span></a>
        </p>
      #end

    #else ## pdf

		#if( $hierarchyLevel < 7 )
			<h$hierarchyLevel style='text-align:left !important'>$!doc.name</h$hierarchyLevel>
		#else
			<p class=MsoHeading7 style='text-align:left !important'>$!doc.name</p>
		#end

    #end ##if( $format == "doc")...#else ## 

    #formatRichText($doc.description )
  #end
#end
##
## Description Only
#macro( formatDescription $doc $docStatus )
  #if( !$excludedStatuses.contains($docStatus) )
    #formatRichText($doc.description )
  #end
#end
##

#########################################################################################################################
##  5.3 BODY_MACRO - Creates the body of the report
##          Input: None
##          Return: body of the report
#########################################################################################################################
#macro( createBody )

<body lang=EN-US link=blue vlink="#954F72" style='tab-interval:.5in'>

<div class=WordSectionPortrait>

## Get information from the document container 
#if( $containerDoc ) ##
  #set( $title = $containerDoc.name) ##
  #set( $docNumber = $velocityReportUtil.getValueForField( $containerDoc, "document_id", $dateFormat )) ##
  #set( $docStatus = $velocityReportUtil.getValueForField( $containerDoc, "document_status", $dateFormat )) ##
  #set( $docAuthors = $velocityReportUtil.getValueForField( $containerDoc, "authors", $dateFormat )) ##
  #set( $docApprovers = $velocityReportUtil.getValueForField( $containerDoc, "approvers", $dateFormat )) ##
  #set( $docChangeHistory = $velocityReportUtil.getValueForField( $containerDoc, "change_history", $dateFormat )) ##
#else ##
  #set( $title = "NOT FOUND" ) ##
#end ##

##Get test plan
#set ($testPlan = $contourItemDao.getContourItem($mathTool.toInteger($report_testPlanId)))

 ##
#########################################################################################################################
##
##  5.3.1 WORD_WORK_AROUND_HEADER_FOOTER
##
#########################################################################################################################
##--------------------------------------------------------------
##  Headers and Footers                                        #
##--------------------------------------------------------------
#if( $format == "doc" )
  <table style='margin-left:15in'>
    <tr style='height:.1in;mso-height-rule:exactly'>
      <td>
        <div style='mso-element:footnote-separator' id=fs>

          <p class=MsoNormal><span style='mso-special-character:footnote-separator'><![if !supportFootnotes]>

          <hr align=left size=1 width="33%">

          <![endif]></span></p>

        </div>

        <div style='mso-element:footnote-continuation-separator' id=fcs>

          <p class=MsoNormal><span style='mso-special-character:footnote-continuation-separator'><![if !supportFootnotes]>

          <hr align=left size=1>

          <![endif]></span></p>

        </div>

        <div style='mso-element:endnote-separator' id=es>

          <p class=MsoNormal><span style='mso-special-character:footnote-separator'><![if !supportFootnotes]>

          <hr align=left size=1 width="33%">

          <![endif]></span></p>

        </div>

        <div style='mso-element:endnote-continuation-separator' id=ecs>

          <p class=MsoNormal><span style='mso-special-character:footnote-continuation-separator'><![if !supportFootnotes]>

          <hr align=left size=1>

          <![endif]></span></p>

        </div>

        ## Content Header
        <div style='mso-element:header' id=pageHeader>

          <div align=center>

          <table class=MsoTableGrid border=0 cellspacing=0 cellpadding=0 width="100%"
           style='width:100.0%;border-collapse:collapse;border:none;mso-yfti-tbllook:
           1184;mso-padding-alt:0in 5.75pt 0in 5.75pt;mso-border-insideh:none;mso-border-insidev:
           none'>
           <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;'>
            <td style='padding:0in 5.75pt 0in 5.75pt;'>
            <p class=MsoNormal>$project.name</p>
            </td>
            <td style='padding:0in 5.75pt 0in 5.75pt;'>
            <p class=MsoNormal align=right style='text-align:right'>Test Plan: $testPlan.name</p>
            </td>
           </tr>
          </table>

          </div>

          <p class=MsoNormal><o:p>&nbsp;</o:p></p>

        </div>

        ## Content Footer
        <div style='mso-element:footer' id=pageFooter>

          <table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=522
           style='width:100%;border-collapse:collapse;mso-yfti-tbllook:
           1184;mso-padding-alt:0in 5.4pt 0in 5.4pt;border-top: solid #000 1.0pt;'>
           <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
            <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
            <p class=MsoFooter>Test Plan: $testPlan.name</p>
            </td>
            <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
            <p class=MsoNormal align=right style='text-align:right'><span
            style='font-family:"Calibri",sans-serif'>Page </span><!--[if supportFields]><span
            style='font-family:"Calibri",sans-serif'><span style='mso-element:field-begin'></span><span
            style='mso-spacerun:yes'></span>PAGE <span style='mso-element:field-separator'></span></span><![endif]--><span
            style='font-family:"Calibri",sans-serif'><span style='mso-no-proof:yes'>3</span></span><!--[if supportFields]><span
            style='font-family:"Calibri",sans-serif;mso-no-proof:yes'><span
            style='mso-element:field-end'></span></span><![endif]--><span
            style='font-family:"Calibri",sans-serif'> of </span><!--[if supportFields]><span
            style='font-family:"Calibri",sans-serif'><span style='mso-element:field-begin'></span><span
            style='mso-spacerun:yes'></span>NUMPAGES<span style='mso-spacerun:yes'>
            </span><span style='mso-element:field-separator'></span></span><![endif]--><span
            style='font-family:"Calibri",sans-serif'><span style='mso-no-proof:yes'>3</span></span><!--[if supportFields]><span
            style='font-family:"Calibri",sans-serif;mso-no-proof:yes'><span
            style='mso-element:field-end'></span></span><![endif]--><span
            style='font-family:"Calibri",sans-serif'><o:p></o:p></span></p>
            </td>
           </tr>
          </table>

        </div>

        ## Title Page Header
        <div style='mso-element:header' id=titlepageHeader>

          <p class=MsoHeader><o:p>&nbsp;</o:p></p>

          <p class=MsoHeader align=right style='margin-right:-.25in;text-align:right'><o:p>&nbsp;</o:p></p>

        </div>

        ## Title Page Footer
        <div style='mso-element:footer' id=titlepageFooter>

          <p class=MsoFooter align=center style='margin-right:-.25in;text-align:center'><span
          style='mso-bidi-font-size:10.0pt;background:white'> $dateTool.get('yyyy') $project.organization.name, All Right Reserved. This document may not in any form be
          reproduced, distributed or utilized, in whole or in part without prior, express
          written consent of $project.organization.name.</p>

        </div>
      </td>
    </tr>
  </table>


#elseif( $format == "pdf" )
#########################################################################################################################
##
##  5.3.2 PDF_HEADER 
##
#########################################################################################################################
<div class="pageHeader" align="center">  
  <table class="pageHeader-table" style='border:none;'>
      <tr>
        <td style='border:none;text-align:left;width:50%;'><p class=MsoHeader>$project.name</p></td>
        <td rowspan="1" style='border:none;text-align:right;width:50%;'><p class=MsoHeader>$title</p></td>
      </tr>
  </table>
</div>

<div class="pageFooter" align="center">
  <table class="pageFooter-table" style='border:none;'>
    <tbody>
      <tr>
        <td style='border:none;text-align:left;width:33%;'>
          <p class=MsoFooter>$project.name</p>
        </td>
        <td style='border:none;text-align:center;width:33%;'>
           <p class=MsoFooter>Confidential. $project.organization.name</p>
        </td>
        <td style='border:none;text-align:right;width:33%;'>
          <p class=MsoFooter>Page <span id="pageNumber"></span> of <span id="totalPages"></span></p>
        </td>
      </tr>
    </tbody>
  </table>
</div>


<div class="titlepageHeader">
    <p class=MsoHeader>&nbsp;</p>
    <p class=MsoHeader align=right style='text-align:right'>&nbsp;</p>
</div>

<div class="titlepageFooter">
  <table class="pageFooter-table" style='border:none;'>
    <tbody>
      <tr>
        <td rowspan="2" style='border:none;text-align:center;'>
         <p class=MsoFooter>
           &copy; $project.organization.name, All Right Reserved. This document may not in any form be reproduced, distributed or utilized, in whole or in part without prior, express written consent of $project.organization.name.
          </p>
        </td>
       </tr>
    </tbody>
  </table>
</div>


#########################################################################################################################
#end ##if( $format == "doc")...#elseif($format == "pdf")...## 



#########################################################################################################################
## **********************************************************************************************************************
##
##  5.3.4 TITLE_PAGE: Title Page
##
##  >>>> Customize this section to replace the title page <<<< 
##
## **********************************************************************************************************************
#########################################################################################################################
##
<div class='TitlePage'> ## target element if ToC needs to follow Title Page PDF reports ## 

## Main Title Page Content

<p class=MsoNormal>&nbsp;</p>

## Main Title Page Content
<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 align=right
 width="80%" style='width:80.0%;border-collapse:collapse;border:none;
 mso-border-left-alt:solid #4F81BD 2.25pt;mso-table-overlap:never;mso-yfti-tbllook:
 1184;mso-table-lspace:9.35pt;margin-left:6.35pt;mso-table-rspace:9.35pt;
 margin-right:6.35pt;mso-table-anchor-vertical:page;mso-table-anchor-horizontal:
 column;mso-table-left:right;mso-table-top:216.05pt;mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=384 valign=top style='width:383.6pt;border:none;border-left:solid #4F81BD 2.25pt;
  padding:.15in 5.75pt .15in 5.75pt'>
  <p class=ColorfulList-Accent21 style='mso-element:frame;mso-element-frame-hspace:
  9.35pt;mso-element-wrap:around;mso-element-anchor-vertical:page;mso-element-anchor-horizontal:
  column;mso-element-left:right;mso-element-top:216.05pt;mso-height-rule:exactly'><span
  style='font-size:11.0pt;mso-bidi-font-family:Calibri'>$project.name</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=383 valign=top style='width:383.4pt;border:none;border-left:solid #4F81BD 2.25pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=ColorfulList-Accent21 style='mso-element:frame;mso-element-frame-hspace:
  9.35pt;mso-element-wrap:around;mso-element-anchor-vertical:page;mso-element-anchor-horizontal:
  column;mso-element-left:right;mso-element-top:216.05pt;mso-height-rule:exactly'><span
  style='font-size:28.0pt;mso-bidi-font-family:Calibri;color:#4F81BD'>
    Test Report: $testPlan.name
  </span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;mso-yfti-lastrow:yes'>
  <td width=384 valign=top style='width:383.6pt;border:none;border-left:solid #4F81BD 2.25pt;
  padding:.15in 5.75pt .15in 5.75pt'>
  <p class=ColorfulList-Accent21 style='mso-element:frame;mso-element-frame-hspace:
  9.35pt;mso-element-wrap:around;mso-element-anchor-vertical:page;mso-element-anchor-horizontal:
  column;mso-element-left:right;mso-element-top:216.05pt;mso-height-rule:exactly'><span
  style='font-size:11.0pt;mso-bidi-font-family:Calibri'>Produced on $dateTool.get('MMMM dd, yyyy')</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style="margin-top:5in">&nbsp;</p>

#if( $format=='pdf')
   <p style="page-break-after:always;"></p>
#end 

## Approvers Table (shown only if there is a baseline)
#if( $baselineId )
  #set( $baseSignatures = $baselineDao.getSignaturesForBaseLine( $baselineId))
  #if( $baseSignatures.size() > 0)
    <p class=MsoSubtitle>Signature Approval</p>
    <table style="width:6.5in;border-collapse: collapse;">
      <thead>
        <tr>
          <th class=TableHeader style="background:$tableHeaderBackgroundColor;width:3.25in"><p class=TableHeader>Signed By</p></th>
          <th class=TableHeader style="background:$tableHeaderBackgroundColor;width:3.25in"><p class=TableHeader>Signed On (Pacific Time)</p></th>
        </tr>
      </thead>
      #foreach( $sig in $baseSignatures)
        <tr>
          <td class=TableCell style="width:3.25in;"><p class=TableCell style="text-align: center">$sig.user.fullName</p></td>
          <td class=TableCell style="width:3.25in;"><p class=TableCell style="text-align: center;">#getDateTime($sig.createdDate $timeZone)</p></td>
        </tr>
      #end
    </table>
  #end
#end

</div> ## <div class=TitlePage>
## Page Break
<br clear=all style='mso-special-character:line-break;page-break-before:always'>

#if( $format == "doc" )
#########################################################################################################################
##
##  5.3.5 TABLE_OF_CONTENTS
##
#########################################################################################################################

## Title
<p class=MsoTocHeading>Table of Contents</p>

## Word field for a table of contents
<div>
  <p class=MsoNormal>
    <!--[if supportFields]><span style='mso-element:field-begin'></span> 
    TOC \h \o 1-7 \* MERGEFORMAT <span
    style='mso-element:field-separator'></span><![endif]--><span
    style='color:red;mso-no-proof:yes'>Select the entire document (Windows: Ctrl+a) (Mac: Command+a) and press F9 to update the TOC and Cross-References</span><!--[if supportFields]><span
    style='mso-element:field-end'></span><![endif]--></p>
</div>

## Page Break
<br clear=all style='mso-special-character:line-break;page-break-before:always'>

#########################################################################################################################
##
##  5.3.6 TABLE_OF_FIGURES
##
#########################################################################################################################

#if( $tableOfFigures )

## Title
<p class=MsoTocHeading>Table of Figures</p>

## Word field for a table of figures
<p class=MsoNormal style='font-size:11pt;'>
  <!--[if supportFields]><span style='mso-element:field-begin'></span>TOC \h \z \c &quot;Figure&quot;
  <span style='mso-element:field-separator'></span></span></b><![endif]-->
  <span style='color:red;mso-no-proof:yes'>Select the entire document (Windows: Ctrl+a) (Mac: Command+a) and press F9 to update the TOC and Cross-References</span>
  <!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
</p>

## Page Break
<br clear=all style='mso-special-character:line-break;page-break-before:always'>

#end

#########################################################################################################################
##
##  5.3.7 TABLE_OF_TABLES
##
#########################################################################################################################

#if( $tableOfTables )
## Title
<p class=MsoTocHeading>Table of Tables</p>

## Word field for a table of tables
<p class=MsoNormal style='font-size:11pt;'>
  <!--[if supportFields]><span style='mso-element:field-begin'></span>TOC \h \z \c &quot;Table&quot; 
  <span style='mso-element:field-separator'></span><![endif]-->
  <span style='color:red;mso-no-proof:yes'>Select the entire document (Windows: Ctrl+a) (Mac: Command+a) and press F9 to update the TOC and Cross-References</span>
  <!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
</p>

## Page Break
<br clear=all style='mso-special-character:line-break;page-break-before:always'>
#end

#end ##if( $format == "doc" )

#########################################################################################################################
##
##  5.3.8 CHANGE_HISTORY
##
#########################################################################################################################

#if( $docChangeHistory && $docChangeHistory != "" )
  <p class=MsoTocHeading>Change History</p>
  #formatRichText($docChangeHistory)

  <p class=MsoNormal>&nbsp;</p>

  ## Page Break
  <br clear=all style='mso-special-character:line-break;page-break-before:always'>
#end



#########################################################################################################################
##
##  5.3.9 OUTPUT_DOCUMENT_LIST: Generate each item in DocumentList
##
#########################################################################################################################
<div class="reportBodyCounterContainer"> #### this div initializes the counter to number items in PDF report




#################################################################
##
## Test Runs Per Test Cycle ~~ Data Gathering & Organization
##
#################################################################

  #set( $testCaseIdsForTestPlan = [] )
  #set( $testRuns = [] )
  #set( $sortedTestRuns = [] )
  #set( $testRunsByCycle = [] )
  #set( $sorted_testCycle_testRuns = []) 
  #set( $sortedTestCycle = [] )
  #set( $uniqueTestRunGlobalIDs = [] )

  ## Extract Test Plan
  #set( $testPlanID = $mathTool.toInteger($report_testPlanId))
  #set( $testPlan = $testPlanDao.getTestPlan($testPlanID))

  ## Extract Test Plan Test Cases
  #set( $testSets = $testPlan.testSets )
  #foreach( $testSet in $testSets )
    #set( $testSetCases = $testSet.testSetCases )
    
    #foreach( $testCase in $testSetCases )
      #set( $testCase = $testCase.testCase )
      #set( $success = $testCaseIdsForTestPlan.add($testCase.id))
    #end 
  #end 

  ## Extract Test Runs From Test Cases
  #set( $testRunIds = $testSource.getTestRunIdsForTestCases($testCaseIdsForTestPlan))
  #foreach( $tr in $testRunIds )
    #set( $tRun = $testSource.getTestRun($numberTool.toNumber($tr).intValue()))
    
    #if( $tRun.active && $tRun.testPlan.id == $testPlan.id )
      #set( $success = $testRuns.add({"TestRun":$tRun, "GlobalID":$tRun.globalId}))
    #end 
  #end 

  ## Associate Each Test Run To Corresponding Test Cycle
  #set( $sortedTestRuns = $sortTool.sort( $testRuns, "GlobalID:desc" ))
  #foreach( $tr in $sortedTestRuns )
    #set( $testRun = $tr.get("TestRun"))

    #if( !$uniqueTestRunGlobalIDs.contains( $testRun.globalId  ) )
      #set( $success = $uniqueTestRunGlobalIDs.add($testRun.globalId))
      #set( $success = $testRunsByCycle.add({"TestCycle":$testRun.testCycle, "TestCycleId": $testRun.testCycle.id, "TestRun":$testRun}))
    #end 
  #end 
      
  ## Organize Test Run Collections Per Cycle 
  #set( $sortedTestCycle = $sortTool.sort( $testRunsByCycle, "TestCycleId:asc" ))
  #set( $cycleTestRuns = [] )
  #foreach( $tc in $sortedTestCycle )
    #set( $testCycle = $tc.get("TestCycle"))
    #set( $testRun = $tc.get("TestRun"))

    #if( $foreach.hasNext )
      #set( $nextIndex = $foreach.index + 1 )
      #set( $nextInList = $sortedTestCycle.get($nextIndex))
      #set( $nextCycle = $nextInList.testCycle )
    #else
      #set( $nextCycle = false )
    #end

    #set( $success = $cycleTestRuns.add($testRun ))
     
    #if( $nextCycle.id != $testCycle.id || !$nextCycle )
      #set( $success = $sorted_testCycle_testRuns.add({"TestCycle":$testCycle, "TestRuns":$cycleTestRuns}))
      #set( $cycleTestRuns = [] )
    #end 
  #end 




#################################################################
##
## Report Content
##
#################################################################

########### Display Test Plan ###########################
<h1>$testPlan.name ($testPlan.documentKey)</h1>
#if( $testPlan.description)  
 #formatRichText($testPlan.description)
#end

## Page Break
<br clear=all style='mso-special-character:line-break;page-break-before:always'>


########### Display Test Run Results #########################

<h1>Detailed Results</h1>

#foreach($testData in $sorted_testCycle_testRuns)
  #set($cycle = $testData.get("TestCycle"))
  #set($testRuns = $testData.get("TestRuns"))

  ## Test Cycle Header
  <h2>$cycle.name [$cycle.documentKey]</h2>

  #foreach($testRun in $testRuns)
    
    ## Test Cycle Test Runs Table
    <table class=MsoNormalTable cellpadding="0" cellspacing="0" border="1" width="100%"
      style='border-collapse:collapse;border:none;mso-table-layout-alt:fixed;mso-border-alt:solid black .5pt; mso-yfti-tbllook:1184;
        mso-padding-alt:0in 5.4pt 0in 5.4pt;mso-border-insideh:.5pt solid black;mso-border-insidev:.5pt solid black'>
        
        ## Test Run Header
        <tr bgcolor="D9D9D9">
          <td colspan="6"><h3>$testRun.name [$testRun.documentKey]</h3></td>
        </tr>

        ## Test Run Description
        <tr bgcolor="ffffff">
            <td colspan="6"><p class=MsoNormal><b>Description:</b> #formatTableCell($testRun.description, "left", 325)</p></td>
        </tr>

        ## Relationships
        <tr bgcolor="ffffff">
          <td colspan="2" width="30%"><p class=MsoNormal><b>Requirement(s) Covered:</b></p></td>
          <td colspan="4" width="70%">
            <p class=MsoNormal>
              #getRelationships($testRun.testCase, false) ## Creates $returnRels
              #set ( $upRels = $returnRels )
              #if( $upRels.size() > 0 )
                #foreach ( $upRel in $upRels )
                  #set($upDoc = $upRel.fromDocument)
                  #if($foreach.last)
                    $upDoc.documentKey 
                  #else
                    $upDoc.documentKey, 
                  #end
                #end
              #end
            </p>
          </td>
        </tr>

        ## Test Group
        <tr bgcolor="ffffff">
            <td colspan="2" width="30%"><p class=MsoNormal><b>Test Group:</b></p></td>
            <td colspan="4" width="70%"><p class=MsoNormal>$testRun.testRunSet.name</p></td>
        </tr>

        ## Test case
        <tr bgcolor="ffffff">
            <td colspan="2" width="30%"><p class=MsoNormal><b>Test Case:</b></p></td>
            <td colspan="4" width="70%"><p class=MsoNormal>$testRun.testCase.name [$testRun.testCase.documentKey]</p></td>
        </tr>

        ## Test Run Creation Date
        <tr bgcolor="ffffff">
            <td colspan="2" width="30%"><p class=MsoNormal><b>Run Created on:</b></p></td>
            <td colspan="4" width="70%"><p class=MsoNormal>$dateTool.format('MMM d, yyyy, h:mm a z', $testRun.createdDate)</p></td>
        </tr>

        ## Test Run Created By User
        <tr bgcolor="ffffff">
            <td colspan="2" width="30%"><p class=MsoNormal><b>Created By:</b></p></td>
            <td colspan="4" width="70%"><p class=MsoNormal>$userDao.getUser($testRun.createdBy).fullName</p></td>
        </tr>

        ## Test Run Steps
        <tr bgcolor="ffffff">
            <td colspan="6"><p class=MsoNormal><b>Steps</b></p></td>
        </tr>
        <tr bgcolor="ffffff">
            <td width="10%" style='background:#D9D9D9'><p class=MsoNormal ><b>#</b></p></td>
            <td width="20%" style='background:#D9D9D9'><p class=MsoNormal><b>Action</b></p></td>
            <td width="20%" style='background:#D9D9D9'><p class=MsoNormal><b>Expected Result</b></p></td>
            <td width="20%" style='background:#D9D9D9'><p class=MsoNormal><b>Notes</b></p></td>
            <td width="10%" style='background:#A6A6A6'><p class=MsoNormal><b>Status</b></p></td>
            <td width="20%" style='background:#A6A6A6'><p class=MsoNormal><b>Result</b></p></td>
        </tr>

        #foreach( $step in $testRun.testRunSteps)
            <tr bgcolor="ffffff">
                <td width="10%"><p class=MsoNormal>#if($step.stepIndex) #formatTableCell($step.stepIndex, "left", 100) #end</p></td>
                <td width="20%"><p class=MsoNormal>#if($step.action) #formatTableCell($step.action, "left", 200) #end</p></td>
                <td width="20%"><p class=MsoNormal>#if($step.expectedResult) #formatTableCell($step.expectedResult, "left", 200) #end</p></td>
                <td width="20%"><p class=MsoNormal>#if($step.notes) #formatTableCell($step.notes, "left", 200) #end</p></td>
                <td width="10%"><p class=MsoNormal>#if($step.status) #formatTableCell($step.status, "left", 100) #end</p></td>
                <td width="20%">#if($step.result) #formatTableCell($step.result , "left", 200)  #end</td>
            </tr>
        #end

        ## Actual Results
        <tr bgcolor="ffffff">
            <td colspan="2" width="30%"><p class=MsoNormal><b>Actual Results:</b></p></td>
            <td colspan="4" width="70%">#if($testRun.actualResults) #formatTableCell($testRun.actualResults , "left", 325)#end</td>
        </tr>

        ## Test Run Execution Date
        <tr bgcolor="ffffff">
            <td colspan="2" width="30%"><p class=MsoNormal><b>Executed on:</b></p></td>
            <td colspan="4" width="70%"><p class=MsoNormal>#if($testRun.executionDate) #getDateTime($testRun.executionDate $timeZone) #end</p></td>
        </tr>

        ## Test Run Executed By
        <tr bgcolor="ffffff">
            <td colspan="2" width="30%"><p class=MsoNormal><b>Test Executed By:</b></p></td>
            <td colspan="4" width="70%"><p class=MsoNormal>#if($testRun.assignedTo) $testRun.assignedTo.fullName #end</p></td>
        </tr>

        ## Test Run Status
        <tr bgcolor="ffffff">
            <td colspan="2" width="30%"><p class=MsoNormal><b>Test Status:</b></p></td>
            <td colspan="4" width="70%"><p class=MsoNormal>#if($testRun.testRunStatus) $testRun.testRunStatus #end</p></td>
        </tr>

        ## Pass with Errors
        <tr bgcolor="ffffff">
            <td colspan="2" width="30%"><p class=MsoNormal><b>Pass with Errors:</b></p></td>
            <td colspan="4" width="70%"><p class=MsoNormal>#if($testRun.forcePassed) $testRun.forcePassed #end</p></td>
        </tr>
    </table>

    <p class=MsoNormal>&nbsp;</p>
          
    
  #end ## #foreach($testRun in $testRuns)
#end ## #foreach($testData = $finalTestResultsPerCycle)

#########################################################################################################################
## **********************************************************************************************************************
#########################################################################################################################

</div> ##<div class="reportBodyCounterContainer">


</div>

</body>
#end
#########################################################################################################################
## **********************************************************************************************************************
#########################################################################################################################
##
#########################################################################################################################
##
##  6. DOCUMENT_INITIALIZATION
##
##  All code the executes before the report loops through $documentList goes here.
##
##  Outputs the following information for use in the rest of the report:
##  --> $containerDoc - Set or Component that contains the items in the document.  Used for Headers, Footers and Title page.
##  --> $documentRev - Name of the baseline that all items are part of. Appended with an asterisk if some items have 
##                     changed since latest baseline.
##  --> $referenencableDocIds - List of all items that will have bookmark references available in the doc
##
#########################################################################################################################
##getContainer( $baselineMode ) ## Creates: $containerDoc
#### Debug: $containerDoc.documentKey: $containerDoc.name
## Only show a revision if exporting from a baseline

#if( $baselineMode )
  #if($!contextId)
    #set( $baseline = $baselineDao.getBaseLine($mathTool.toInteger($contextId)))
    #set( $documentRev = $baseline.name)
    #set( $baselineId = $baseline.id)
  #else
    #getDocumentRev() ## Creates: $documentRev, $baselineId
  #end
  #### Debug $documentRev
#else
  #set( $documentRev = "N/A" )
  #set( $baselineId = false )
#end

#########################################################################################################################

#########################################################################################################################
##
##  7. REPORT_BODY
##
#########################################################################################################################

#set( $body = "#createBody()")
#if( $format == "doc" )
  #convertEquals( $body )
#else
  $body
#end


</html>
#########################################################################################################################
##
##  8. MS_WORD_OBJECTS
##
#########################################################################################################################

#if( $format == "doc" )
#########################################################################################################################
##  Embed images
#########################################################################################################################

#foreach( $f in $figure)
$f
#end

#########################################################################################################################

------=_NextPart_01D506B0.1F52D2B0
Content-Location: file:///C:/D993472D/WordTemplate.fld/item0001.xml
Content-Transfer-Encoding: quoted-printable
Content-Type: text/xml

<b:Sources xmlns:b=3D"http://schemas.openxmlformats.org/officeDocument/2006/bibliography" xmlns=3D"http://schemas.openxmlformats.org/officeDocument/2006/bibliography" SelectedStyle=3D"/APASixthEditionOfficeOnline.xsl" StyleName=3D"APA" Version=3D"6"/>

------=_NextPart_01D506B0.1F52D2B0
Content-Location: file:///C:/D993472D/WordTemplate.fld/props001.xml
Content-Transfer-Encoding: quoted-printable
Content-Type: text/xml

<?xml version=3D"1.0" encoding=3D"UTF-8" standalone=3D"no"?>
<ds:datastoreItem ds:itemID=3D"{A1D0A804-CF3A-234A-AB79-452ECE125E33}" xmlns:ds=3D"http://schemas.openxmlformats.org/officeDocument/2006/customXml"><ds:schemaRefs><ds:schemaRef ds:uri=3D"http://schemas.openxmlformats.org/officeDocument/2006/bibliography"/></ds:schemaRefs></ds:datastoreItem>

------=_NextPart_01D506B0.1F52D2B0
Content-Location: file:///C:/D993472D/WordTemplate.fld/themedata.thmx
Content-Transfer-Encoding: base64
Content-Type: application/vnd.ms-officetheme

UEsDBBQABgAIAAAAIQDp3g+//wAAABwCAAATAAAAW0NvbnRlbnRfVHlwZXNdLnhtbKyRy07DMBBF
90j8g+UtSpyyQAgl6YLHjseifMDImSQWydiyp1X790zSVEKoIBZsLNkz954743K9Hwe1w5icp0qv
8kIrJOsbR12l3zdP2a1WiYEaGDxhpQ+Y9Lq+vCg3h4BJiZpSpXvmcGdMsj2OkHIfkKTS+jgCyzV2
JoD9gA7NdVHcGOuJkTjjyUPX5QO2sB1YPe7l+Zgk4pC0uj82TqxKQwiDs8CS1Oyo+UbJFkIuyrkn
9S6kK4mhzVnCVPkZsOheZTXRNajeIPILjBLDsAyJX89nIBkt5r87nons29ZZbLzdjrKOfDZezE7B
/xRg9T/oE9PMf1t/AgAA//8DAFBLAwQUAAYACAAAACEApdan58AAAAA2AQAACwAAAF9yZWxzLy5y
ZWxzhI/PasMwDIfvhb2D0X1R0sMYJXYvpZBDL6N9AOEof2giG9sb69tPxwYKuwiEpO/3qT3+rov5
4ZTnIBaaqgbD4kM/y2jhdj2/f4LJhaSnJQhbeHCGo3vbtV+8UNGjPM0xG6VItjCVEg+I2U+8Uq5C
ZNHJENJKRds0YiR/p5FxX9cfmJ4Z4DZM0/UWUtc3YK6PqMn/s8MwzJ5PwX+vLOVFBG43lExp5GKh
qC/jU72QqGWq1B7Qtbj51v0BAAD//wMAUEsDBBQABgAIAAAAIQBreZYWgwAAAIoAAAAcAAAAdGhl
bWUvdGhlbWUvdGhlbWVNYW5hZ2VyLnhtbAzMTQrDIBBA4X2hd5DZN2O7KEVissuuu/YAQ5waQceg
0p/b1+XjgzfO3xTVm0sNWSycBw2KZc0uiLfwfCynG6jaSBzFLGzhxxXm6XgYybSNE99JyHNRfSPV
kIWttd0g1rUr1SHvLN1euSRqPYtHV+jT9yniResrJgoCOP0BAAD//wMAUEsDBBQABgAIAAAAIQC2
9GeYkwcAAMkgAAAWAAAAdGhlbWUvdGhlbWUvdGhlbWUxLnhtbOxZzYsbyRW/B/I/NH2X9dWtj8Hy
ok/P2jO2sWSHPdZIpe7yVHeJqtKMxWII3lMugcAm5JCFve0hhCzswi655I8x2CSbPyKvqlvdVVLJ
nhkcMGFGMHSXfu/Vr9579d5T1d3PXibUu8BcEJb2/Pqdmu/hdM4WJI16/rPZpNLxPSFRukCUpbjn
b7DwP7v361/dRUcyxgn2QD4VR6jnx1KujqpVMYdhJO6wFU7huyXjCZLwyqPqgqNL0JvQaqNWa1UT
RFLfS1ECah8vl2SOvZlS6d/bKh9TeE2lUANzyqdKNbYkNHZxXlcIsRFDyr0LRHs+zLNglzP8Uvoe
RULCFz2/pv/86r27VXSUC1F5QNaQm+i/XC4XWJw39Jw8OismDYIwaPUL/RpA5T5u3B63xq1Cnwag
+RxWmnGxdbYbwyDHGqDs0aF71B416xbe0N/c49wP1cfCa1CmP9jDTyZDsKKF16AMH+7hw0F3MLL1
a1CGb+3h27X+KGhb+jUopiQ930PXwlZzuF1tAVkyeuyEd8Ng0m7kyksUREMRXWqKJUvloVhL0AvG
JwBQQIokST25WeElmkMUDxElZ5x4JySKIfBWKGUChmuN2qTWhP/qE+gn7VF0hJEhrXgBE7E3pPh4
Ys7JSvb8B6DVNyBvf/75zesf37z+6c1XX715/fd8bq3KkjtGaWTK/fLdH/7zzW+9f//w7S9f/zGb
ehcvTPy7v/3u3T/++T71sOLSFG//9P27H79/++ff/+uvXzu09zk6M+EzkmDhPcKX3lOWwAId/PEZ
v57ELEbElOinkUApUrM49I9lbKEfbRBFDtwA23Z8ziHVuID31y8swtOYryVxaHwYJxbwlDE6YNxp
hYdqLsPMs3UauSfnaxP3FKEL19xDlFpeHq9XkGOJS+UwxhbNJxSlEkU4xdJT37FzjB2r+4IQy66n
ZM6ZYEvpfUG8ASJOk8zImRVNpdAxScAvGxdB8Ldlm9Pn3oBR16pH+MJGwt5A1EF+hqllxvtoLVHi
UjlDCTUNfoJk7CI53fC5iRsLCZ6OMGXeeIGFcMk85rBew+kPIc243X5KN4mN5JKcu3SeIMZM5Iid
D2OUrFzYKUljE/u5OIcQRd4TJl3wU2bvEPUOfkDpQXc/J9hy94ezwTPIsCalMkDUN2vu8OV9zKz4
nW7oEmFXqunzxEqxfU6c0TFYR1Zon2BM0SVaYOw9+9zBYMBWls1L0g9iyCrH2BVYD5Adq+o9xQJ6
JdXc7OfJEyKskJ3iiB3gc7rZSTwblCaIH9L8CLxu2nwMpS5xBcBjOj83gY8I9IAQL06jPBagwwju
g1qfxMgqYOpduON1wy3/XWWPwb58YdG4wr4EGXxtGUjspsx7bTND1JqgDJgZgi7DlW5BxHJ/KaKK
qxZbO+WW9qYt3QDdkdX0JCT9YAe00/uE/7veBzqMt3/5xrEPPk6/41ZsJatrdjqHksnxTn9zCLfb
1QwZX5BPv6kZoXX6BEMd2c9Ytz3NbU/j/9/3NIf2820nc6jfuO1kfOgwbjuZ/HDl43QyZfMCfY06
8MgOevSxT3Lw1GdJKJ3KDcUnQh/8CPg9s5jAoJLTJ564OAVcxfCoyhxMYOEijrSMx5n8DZHxNEYr
OB2q+0pJJHLVkfBWTMChkR526lZ4uk5O2SI77KzX1cFmVlkFkuV4LSzG4aBKZuhWuzzAK9RrtpE+
aN0SULLXIWFMZpNoOki0t4PKSPpYF4zmIKFX9lFYdB0sOkr91lV7LIBa4RX4we3Bz/SeHwYgAkJw
HgfN+UL5KXP11rvamR/T04eMaUUANNjbCCg93VVcDy5PrS4LtSt42iJhhJtNQltGN3gihp/BeXSq
0avQuK6vu6VLLXrKFHo+CK2SRrvzPhY39TXI7eYGmpqZgqbeZc9vNUMImTla9fwlHBrDY7KC2BHq
NxeiEdy8zCXPNvxNMsuKCzlCIs4MrpNOlg0SIjH3KEl6vlp+4Qaa6hyiudUbkBA+WXJdSCufGjlw
uu1kvFziuTTdbowoS2evkOGzXOH8VovfHKwk2RrcPY0Xl94ZXfOnCEIsbNeVARdEwN1BPbPmgsBl
WJHIyvjbKUx52jVvo3QMZeOIrmKUVxQzmWdwncoLOvqtsIHxlq8ZDGqYJC+EZ5EqsKZRrWpaVI2M
w8Gq+2EhZTkjaZY108oqqmq6s5g1w7YM7NjyZkXeYLU1MeQ0s8JnqXs35Xa3uW6nTyiqBBi8sJ+j
6l6hIBjUysksaorxfhpWOTsftWvHdoEfoHaVImFk/dZW7Y7dihrhnA4Gb1T5QW43amFoue0rtaX1
rbl5sc3OXkDyGEGXu6ZSaFfCyS5H0BBNdU+SpQ3YIi9lvjXgyVtz0vO/rIX9YNgIh5VaJxxXgmZQ
q3TCfrPSD8NmfRzWa6NB4xUUFhkn9TC7sZ/ABQbd5Pf2enzv7j7Z3tHcmbOkyvTdfFUT13f39cbh
u3uPQNL5stWYdJvdQavSbfYnlWA06FS6w9agMmoN26PJaBh2upNXvnehwUG/OQxa406lVR8OK0Gr
puh3upV20Gj0g3a/Mw76r/I2BlaepY/cFmBezevefwEAAP//AwBQSwMEFAAGAAgAAAAhAA3RkJ+2
AAAAGwEAACcAAAB0aGVtZS90aGVtZS9fcmVscy90aGVtZU1hbmFnZXIueG1sLnJlbHOEj00KwjAU
hPeCdwhvb9O6EJEm3YjQrdQDhOQ1DTY/JFHs7Q2uLAguh2G+mWm7l53JE2My3jFoqhoIOumVcZrB
bbjsjkBSFk6J2TtksGCCjm837RVnkUsoTSYkUiguMZhyDidKk5zQilT5gK44o49W5CKjpkHIu9BI
93V9oPGbAXzFJL1iEHvVABmWUJr/s/04GolnLx8WXf5RQXPZhQUoosbM4CObqkwEylu6usTfAAAA
//8DAFBLAQItABQABgAIAAAAIQDp3g+//wAAABwCAAATAAAAAAAAAAAAAAAAAAAAAABbQ29udGVu
dF9UeXBlc10ueG1sUEsBAi0AFAAGAAgAAAAhAKXWp+fAAAAANgEAAAsAAAAAAAAAAAAAAAAAMAEA
AF9yZWxzLy5yZWxzUEsBAi0AFAAGAAgAAAAhAGt5lhaDAAAAigAAABwAAAAAAAAAAAAAAAAAGQIA
AHRoZW1lL3RoZW1lL3RoZW1lTWFuYWdlci54bWxQSwECLQAUAAYACAAAACEAtvRnmJMHAADJIAAA
FgAAAAAAAAAAAAAAAADWAgAAdGhlbWUvdGhlbWUvdGhlbWUxLnhtbFBLAQItABQABgAIAAAAIQAN
0ZCftgAAABsBAAAnAAAAAAAAAAAAAAAAAJ0KAAB0aGVtZS90aGVtZS9fcmVscy90aGVtZU1hbmFn
ZXIueG1sLnJlbHNQSwUGAAAAAAUABQBdAQAAmAsAAAAA

------=_NextPart_01D506B0.1F52D2B0
Content-Location: file:///C:/D993472D/WordTemplate.fld/colorschememapping.xml
Content-Transfer-Encoding: quoted-printable
Content-Type: text/xml

<?xml version=3D"1.0" encoding=3D"UTF-8" standalone=3D"yes"?>
<a:clrMap xmlns:a=3D"http://schemas.openxmlformats.org/drawingml/2006/main" bg1=3D"lt1" tx1=3D"dk1" bg2=3D"lt2" tx2=3D"dk2" accent1=3D"accent1" accent2=3D"accent2" accent3=3D"accent3" accent4=3D"accent4" accent5=3D"accent5" accent6=3D"accent6" hlink=3D"hlink" folHlink=3D"folHlink"/>

#########################################################################################################################
##
##  9. WORD_HEADER_FOOTER: MS Word Header / Footer Definition
##  Removed due to Word for Mac bug
##
#########################################################################################################################
#*
------=_NextPart_01D506B0.1F52D2B0
Content-Location: file:///C:/D993472D/WordTemplate.fld/header.htm
Content-Transfer-Encoding: quoted-printable
Content-Type: text/html; charset="utf-8"

<html xmlns:v=3D"urn:schemas-microsoft-com:vml"
xmlns:o=3D"urn:schemas-microsoft-com:office:office"
xmlns:w=3D"urn:schemas-microsoft-com:office:word"
xmlns:dt=3D"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882"
xmlns:m=3D"http://schemas.microsoft.com/office/2004/12/omml"
xmlns=3D"http://www.w3.org/TR/REC-html40">

##---------------------------------------------------------------------------
## Get information from the document container
##---------------------------------------------------------------------------
#if( $containerDoc )
  #set( $title = $containerDoc.name)
#else
  #set( $title = "NOT FOUND" )
#end
##---------------------------------------------------------------------------

<head>
<meta http-equiv=3DContent-Type content=3D"text/html; charset=3Dutf-8">
<meta name=3DProgId content=3DWord.Document>
<meta name=3DGenerator content=3D"Microsoft Word 15">
<meta name=3DOriginator content=3D"Microsoft Word 15">
<link id=3DMain-File rel=3DMain-File href=3D"../WordTemplate.htm">
<![if IE]>
<base href=3D"file:///C:/D993472D/WordTemplate.fld/header.htm" id=3D"webarch_temp_base_tag">
<![endif]><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext=3D"edit" spidmax=3D"2049"/>
</xml><![endif]-->
</head>

<body lang=3DEN-US link=3Dblue vlink=3D"#954F72">

<div style=3D'mso-element:footnote-separator' id=3Dfs>

<p class=3DMsoNormal><span style=3D'mso-special-character:footnote-separator'><![if !supportFootnotes]>

<hr align=3Dleft size=3D1 width=3D"33%">

<![endif]></span></p>

</div>

<div style=3D'mso-element:footnote-continuation-separator' id=3Dfcs>

<p class=3DMsoNormal><span style=3D'mso-special-character:footnote-continuation-separator'><![if !supportFootnotes]>

<hr align=3Dleft size=3D1>

<![endif]></span></p>

</div>

<div style=3D'mso-element:endnote-separator' id=3Des>

<p class=3DMsoNormal><span style=3D'mso-special-character:footnote-separator'><![if !supportFootnotes]>

<hr align=3Dleft size=3D1 width=3D"33%">

<![endif]></span></p>

</div>

<div style=3D'mso-element:endnote-continuation-separator' id=3Decs>

<p class=3DMsoNormal><span style=3D'mso-special-character:footnote-continuation-separator'><![if !supportFootnotes]>

<hr align=3Dleft size=3D1>

<![endif]></span></p>

</div>

<div style=3D'mso-element:header' id=3DpageHeader>

  <p class=3DMsoHeader>$project.name
  <w:PTab Alignment=3D"CENTER" RelativeTo=3D"MARGIN" Leader=3D"NONE"></w:PTab>
  <w:PTab Alignment=3D"RIGHT" RelativeTo=3D"MARGIN" Leader=3D"NONE"></w:PTab>$title</p>

</div>

<![if !supportTextWrap]><br clear=3DALL>
<![endif]>

<p class=3DMsoFooter style=3D'margin-right:.25in'>&nbsp;</p>

</div>

<div style=3D'mso-element:footer' id=3DpageFooter>

  <p class=3DMsoFooter>$project.name
    <w:PTab Alignment=3D"CENTER" RelativeTo=3D"MARGIN" Leader=3D"NONE"></w:PTab><span style=3D'color:gray'>Confidential. $project.organization.name</span>
    <w:PTab Alignment=3D"RIGHT" RelativeTo=3D"MARGIN" Leader=3D"NONE"></w:PTab>
    Page&nbsp;<!--[if supportFields]><span style=3D'mso-element:field-begin'></span>PAGE <span style=3D'mso-element:field-separator'></span>
    <![endif]-->2<!--[if supportFields]><span style=3D'mso-element:field-end'></span><![endif]-->&nbsp;of&nbsp;<span style=3D'mso-field-code:" NUMPAGES  "'>4</span></p>
  </p>

</div>

<div style=3D'mso-element:header' id=3DtitlepageHeader>

<p class=3DMsoHeader>&nbsp;</p>

<p class=3DMsoHeader align=3Dright style=3D'text-align:right'>&nbsp;</p>

</div>

<div style=3D'mso-element:footer' id=3DtitlepageFooter>

<p class=3DMsoFooter style=3D'text-align:center'>
  &copy; $project.organization.name, All Right Reserved. This document may not in any form be reproduced, distributed or utilized, in whole or in part without prior, express written consent of $project.organization.name.
</p>

</div>

</body>

</html>
*#


#########################################################################################################################

#########################################################################################################################
##
##  10. WORD_EMBEDDED_FILE_LIST
##
#########################################################################################################################

------=_NextPart_01D506B0.1F52D2B0
Content-Location: file:///C:/D993472D/WordTemplate.fld/filelist.xml
Content-Transfer-Encoding: quoted-printable
Content-Type: text/xml; charset="utf-8"

<xml xmlns:o=3D"urn:schemas-microsoft-com:office:office">
 <o:MainFile HRef=3D"../WordTemplate.htm"/>
 <o:File HRef=3D"item0001.xml"/>
 <o:File HRef=3D"props001.xml"/>
 <o:File HRef=3D"themedata.thmx"/>
 <o:File HRef=3D"colorschememapping.xml"/>
##<o:File HRef=3D"header.htm"/>
 #foreach( $file in $files)
 #convertEquals($file)
 #end
 <o:File HRef=3D"filelist.xml"/>
</xml>
------=_NextPart_01D506B0.1F52D2B0--
#end
